!function (t, e) { "object" == typeof exports && "undefined" != typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define(e) : t.videojs = e() }(this, function () {
  function t(t, e) { return e = { exports: {} }, t(e, e.exports), e.exports } function e(t) { return t.replace(/\n\r?\s*/g, "") } function i(t, e) { je(t).forEach(function (i) { return e(t[i], i) }) } function r(t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0; return je(t).reduce(function (i, r) { return e(i, t[r], r) }, i) } function n(t) { for (var e = arguments.length, r = Array(e > 1 ? e - 1 : 0), n = 1; e > n; n++)r[n - 1] = arguments[n]; return Object.assign ? Object.assign.apply(Object, [t].concat(r)) : (r.forEach(function (e) { e && i(e, function (e, i) { t[i] = e }) }), t) } function a(t) { return !!t && "object" === ("undefined" == typeof t ? "undefined" : De(t)) } function s(t) { return a(t) && "[object Object]" === Be.call(t) && t.constructor === Object } function o(t, e) { if (!t || !e) return ""; if ("function" == typeof Te.getComputedStyle) { var i = Te.getComputedStyle(t); return i ? i[e] : "" } return "" } function u(t) { return "string" == typeof t && /\S/.test(t) } function l(t) { if (/\s/.test(t)) throw new Error("class has illegal whitespace characters") } function c(t) { return new RegExp("(^|\\s)" + t + "($|\\s)") } function h() { return we === Te.document } function d(t) { return a(t) && 1 === t.nodeType } function p() { try { return Te.parent !== Te.self } catch (t) { return !0 } } function f(t) { return function (e, i) { if (!u(e)) return we[t](null); u(i) && (i = we.querySelector(i)); var r = d(i) ? i : we; return r[t] && r[t](e) } } function m() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "div", e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, r = arguments[3], n = we.createElement(t); return Object.getOwnPropertyNames(e).forEach(function (t) { var i = e[t]; -1 !== t.indexOf("aria-") || "role" === t || "type" === t ? (Ie.warn(xe(Fe, t, i)), n.setAttribute(t, i)) : "textContent" === t ? g(n, i) : n[t] = i }), Object.getOwnPropertyNames(i).forEach(function (t) { n.setAttribute(t, i[t]) }), r && M(n, r), n } function g(t, e) { return "undefined" == typeof t.textContent ? t.innerText = e : t.textContent = e, t } function y(t, e) { e.firstChild ? e.insertBefore(t, e.firstChild) : e.appendChild(t) } function v(t, e) { return l(e), t.classList ? t.classList.contains(e) : c(e).test(t.className) } function _(t, e) { return t.classList ? t.classList.add(e) : v(t, e) || (t.className = (t.className + " " + e).trim()), t } function b(t, e) { return t.classList ? t.classList.remove(e) : (l(e), t.className = t.className.split(/\s+/).filter(function (t) { return t !== e }).join(" ")), t } function T(t, e, i) { var r = v(t, e); return "function" == typeof i && (i = i(t, e)), "boolean" != typeof i && (i = !r), i !== r ? (i ? _(t, e) : b(t, e), t) : void 0 } function S(t, e) { Object.getOwnPropertyNames(e).forEach(function (i) { var r = e[i]; null === r || "undefined" == typeof r || r === !1 ? t.removeAttribute(i) : t.setAttribute(i, r === !0 ? "" : r) }) } function k(t) { var e = {}, i = ",autoplay,controls,playsinline,loop,muted,default,defaultMuted,"; if (t && t.attributes && t.attributes.length > 0) for (var r = t.attributes, n = r.length - 1; n >= 0; n--) { var a = r[n].name, s = r[n].value; ("boolean" == typeof t[a] || -1 !== i.indexOf("," + a + ",")) && (s = null !== s ? !0 : !1), e[a] = s } return e } function E(t, e) { return t.getAttribute(e) } function C(t, e, i) { t.setAttribute(e, i) } function w(t, e) { t.removeAttribute(e) } function A() { we.body.focus(), we.onselectstart = function () { return !1 } } function L() { we.onselectstart = function () { return !0 } } function P(t) { if (t && t.getBoundingClientRect && t.parentNode) { var e = t.getBoundingClientRect(), i = {}; return ["bottom", "height", "left", "right", "top", "width"].forEach(function (t) { void 0 !== e[t] && (i[t] = e[t]) }), i.height || (i.height = parseFloat(o(t, "height"))), i.width || (i.width = parseFloat(o(t, "width"))), i } } function O(t) { var e = void 0; if (t.getBoundingClientRect && t.parentNode && (e = t.getBoundingClientRect()), !e) return { left: 0, top: 0 }; var i = we.documentElement, r = we.body, n = i.clientLeft || r.clientLeft || 0, a = Te.pageXOffset || r.scrollLeft, s = e.left + a - n, o = i.clientTop || r.clientTop || 0, u = Te.pageYOffset || r.scrollTop, l = e.top + u - o; return { left: Math.round(s), top: Math.round(l) } } function I(t, e) { var i = {}, r = O(t), n = t.offsetWidth, a = t.offsetHeight, s = r.top, o = r.left, u = e.pageY, l = e.pageX; return e.changedTouches && (l = e.changedTouches[0].pageX, u = e.changedTouches[0].pageY), i.y = Math.max(0, Math.min(1, (s - u + a) / a)), i.x = Math.max(0, Math.min(1, (l - o) / n)), i } function x(t) { return a(t) && 3 === t.nodeType } function D(t) { for (; t.firstChild;)t.removeChild(t.firstChild); return t } function R(t) { return "function" == typeof t && (t = t()), (Array.isArray(t) ? t : [t]).map(function (t) { return "function" == typeof t && (t = t()), d(t) || x(t) ? t : "string" == typeof t && /\S/.test(t) ? we.createTextNode(t) : void 0 }).filter(function (t) { return t }) } function M(t, e) { return R(e).forEach(function (e) { return t.appendChild(e) }), t } function U(t, e) { return M(D(t), e) } function N(t) { return void 0 === t.button && void 0 === t.buttons ? !0 : 0 === t.button && void 0 === t.buttons ? !0 : 0 !== t.button || 1 !== t.buttons ? !1 : !0 } function B() { return We++ } function j(t) { var e = t[Ge]; return e || (e = t[Ge] = B()), ze[e] || (ze[e] = {}), ze[e] } function F(t) { var e = t[Ge]; return e ? !!Object.getOwnPropertyNames(ze[e]).length : !1 } function H(t) { var e = t[Ge]; if (e) { delete ze[e]; try { delete t[Ge] } catch (i) { t.removeAttribute ? t.removeAttribute(Ge) : t[Ge] = null } } } function V(t, e) { var i = j(t); 0 === i.handlers[e].length && (delete i.handlers[e], t.removeEventListener ? t.removeEventListener(e, i.dispatcher, !1) : t.detachEvent && t.detachEvent("on" + e, i.dispatcher)), Object.getOwnPropertyNames(i.handlers).length <= 0 && (delete i.handlers, delete i.dispatcher, delete i.disabled), 0 === Object.getOwnPropertyNames(i).length && H(t) } function q(t, e, i, r) { i.forEach(function (i) { t(e, i, r) }) } function W(t) { function e() { return !0 } function i() { return !1 } if (!t || !t.isPropagationStopped) { var r = t || Te.event; t = {}; for (var n in r) "layerX" !== n && "layerY" !== n && "keyLocation" !== n && "webkitMovementX" !== n && "webkitMovementY" !== n && ("returnValue" === n && r.preventDefault || (t[n] = r[n])); if (t.target || (t.target = t.srcElement || we), t.relatedTarget || (t.relatedTarget = t.fromElement === t.target ? t.toElement : t.fromElement), t.preventDefault = function () { r.preventDefault && r.preventDefault(), t.returnValue = !1, r.returnValue = !1, t.defaultPrevented = !0 }, t.defaultPrevented = !1, t.stopPropagation = function () { r.stopPropagation && r.stopPropagation(), t.cancelBubble = !0, r.cancelBubble = !0, t.isPropagationStopped = e }, t.isPropagationStopped = i, t.stopImmediatePropagation = function () { r.stopImmediatePropagation && r.stopImmediatePropagation(), t.isImmediatePropagationStopped = e, t.stopPropagation() }, t.isImmediatePropagationStopped = i, null !== t.clientX && void 0 !== t.clientX) { var a = we.documentElement, s = we.body; t.pageX = t.clientX + (a && a.scrollLeft || s && s.scrollLeft || 0) - (a && a.clientLeft || s && s.clientLeft || 0), t.pageY = t.clientY + (a && a.scrollTop || s && s.scrollTop || 0) - (a && a.clientTop || s && s.clientTop || 0) } t.which = t.charCode || t.keyCode, null !== t.button && void 0 !== t.button && (t.button = 1 & t.button ? 0 : 4 & t.button ? 1 : 2 & t.button ? 2 : 0) } return t } function z(t, e, i) { if (Array.isArray(e)) return q(z, t, e, i); var r = j(t); if (r.handlers || (r.handlers = {}), r.handlers[e] || (r.handlers[e] = []), i.guid || (i.guid = B()), r.handlers[e].push(i), r.dispatcher || (r.disabled = !1, r.dispatcher = function (e, i) { if (!r.disabled) { e = W(e); var n = r.handlers[e.type]; if (n) for (var a = n.slice(0), s = 0, o = a.length; o > s && !e.isImmediatePropagationStopped(); s++)try { a[s].call(t, e, i) } catch (u) { Ie.error(u) } } }), 1 === r.handlers[e].length) if (t.addEventListener) { var n = !1; Xe && Ye.indexOf(e) > -1 && (n = { passive: !0 }), t.addEventListener(e, r.dispatcher, n) } else t.attachEvent && t.attachEvent("on" + e, r.dispatcher) } function G(t, e, i) { if (F(t)) { var r = j(t); if (r.handlers) { if (Array.isArray(e)) return q(G, t, e, i); var n = function (t, e) { r.handlers[e] = [], V(t, e) }; if (void 0 !== e) { var a = r.handlers[e]; if (a) { if (!i) return void n(t, e); if (i.guid) for (var s = 0; s < a.length; s++)a[s].guid === i.guid && a.splice(s--, 1); V(t, e) } } else for (var o in r.handlers) Object.prototype.hasOwnProperty.call(r.handlers || {}, o) && n(t, o) } } } function X(t, e, i) { var r = F(t) ? j(t) : {}, n = t.parentNode || t.ownerDocument; if ("string" == typeof e ? e = { type: e, target: t } : e.target || (e.target = t), e = W(e), r.dispatcher && r.dispatcher.call(t, e, i), n && !e.isPropagationStopped() && e.bubbles === !0) X.call(null, n, e, i); else if (!n && !e.defaultPrevented) { var a = j(e.target); e.target[e.type] && (a.disabled = !0, "function" == typeof e.target[e.type] && e.target[e.type](), a.disabled = !1) } return !e.defaultPrevented } function Y(t, e, i) { if (Array.isArray(e)) return q(Y, t, e, i); var r = function n() { G(t, e, n), i.apply(this, arguments) }; r.guid = i.guid = i.guid || B(), z(t, e, r) } function $(t, e) { e && (Je = e), Te.setTimeout(Qe, t) } function K(t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = e.eventBusKey; if (i) { if (!t[i].nodeName) throw new Error('The eventBusKey "' + i + '" does not refer to an element.'); t.eventBusEl_ = t[i] } else t.eventBusEl_ = m("span", { className: "vjs-event-bus" }); return n(t, di), t.on("dispose", function () { t.off(), Te.setTimeout(function () { t.eventBusEl_ = null }, 0) }), t } function J(t, e) { return n(t, pi), t.state = n({}, t.state, e), "function" == typeof t.handleStateChanged && ai(t) && t.on("statechanged", t.handleStateChanged), t } function Q(t) { return "string" != typeof t ? t : t.charAt(0).toUpperCase() + t.slice(1) } function Z(t, e) { return Q(t) === Q(e) } function tt() { for (var t = {}, e = arguments.length, r = Array(e), n = 0; e > n; n++)r[n] = arguments[n]; return r.forEach(function (e) { e && i(e, function (e, i) { return s(e) ? (s(t[i]) || (t[i] = {}), void (t[i] = tt(t[i], e))) : void (t[i] = e) }) }), t } function et(t, e, i) { if ("number" != typeof e || 0 > e || e > i) throw new Error("Failed to execute '" + t + "' on 'TimeRanges': The index provided (" + e + ") is non-numeric or out of bounds (0-" + i + ").") } function it(t, e, i, r) { return et(t, r, i.length - 1), i[r][e] } function rt(t) { return void 0 === t || 0 === t.length ? { length: 0, start: function () { throw new Error("This TimeRanges object is empty") }, end: function () { throw new Error("This TimeRanges object is empty") } } : { length: t.length, start: it.bind(null, "start", 0, t), end: it.bind(null, "end", 1, t) } } function nt(t, e) { return Array.isArray(t) ? rt(t) : void 0 === t || void 0 === e ? rt() : rt([[t, e]]) } function at(t, e) { var i = 0, r = void 0, n = void 0; if (!e) return 0; t && t.length || (t = nt(0, 0)); for (var a = 0; a < t.length; a++)r = t.start(a), n = t.end(a), n > e && (n = e), i += n - r; return i / e } function st(t) { return t instanceof st ? t : ("number" == typeof t ? this.code = t : "string" == typeof t ? this.message = t : a(t) && ("number" == typeof t.code && (this.code = t.code), n(this, t)), void (this.message || (this.message = st.defaultMessages[this.code] || ""))) } function ot(t, e) { var i, r = null; try { i = JSON.parse(t, e) } catch (n) { r = n } return [r, i] } function ut(t) { return void 0 !== t && null !== t && "function" == typeof t.then } function lt(t) { ut(t) && t.then(null, function (t) { }) } function ct(t) { var e = gr.call(t); return "[object Function]" === e || "function" == typeof t && "[object RegExp]" !== e || "undefined" != typeof window && (t === window.setTimeout || t === window.alert || t === window.confirm || t === window.prompt) } function ht(t, e, i) { if (!Sr(e)) throw new TypeError("iterator must be a function"); arguments.length < 3 && (i = this), "[object Array]" === Er.call(t) ? dt(t, e, i) : "string" == typeof t ? pt(t, e, i) : ft(t, e, i) } function dt(t, e, i) { for (var r = 0, n = t.length; n > r; r++)Cr.call(t, r) && e.call(i, t[r], r, t) } function pt(t, e, i) { for (var r = 0, n = t.length; n > r; r++)e.call(i, t.charAt(r), r, t) } function ft(t, e, i) { for (var r in t) Cr.call(t, r) && e.call(i, t[r], r, t) } function mt() { for (var t = {}, e = 0; e < arguments.length; e++) { var i = arguments[e]; for (var r in i) Dr.call(i, r) && (t[r] = i[r]) } return t } function gt(t, e) { for (var i = 0; i < t.length; i++)e(t[i]) } function yt(t) { for (var e in t) if (t.hasOwnProperty(e)) return !1; return !0 } function vt(t, e, i) { var r = t; return Sr(e) ? (i = e, "string" == typeof t && (r = { uri: t })) : r = Ur(e, { uri: t }), r.callback = i, r } function _t(t, e, i) { return e = vt(t, e, i), bt(e) } function bt(t) { function e() { 4 === o.readyState && setTimeout(n, 0) } function i() { var t = void 0; if (t = o.response ? o.response : o.responseText || Tt(o), g) try { t = JSON.parse(t) } catch (e) { } return t } function r(t) { return clearTimeout(c), t instanceof Error || (t = new Error("" + (t || "Unknown XMLHttpRequest Error"))), t.statusCode = 0, s(t, y) } function n() { if (!l) { var e; clearTimeout(c), e = t.useXDR && void 0 === o.status ? 200 : 1223 === o.status ? 204 : o.status; var r = y, n = null; return 0 !== e ? (r = { body: i(), statusCode: e, method: d, headers: {}, url: h, rawRequest: o }, o.getAllResponseHeaders && (r.headers = Mr(o.getAllResponseHeaders()))) : n = new Error("Internal XMLHttpRequest Error"), s(n, r, r.body) } } if ("undefined" == typeof t.callback) throw new Error("callback argument missing"); var a = !1, s = function (e, i, r) { a || (a = !0, t.callback(e, i, r)) }, o = t.xhr || null; o || (o = t.cors || t.useXDR ? new _t.XDomainRequest : new _t.XMLHttpRequest); var u, l, c, h = o.url = t.uri || t.url, d = o.method = t.method || "GET", p = t.body || t.data, f = o.headers = t.headers || {}, m = !!t.sync, g = !1, y = { body: void 0, headers: {}, statusCode: 0, method: d, url: h, rawRequest: o }; if ("json" in t && t.json !== !1 && (g = !0, f.accept || f.Accept || (f.Accept = "application/json"), "GET" !== d && "HEAD" !== d && (f["content-type"] || f["Content-Type"] || (f["Content-Type"] = "application/json"), p = JSON.stringify(t.json === !0 ? p : t.json))), o.onreadystatechange = e, o.onload = n, o.onerror = r, o.onprogress = function () { }, o.onabort = function () { l = !0 }, o.ontimeout = r, o.open(d, h, !m, t.username, t.password), m || (o.withCredentials = !!t.withCredentials), !m && t.timeout > 0 && (c = setTimeout(function () { if (!l) { l = !0, o.abort("timeout"); var t = new Error("XMLHttpRequest timeout"); t.code = "ETIMEDOUT", r(t) } }, t.timeout)), o.setRequestHeader) for (u in f) f.hasOwnProperty(u) && o.setRequestHeader(u, f[u]); else if (t.headers && !yt(t.headers)) throw new Error("Headers cannot be set on an XDomainRequest object"); return "responseType" in t && (o.responseType = t.responseType), "beforeSend" in t && "function" == typeof t.beforeSend && t.beforeSend(o), o.send(p || null), o } function Tt(t) { if ("document" === t.responseType) return t.responseXML; var e = t.responseXML && "parsererror" === t.responseXML.documentElement.nodeName; return "" !== t.responseType || e ? null : t.responseXML } function St() { } function kt(t, e) { this.name = "ParsingError", this.code = t.code, this.message = e || t.message } function Et(t) { function e(t, e, i, r) { return 3600 * (0 | t) + 60 * (0 | e) + (0 | i) + (0 | r) / 1e3 } var i = t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/); return i ? i[3] ? e(i[1], i[2], i[3].replace(":", ""), i[4]) : i[1] > 59 ? e(i[1], i[2], 0, i[4]) : e(0, i[1], i[2], i[4]) : null } function Ct() { this.values = Jr(null) } function wt(t, e, i, r) { var n = r ? t.split(r) : [t]; for (var a in n) if ("string" == typeof n[a]) { var s = n[a].split(i); if (2 === s.length) { var o = s[0], u = s[1]; e(o, u) } } } function At(t, e, i) { function r() { var e = Et(t); if (null === e) throw new kt(kt.Errors.BadTimeStamp, "Malformed timestamp: " + s); return t = t.replace(/^[^\sa-zA-Z-]+/, ""), e } function n(t, e) { var r = new Ct; wt(t, function (t, e) { switch (t) { case "region": for (var n = i.length - 1; n >= 0; n--)if (i[n].id === e) { r.set(t, i[n].region); break } break; case "vertical": r.alt(t, e, ["rl", "lr"]); break; case "line": var a = e.split(","), s = a[0]; r.integer(t, s), r.percent(t, s) ? r.set("snapToLines", !1) : null, r.alt(t, s, ["auto"]), 2 === a.length && r.alt("lineAlign", a[1], ["start", "middle", "end"]); break; case "position": a = e.split(","), r.percent(t, a[0]), 2 === a.length && r.alt("positionAlign", a[1], ["start", "middle", "end"]); break; case "size": r.percent(t, e); break; case "align": r.alt(t, e, ["start", "middle", "end", "left", "right"]) } }, /:/, /\s/), e.region = r.get("region", null), e.vertical = r.get("vertical", ""), e.line = r.get("line", "auto"), e.lineAlign = r.get("lineAlign", "start"), e.snapToLines = r.get("snapToLines", !0), e.size = r.get("size", 100), e.align = r.get("align", "middle"), e.position = r.get("position", { start: 0, left: 0, middle: 50, end: 100, right: 100 }, e.align), e.positionAlign = r.get("positionAlign", { start: "start", left: "start", middle: "middle", end: "end", right: "end" }, e.align) } function a() { t = t.replace(/^\s+/, "") } var s = t; if (a(), e.startTime = r(), a(), "-->" !== t.substr(0, 3)) throw new kt(kt.Errors.BadTimeStamp, "Malformed time stamp (time stamps must be separated by '-->'): " + s); t = t.substr(3), a(), e.endTime = r(), a(), n(t, e) } function Lt(t, e) { function i() { function t(t) { return e = e.substr(t.length), t } if (!e) return null; var i = e.match(/^([^<]*)(<[^>]*>?)?/); return t(i[1] ? i[1] : i[2]) } function r(t) { return Qr[t] } function n(t) { for (; p = t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t = t.replace(p[0], r); return t } function a(t, e) { return !en[e.localName] || en[e.localName] === t.localName } function s(e, i) { var r = Zr[e]; if (!r) return null; var n = t.document.createElement(r); n.localName = r; var a = tn[e]; return a && i && (n[a] = i.trim()), n } for (var o, u = t.document.createElement("div"), l = u, c = []; null !== (o = i());)if ("<" !== o[0]) l.appendChild(t.document.createTextNode(n(o))); else { if ("/" === o[1]) { c.length && c[c.length - 1] === o.substr(2).replace(">", "") && (c.pop(), l = l.parentNode); continue } var h, d = Et(o.substr(1, o.length - 2)); if (d) { h = t.document.createProcessingInstruction("timestamp", d), l.appendChild(h); continue } var p = o.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/); if (!p) continue; if (h = s(p[1], p[3]), !h) continue; if (!a(l, h)) continue; p[2] && (h.className = p[2].substr(1).replace(".", " ")), c.push(p[1]), l.appendChild(h), l = h } return u } function Pt(t) { for (var e = 0; e < rn.length; e++) { var i = rn[e]; if (t >= i[0] && t <= i[1]) return !0 } return !1 } function Ot(t) { function e(t, e) { for (var i = e.childNodes.length - 1; i >= 0; i--)t.push(e.childNodes[i]) } function i(t) { if (!t || !t.length) return null; var r = t.pop(), n = r.textContent || r.innerText; if (n) { var a = n.match(/^.*(\n|\r)/); return a ? (t.length = 0, a[0]) : n } return "ruby" === r.tagName ? i(t) : r.childNodes ? (e(t, r), i(t)) : void 0 } var r, n = [], a = ""; if (!t || !t.childNodes) return "ltr"; for (e(n, t); a = i(n);)for (var s = 0; s < a.length; s++)if (r = a.charCodeAt(s), Pt(r)) return "rtl"; return "ltr" } function It(t) { if ("number" == typeof t.line && (t.snapToLines || t.line >= 0 && t.line <= 100)) return t.line; if (!t.track || !t.track.textTrackList || !t.track.textTrackList.mediaElement) return -1; for (var e = t.track, i = e.textTrackList, r = 0, n = 0; n < i.length && i[n] !== e; n++)"showing" === i[n].mode && r++; return -1 * ++r } function xt() { } function Dt(t, e, i) { xt.call(this), this.cue = e, this.cueDiv = Lt(t, e.text); var r = { color: "rgba(255, 255, 255, 1)", backgroundColor: "rgba(0, 0, 0, 0.8)", position: "relative", left: 0, right: 0, top: 0, bottom: 0, display: "inline", writingMode: "" === e.vertical ? "horizontal-tb" : "lr" === e.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext" }; this.applyStyles(r, this.cueDiv), this.div = t.document.createElement("div"), r = { direction: Ot(this.cueDiv), writingMode: "" === e.vertical ? "horizontal-tb" : "lr" === e.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext", textAlign: "middle" === e.align ? "center" : e.align, font: i.font, whiteSpace: "pre-line", position: "absolute" }, this.applyStyles(r), this.div.appendChild(this.cueDiv); var n = 0; switch (e.positionAlign) { case "start": n = e.position; break; case "middle": n = e.position - e.size / 2; break; case "end": n = e.position - e.size }"" === e.vertical ? this.applyStyles({ left: this.formatStyle(n, "%"), width: this.formatStyle(e.size, "%") }) : this.applyStyles({ top: this.formatStyle(n, "%"), height: this.formatStyle(e.size, "%") }), this.move = function (t) { this.applyStyles({ top: this.formatStyle(t.top, "px"), bottom: this.formatStyle(t.bottom, "px"), left: this.formatStyle(t.left, "px"), right: this.formatStyle(t.right, "px"), height: this.formatStyle(t.height, "px"), width: this.formatStyle(t.width, "px") }) } } function Rt(t) { var e, i, r, n; if (t.div) { i = t.div.offsetHeight, r = t.div.offsetWidth, n = t.div.offsetTop; var a = (a = t.div.childNodes) && (a = a[0]) && a.getClientRects && a.getClientRects(); t = t.div.getBoundingClientRect(), e = a ? Math.max(a[0] && a[0].height || 0, t.height / a.length) : 0 } this.left = t.left, this.right = t.right, this.top = t.top || n, this.height = t.height || i, this.bottom = t.bottom || n + (t.height || i), this.width = t.width || r, this.lineHeight = void 0 !== e ? e : t.lineHeight } function Mt(t, e, i, r) { function n(t, e) { for (var n, a = new Rt(t), s = 1, o = 0; o < e.length; o++) { for (; t.overlapsOppositeAxis(i, e[o]) || t.within(i) && t.overlapsAny(r);)t.move(e[o]); if (t.within(i)) return t; var u = t.intersectPercentage(i); s > u && (n = new Rt(t), s = u), t = new Rt(a) } return n || a } var a = new Rt(e), s = e.cue, o = It(s), u = []; if (s.snapToLines) { var l; switch (s.vertical) { case "": u = ["+y", "-y"], l = "height"; break; case "rl": u = ["+x", "-x"], l = "width"; break; case "lr": u = ["-x", "+x"], l = "width" }var c = a.lineHeight, h = c * Math.round(o), d = i[l] + c, p = u[0]; Math.abs(h) > d && (h = 0 > h ? -1 : 1, h *= Math.ceil(d / c) * c), 0 > o && (h += "" === s.vertical ? i.height : i.width, u = u.reverse()), a.move(p, h) } else { var f = a.lineHeight / i.height * 100; switch (s.lineAlign) { case "middle": o -= f / 2; break; case "end": o -= f }switch (s.vertical) { case "": e.applyStyles({ top: e.formatStyle(o, "%") }); break; case "rl": e.applyStyles({ left: e.formatStyle(o, "%") }); break; case "lr": e.applyStyles({ right: e.formatStyle(o, "%") }) }u = ["+y", "-x", "+x", "-y"], a = new Rt(e) } var m = n(a, u); e.move(m.toCSSCompatValues(i)) } function Ut() { } function Nt(t) { if ("string" != typeof t) return !1; var e = cn[t.toLowerCase()]; return e ? t.toLowerCase() : !1 } function Bt(t) { if ("string" != typeof t) return !1; var e = hn[t.toLowerCase()]; return e ? t.toLowerCase() : !1 } function jt(t, e, i) { this.hasBeenReset = !1; var r = "", n = !1, a = t, s = e, o = i, u = null, l = "", c = !0, h = "auto", d = "start", p = 50, f = "middle", m = 50, g = "middle"; Object.defineProperties(this, { id: { enumerable: !0, get: function () { return r }, set: function (t) { r = "" + t } }, pauseOnExit: { enumerable: !0, get: function () { return n }, set: function (t) { n = !!t } }, startTime: { enumerable: !0, get: function () { return a }, set: function (t) { if ("number" != typeof t) throw new TypeError("Start time must be set to a number."); a = t, this.hasBeenReset = !0 } }, endTime: { enumerable: !0, get: function () { return s }, set: function (t) { if ("number" != typeof t) throw new TypeError("End time must be set to a number."); s = t, this.hasBeenReset = !0 } }, text: { enumerable: !0, get: function () { return o }, set: function (t) { o = "" + t, this.hasBeenReset = !0 } }, region: { enumerable: !0, get: function () { return u }, set: function (t) { u = t, this.hasBeenReset = !0 } }, vertical: { enumerable: !0, get: function () { return l }, set: function (t) { var e = Nt(t); if (e === !1) throw new SyntaxError("An invalid or illegal string was specified."); l = e, this.hasBeenReset = !0 } }, snapToLines: { enumerable: !0, get: function () { return c }, set: function (t) { c = !!t, this.hasBeenReset = !0 } }, line: { enumerable: !0, get: function () { return h }, set: function (t) { if ("number" != typeof t && t !== ln) throw new SyntaxError("An invalid number or illegal string was specified."); h = t, this.hasBeenReset = !0 } }, lineAlign: { enumerable: !0, get: function () { return d }, set: function (t) { var e = Bt(t); if (!e) throw new SyntaxError("An invalid or illegal string was specified."); d = e, this.hasBeenReset = !0 } }, position: { enumerable: !0, get: function () { return p }, set: function (t) { if (0 > t || t > 100) throw new Error("Position must be between 0 and 100."); p = t, this.hasBeenReset = !0 } }, positionAlign: { enumerable: !0, get: function () { return f }, set: function (t) { var e = Bt(t); if (!e) throw new SyntaxError("An invalid or illegal string was specified."); f = e, this.hasBeenReset = !0 } }, size: { enumerable: !0, get: function () { return m }, set: function (t) { if (0 > t || t > 100) throw new Error("Size must be between 0 and 100."); m = t, this.hasBeenReset = !0 } }, align: { enumerable: !0, get: function () { return g }, set: function (t) { var e = Bt(t); if (!e) throw new SyntaxError("An invalid or illegal string was specified."); g = e, this.hasBeenReset = !0 } } }), this.displayState = void 0 } function Ft(t) { if ("string" != typeof t) return !1; var e = fn[t.toLowerCase()]; return e ? t.toLowerCase() : !1 } function Ht(t) { return "number" == typeof t && t >= 0 && 100 >= t } function Vt() { var t = 100, e = 3, i = 0, r = 100, n = 0, a = 100, s = ""; Object.defineProperties(this, { width: { enumerable: !0, get: function () { return t }, set: function (e) { if (!Ht(e)) throw new Error("Width must be between 0 and 100."); t = e } }, lines: { enumerable: !0, get: function () { return e }, set: function (t) { if ("number" != typeof t) throw new TypeError("Lines must be set to a number."); e = t } }, regionAnchorY: { enumerable: !0, get: function () { return r }, set: function (t) { if (!Ht(t)) throw new Error("RegionAnchorX must be between 0 and 100."); r = t } }, regionAnchorX: { enumerable: !0, get: function () { return i }, set: function (t) { if (!Ht(t)) throw new Error("RegionAnchorY must be between 0 and 100."); i = t } }, viewportAnchorY: { enumerable: !0, get: function () { return a }, set: function (t) { if (!Ht(t)) throw new Error("ViewportAnchorY must be between 0 and 100."); a = t } }, viewportAnchorX: { enumerable: !0, get: function () { return n }, set: function (t) { if (!Ht(t)) throw new Error("ViewportAnchorX must be between 0 and 100."); n = t } }, scroll: { enumerable: !0, get: function () { return s }, set: function (t) { var e = Ft(t); if (e === !1) throw new SyntaxError("An invalid or illegal string was specified."); s = e } } }) } function qt(t, e, i, r) { var n = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, a = t.textTracks(); n.kind = e, i && (n.label = i), r && (n.language = r), n.tech = t; var s = new Kr.text.TrackClass(n); return a.addTrack(s), s } function Wt(t, e) { Sn[t] = Sn[t] || [], Sn[t].push(e) } function zt(t, e, i) { t.setTimeout(function () { return te(e, Sn[e.type], i, t) }, 1) } function Gt(t, e) { t.forEach(function (t) { return t.setTech && t.setTech(e) }) } function Xt(t, e, i) { return t.reduceRight(Kt(i), e[i]()) } function Yt(t, e, i, r) { return e[i](t.reduce(Kt(i), r)) } function $t(t, e, i) { var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null, n = "call" + Q(i), a = t.reduce(Kt(n), r), s = a === En, o = s ? null : e[i](a); return Jt(t, i, o, s), o } function Kt(t) { return function (e, i) { return e === En ? En : i[t] ? i[t](e) : e } } function Jt(t, e, i, r) { for (var n = t.length - 1; n >= 0; n--) { var a = t[n]; a[e] && a[e](r, i) } } function Qt(t) { kn[t.id()] = null } function Zt(t, e) { var i = kn[t.id()], r = null; if (void 0 === i || null === i) return r = e(t), kn[t.id()] = [[e, r]], r; for (var n = 0; n < i.length; n++) { var a = i[n], s = a[0], o = a[1]; s === e && (r = o) } return null === r && (r = e(t), i.push([e, r])), r } function te() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [], i = arguments[2], r = arguments[3], a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : [], s = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : !1, o = e[0], u = e.slice(1); if ("string" == typeof o) te(t, Sn[o], i, r, a, s); else if (o) { var l = Zt(r, o); if (!l.setSource) return a.push(l), te(t, u, i, r, a, s); l.setSource(n({}, t), function (e, n) { return e ? te(t, u, i, r, a, s) : (a.push(l), void te(n, t.type === n.type ? u : Sn[n.type], i, r, a, s)) }) } else u.length ? te(t, u, i, r, a, s) : s ? i(t, a) : te(t, Sn["*"], i, r, a, !0) } function ee(t) { var e = Pn(t.src); return !t.type && e && (t.type = e), t } function ie(t, e) { var i = void 0; if (4 === t.length) i = t[1] + t[1] + t[2] + t[2] + t[3] + t[3]; else { if (7 !== t.length) throw new Error("Invalid color code provided, " + t + "; must be formatted as e.g. #f0e or #f604e2."); i = t.slice(1) } return "rgba(" + parseInt(i.slice(0, 2), 16) + "," + parseInt(i.slice(2, 4), 16) + "," + parseInt(i.slice(4, 6), 16) + "," + e + ")" } function re(t, e, i) { try { t.style[e] = i } catch (r) { return } } function ne(t) { zn = t } function ae() { zn = Wn } function se(t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : t; return zn(t, e) } function oe(t, e) { return e && (t = e(t)), t && "none" !== t ? t : void 0 } function ue(t, e) { var i = t.options[t.options.selectedIndex].value; return oe(i, e) } function le(t, e, i) { if (e) for (var r = 0; r < t.options.length; r++)if (oe(t.options[r].value, i) === e) { t.selectedIndex = r; break } } function ce(t, e, i) { var r = ce.getPlayer(t); if (r) return e && Ie.warn('Player "' + t + '" is already initialised. Options will not be applied.'), i && r.ready(i), r; var n = "string" == typeof t ? He("#" + Ps(t)) : t; if (!d(n)) throw new TypeError("The element or ID supplied is not valid. (videojs)"); we.body.contains(n) || Ie.warn("The element supplied is not included in the DOM"), e = e || {}, ce.hooks("beforesetup").forEach(function (t) { var i = t(n, tt(e)); return !a(i) || Array.isArray(i) ? void Ie.error("please return an object in beforesetup hooks") : void (e = tt(e, i)) }); var s = fi.getComponent("Player"); return r = new s(n, e, i), ce.hooks("setup").forEach(function (t) { return t(r) }), r } function he(t) { for (var e = Te.atob(t), i = new Uint8Array(e.length), r = 0; r < e.length; r++)i[r] = e.charCodeAt(r); return i } function de(t) { return t.subarray(0, t.byteLength - t[t.byteLength - 1]) } function pe(t, e) { return function (i) { var r = this; if (!e) return new Vc(t); if (Vc && !i) { var n = e.toString().replace(/^function.+?{/, "").slice(0, -1), a = fe(n); return this[Bc] = new Vc(a), me(this[Bc], a), this[Bc] } var s = { postMessage: function (t) { r.onmessage && setTimeout(function () { r.onmessage({ data: t, target: s }) }) } }; e.call(s), this.postMessage = function (t) { setTimeout(function () { s.onmessage({ data: t, target: r }) }) }, this.isThisThread = !0 } } function fe(t) { try { return Hc.createObjectURL(new Blob([t], { type: jc })) } catch (e) { var i = new Fc; return i.append(t), Hc.createObjectURL(i.getBlob(type)) } } function me(t, e) { if (t && e) { var i = t.terminate; t.objURL = e, t.terminate = function () { t.objURL && Hc.revokeObjectURL(t.objURL), i.call(t) } } } function ge() { } var ye, ve = "7.1.0", _e = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {}; ye = "undefined" != typeof window ? window : "undefined" != typeof _e ? _e : "undefined" != typeof self ? self : {}; var be, Te = ye, Se = {}, ke = Object.freeze({ "default": Se }), Ee = ke && Se || ke, Ce = "undefined" != typeof _e ? _e : "undefined" != typeof window ? window : {}; "undefined" != typeof document ? be = document : (be = Ce["__GLOBAL_DOCUMENT_CACHE@4"], be || (be = Ce["__GLOBAL_DOCUMENT_CACHE@4"] = Ee)); var we = be, Ae = void 0, Le = "info", Pe = [], Oe = function (t, e) { var i = Ae.levels[Le], r = new RegExp("^(" + i + ")$"); if ("log" !== t && e.unshift(t.toUpperCase() + ":"), Pe && Pe.push([].concat(e)), e.unshift("VIDEOJS:"), Te.console) { var n = Te.console[t]; n || "debug" !== t || (n = Te.console.info || Te.console.log), n && i && r.test(t) && n[Array.isArray(e) ? "apply" : "call"](Te.console, e) } }; Ae = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; Oe("log", e) }, Ae.levels = { all: "debug|log|warn|error", off: "", debug: "debug|log|warn|error", info: "log|warn|error", warn: "warn|error", error: "error", DEFAULT: Le }, Ae.level = function (t) { if ("string" == typeof t) { if (!Ae.levels.hasOwnProperty(t)) throw new Error('"' + t + '" in not a valid log level'); Le = t } return Le }, Ae.history = function () { return Pe ? [].concat(Pe) : [] }, Ae.history.clear = function () { Pe && (Pe.length = 0) }, Ae.history.disable = function () { null !== Pe && (Pe.length = 0, Pe = null) }, Ae.history.enable = function () { null === Pe && (Pe = []) }, Ae.error = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; return Oe("error", e) }, Ae.warn = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; return Oe("warn", e) }, Ae.debug = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; return Oe("debug", e) }; var Ie = Ae, xe = function (t) { for (var i = "", r = 0; r < arguments.length; r++)i += e(t[r]) + (arguments[r + 1] || ""); return i }, De = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, Re = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, Me = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e) }, Ue = function (t, e) { if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !e || "object" != typeof e && "function" != typeof e ? t : e }, Ne = function (t, e) { return t.raw = e, t }, Be = Object.prototype.toString, je = function (t) { return a(t) ? Object.keys(t) : [] }, Fe = Ne(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set ", " to ", "."], ["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set ", " to ", "."]), He = f("querySelector"), Ve = f("querySelectorAll"), qe = Object.freeze({ isReal: h, isEl: d, isInFrame: p, createEl: m, textContent: g, prependTo: y, hasClass: v, addClass: _, removeClass: b, toggleClass: T, setAttributes: S, getAttributes: k, getAttribute: E, setAttribute: C, removeAttribute: w, blockTextSelection: A, unblockTextSelection: L, getBoundingClientRect: P, findPosition: O, getPointerPosition: I, isTextNode: x, emptyEl: D, normalizeContent: R, appendContent: M, insertContent: U, isSingleLeftClick: N, $: He, $$: Ve }), We = 1, ze = {}, Ge = "vdata" + (new Date).getTime(), Xe = !1; !function () { try { var t = Object.defineProperty({}, "passive", { get: function () { Xe = !0 } }); Te.addEventListener("test", null, t), Te.removeEventListener("test", null, t) } catch (e) { } }(); var Ye = ["touchstart", "touchmove"], $e = Object.freeze({ fixEvent: W, on: z, off: G, trigger: X, one: Y }), Ke = !1, Je = void 0, Qe = function () {
    if (h() && Je.options.autoSetup !== !1) {
      var t = Array.prototype.slice.call(we.getElementsByTagName("video")), e = Array.prototype.slice.call(we.getElementsByTagName("audio")), i = Array.prototype.slice.call(we.getElementsByTagName("video-js")), r = t.concat(e, i);
      if (r && r.length > 0) for (var n = 0, a = r.length; a > n; n++) { var s = r[n]; if (!s || !s.getAttribute) { $(1); break } if (void 0 === s.player) { var o = s.getAttribute("data-setup"); null !== o && Je(s) } } else Ke || $(1)
    }
  }; h() && "complete" === we.readyState ? Ke = !0 : Y(Te, "load", function () { Ke = !0 }); var Ze = function (t) { var e = we.createElement("style"); return e.className = t, e }, ti = function (t, e) { t.styleSheet ? t.styleSheet.cssText = e : t.textContent = e }, ei = function (t, e, i) { e.guid || (e.guid = B()); var r = function () { return e.apply(t, arguments) }; return r.guid = i ? i + "_" + e.guid : e.guid, r }, ii = function (t, e) { var i = Date.now(), r = function () { var r = Date.now(); r - i >= e && (t.apply(void 0, arguments), i = r) }; return r }, ri = function (t, e, i) { var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : Te, n = void 0; return function () { var a = this, s = arguments, o = function () { n = null, o = null, i || t.apply(a, s) }; !n && i && t.apply(a, s), r.clearTimeout(n), n = r.setTimeout(o, e) } }, ni = function () { }; ni.prototype.allowedEvents_ = {}, ni.prototype.on = function (t, e) { var i = this.addEventListener; this.addEventListener = function () { }, z(this, t, e), this.addEventListener = i }, ni.prototype.addEventListener = ni.prototype.on, ni.prototype.off = function (t, e) { G(this, t, e) }, ni.prototype.removeEventListener = ni.prototype.off, ni.prototype.one = function (t, e) { var i = this.addEventListener; this.addEventListener = function () { }, Y(this, t, e), this.addEventListener = i }, ni.prototype.trigger = function (t) { var e = t.type || t; "string" == typeof t && (t = { type: e }), t = W(t), this.allowedEvents_[e] && this["on" + e] && this["on" + e](t), X(this, t) }, ni.prototype.dispatchEvent = ni.prototype.trigger; var ai = function (t) { return t instanceof ni || !!t.eventBusEl_ && ["on", "one", "off", "trigger"].every(function (e) { return "function" == typeof t[e] }) }, si = function (t) { return "string" == typeof t && /\S/.test(t) || Array.isArray(t) && !!t.length }, oi = function (t) { if (!t.nodeName && !ai(t)) throw new Error("Invalid target; must be a DOM node or evented object.") }, ui = function (t) { if (!si(t)) throw new Error("Invalid event type; must be a non-empty string or array.") }, li = function (t) { if ("function" != typeof t) throw new Error("Invalid listener; must be a function.") }, ci = function (t, e) { var i = e.length < 3 || e[0] === t || e[0] === t.eventBusEl_, r = void 0, n = void 0, a = void 0; return i ? (r = t.eventBusEl_, e.length >= 3 && e.shift(), n = e[0], a = e[1]) : (r = e[0], n = e[1], a = e[2]), oi(r), ui(n), li(a), a = ei(t, a), { isTargetingSelf: i, target: r, type: n, listener: a } }, hi = function (t, e, i, r) { oi(t), t.nodeName ? $e[e](t, i, r) : t[e](i, r) }, di = { on: function () { for (var t = this, e = arguments.length, i = Array(e), r = 0; e > r; r++)i[r] = arguments[r]; var n = ci(this, i), a = n.isTargetingSelf, s = n.target, o = n.type, u = n.listener; if (hi(s, "on", o, u), !a) { var l = function () { return t.off(s, o, u) }; l.guid = u.guid; var c = function () { return t.off("dispose", l) }; c.guid = u.guid, hi(this, "on", "dispose", l), hi(s, "on", "dispose", c) } }, one: function () { for (var t = this, e = arguments.length, i = Array(e), r = 0; e > r; r++)i[r] = arguments[r]; var n = ci(this, i), a = n.isTargetingSelf, s = n.target, o = n.type, u = n.listener; if (a) hi(s, "one", o, u); else { var l = function c() { for (var e = arguments.length, i = Array(e), r = 0; e > r; r++)i[r] = arguments[r]; t.off(s, o, c), u.apply(null, i) }; l.guid = u.guid, hi(s, "one", o, l) } }, off: function (t, e, i) { if (!t || si(t)) G(this.eventBusEl_, t, e); else { var r = t, n = e; oi(r), ui(n), li(i), i = ei(this, i), this.off("dispose", i), r.nodeName ? (G(r, n, i), G(r, "dispose", i)) : ai(r) && (r.off(n, i), r.off("dispose", i)) } }, trigger: function (t, e) { return X(this.eventBusEl_, t, e) } }, pi = { state: {}, setState: function (t) { var e = this; "function" == typeof t && (t = t()); var r = void 0; return i(t, function (t, i) { e.state[i] !== t && (r = r || {}, r[i] = { from: e.state[i], to: t }), e.state[i] = t }), r && ai(this) && this.trigger({ changes: r, type: "statechanged" }), r } }, fi = function () { function t(e, i, r) { if (Re(this, t), !e && this.play ? this.player_ = e = this : this.player_ = e, this.options_ = tt({}, this.options_), i = this.options_ = tt(this.options_, i), this.id_ = i.id || i.el && i.el.id, !this.id_) { var n = e && e.id && e.id() || "no_player"; this.id_ = n + "_component_" + B() } this.name_ = i.name || null, i.el ? this.el_ = i.el : i.createEl !== !1 && (this.el_ = this.createEl()), i.evented !== !1 && K(this, { eventBusKey: this.el_ ? "el_" : null }), J(this, this.constructor.defaultState), this.children_ = [], this.childIndex_ = {}, this.childNameIndex_ = {}, i.initChildren !== !1 && this.initChildren(), this.ready(r), i.reportTouchActivity !== !1 && this.enableTouchActivity() } return t.prototype.dispose = function () { if (this.trigger({ type: "dispose", bubbles: !1 }), this.children_) for (var t = this.children_.length - 1; t >= 0; t--)this.children_[t].dispose && this.children_[t].dispose(); this.children_ = null, this.childIndex_ = null, this.childNameIndex_ = null, this.el_ && (this.el_.parentNode && this.el_.parentNode.removeChild(this.el_), H(this.el_), this.el_ = null), this.player_ = null }, t.prototype.player = function () { return this.player_ }, t.prototype.options = function (t) { return Ie.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"), t ? (this.options_ = tt(this.options_, t), this.options_) : this.options_ }, t.prototype.el = function () { return this.el_ }, t.prototype.createEl = function (t, e, i) { return m(t, e, i) }, t.prototype.localize = function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : t, r = this.player_.language && this.player_.language(), n = this.player_.languages && this.player_.languages(), a = n && n[r], s = r && r.split("-")[0], o = n && n[s], u = i; return a && a[t] ? u = a[t] : o && o[t] && (u = o[t]), e && (u = u.replace(/\{(\d+)\}/g, function (t, i) { var r = e[i - 1], n = r; return "undefined" == typeof r && (n = t), n })), u }, t.prototype.contentEl = function () { return this.contentEl_ || this.el_ }, t.prototype.id = function () { return this.id_ }, t.prototype.name = function () { return this.name_ }, t.prototype.children = function () { return this.children_ }, t.prototype.getChildById = function (t) { return this.childIndex_[t] }, t.prototype.getChild = function (t) { return t ? (t = Q(t), this.childNameIndex_[t]) : void 0 }, t.prototype.addChild = function (e) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : this.children_.length, n = void 0, a = void 0; if ("string" == typeof e) { a = Q(e); var s = i.componentClass || a; i.name = a; var o = t.getComponent(s); if (!o) throw new Error("Component " + s + " does not exist"); if ("function" != typeof o) return null; n = new o(this.player_ || this, i) } else n = e; if (this.children_.splice(r, 0, n), "function" == typeof n.id && (this.childIndex_[n.id()] = n), a = a || n.name && Q(n.name()), a && (this.childNameIndex_[a] = n), "function" == typeof n.el && n.el()) { var u = this.contentEl().children, l = u[r] || null; this.contentEl().insertBefore(n.el(), l) } return n }, t.prototype.removeChild = function (t) { if ("string" == typeof t && (t = this.getChild(t)), t && this.children_) { for (var e = !1, i = this.children_.length - 1; i >= 0; i--)if (this.children_[i] === t) { e = !0, this.children_.splice(i, 1); break } if (e) { this.childIndex_[t.id()] = null, this.childNameIndex_[t.name()] = null; var r = t.el(); r && r.parentNode === this.contentEl() && this.contentEl().removeChild(t.el()) } } }, t.prototype.initChildren = function () { var e = this, i = this.options_.children; if (i) { var r = this.options_, n = function (t) { var i = t.name, n = t.opts; if (void 0 !== r[i] && (n = r[i]), n !== !1) { n === !0 && (n = {}), n.playerOptions = e.options_.playerOptions; var a = e.addChild(i, n); a && (e[i] = a) } }, a = void 0, s = t.getComponent("Tech"); a = Array.isArray(i) ? i : Object.keys(i), a.concat(Object.keys(this.options_).filter(function (t) { return !a.some(function (e) { return "string" == typeof e ? t === e : t === e.name }) })).map(function (t) { var r = void 0, n = void 0; return "string" == typeof t ? (r = t, n = i[r] || e.options_[r] || {}) : (r = t.name, n = t), { name: r, opts: n } }).filter(function (e) { var i = t.getComponent(e.opts.componentClass || Q(e.name)); return i && !s.isTech(i) }).forEach(n) } }, t.prototype.buildCSSClass = function () { return "" }, t.prototype.ready = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : !1; if (t) return this.isReady_ ? void (e ? t.call(this) : this.setTimeout(t, 1)) : (this.readyQueue_ = this.readyQueue_ || [], void this.readyQueue_.push(t)) }, t.prototype.triggerReady = function () { this.isReady_ = !0, this.setTimeout(function () { var t = this.readyQueue_; this.readyQueue_ = [], t && t.length > 0 && t.forEach(function (t) { t.call(this) }, this), this.trigger("ready") }, 1) }, t.prototype.$ = function (t, e) { return He(t, e || this.contentEl()) }, t.prototype.$$ = function (t, e) { return Ve(t, e || this.contentEl()) }, t.prototype.hasClass = function (t) { return v(this.el_, t) }, t.prototype.addClass = function (t) { _(this.el_, t) }, t.prototype.removeClass = function (t) { b(this.el_, t) }, t.prototype.toggleClass = function (t, e) { T(this.el_, t, e) }, t.prototype.show = function () { this.removeClass("vjs-hidden") }, t.prototype.hide = function () { this.addClass("vjs-hidden") }, t.prototype.lockShowing = function () { this.addClass("vjs-lock-showing") }, t.prototype.unlockShowing = function () { this.removeClass("vjs-lock-showing") }, t.prototype.getAttribute = function (t) { return E(this.el_, t) }, t.prototype.setAttribute = function (t, e) { C(this.el_, t, e) }, t.prototype.removeAttribute = function (t) { w(this.el_, t) }, t.prototype.width = function (t, e) { return this.dimension("width", t, e) }, t.prototype.height = function (t, e) { return this.dimension("height", t, e) }, t.prototype.dimensions = function (t, e) { this.width(t, !0), this.height(e) }, t.prototype.dimension = function (t, e, i) { if (void 0 !== e) return (null === e || e !== e) && (e = 0), -1 !== ("" + e).indexOf("%") || -1 !== ("" + e).indexOf("px") ? this.el_.style[t] = e : "auto" === e ? this.el_.style[t] = "" : this.el_.style[t] = e + "px", void (i || this.trigger("componentresize")); if (!this.el_) return 0; var r = this.el_.style[t], n = r.indexOf("px"); return -1 !== n ? parseInt(r.slice(0, n), 10) : parseInt(this.el_["offset" + Q(t)], 10) }, t.prototype.currentDimension = function (t) { var e = 0; if ("width" !== t && "height" !== t) throw new Error("currentDimension only accepts width or height value"); if ("function" == typeof Te.getComputedStyle) { var i = Te.getComputedStyle(this.el_); e = i.getPropertyValue(t) || i[t] } if (e = parseFloat(e), 0 === e) { var r = "offset" + Q(t); e = this.el_[r] } return e }, t.prototype.currentDimensions = function () { return { width: this.currentDimension("width"), height: this.currentDimension("height") } }, t.prototype.currentWidth = function () { return this.currentDimension("width") }, t.prototype.currentHeight = function () { return this.currentDimension("height") }, t.prototype.focus = function () { this.el_.focus() }, t.prototype.blur = function () { this.el_.blur() }, t.prototype.emitTapEvents = function () { var t = 0, e = null, i = 10, r = 200, n = void 0; this.on("touchstart", function (i) { 1 === i.touches.length && (e = { pageX: i.touches[0].pageX, pageY: i.touches[0].pageY }, t = (new Date).getTime(), n = !0) }), this.on("touchmove", function (t) { if (t.touches.length > 1) n = !1; else if (e) { var r = t.touches[0].pageX - e.pageX, a = t.touches[0].pageY - e.pageY, s = Math.sqrt(r * r + a * a); s > i && (n = !1) } }); var a = function () { n = !1 }; this.on("touchleave", a), this.on("touchcancel", a), this.on("touchend", function (i) { if (e = null, n === !0) { var a = (new Date).getTime() - t; r > a && (i.preventDefault(), this.trigger("tap")) } }) }, t.prototype.enableTouchActivity = function () { if (this.player() && this.player().reportUserActivity) { var t = ei(this.player(), this.player().reportUserActivity), e = void 0; this.on("touchstart", function () { t(), this.clearInterval(e), e = this.setInterval(t, 250) }); var i = function (i) { t(), this.clearInterval(e) }; this.on("touchmove", t), this.on("touchend", i), this.on("touchcancel", i) } }, t.prototype.setTimeout = function (t, e) { var i, r, n = this; return t = ei(this, t), i = Te.setTimeout(function () { n.off("dispose", r), t() }, e), r = function () { return n.clearTimeout(i) }, r.guid = "vjs-timeout-" + i, this.on("dispose", r), i }, t.prototype.clearTimeout = function (t) { Te.clearTimeout(t); var e = function () { }; return e.guid = "vjs-timeout-" + t, this.off("dispose", e), t }, t.prototype.setInterval = function (t, e) { var i = this; t = ei(this, t); var r = Te.setInterval(t, e), n = function () { return i.clearInterval(r) }; return n.guid = "vjs-interval-" + r, this.on("dispose", n), r }, t.prototype.clearInterval = function (t) { Te.clearInterval(t); var e = function () { }; return e.guid = "vjs-interval-" + t, this.off("dispose", e), t }, t.prototype.requestAnimationFrame = function (t) { var e, i, r = this; return this.supportsRaf_ ? (t = ei(this, t), e = Te.requestAnimationFrame(function () { r.off("dispose", i), t() }), i = function () { return r.cancelAnimationFrame(e) }, i.guid = "vjs-raf-" + e, this.on("dispose", i), e) : this.setTimeout(t, 1e3 / 60) }, t.prototype.cancelAnimationFrame = function (t) { if (this.supportsRaf_) { Te.cancelAnimationFrame(t); var e = function () { }; return e.guid = "vjs-raf-" + t, this.off("dispose", e), t } return this.clearTimeout(t) }, t.registerComponent = function (e, i) { if ("string" != typeof e || !e) throw new Error('Illegal component name, "' + e + '"; must be a non-empty string.'); var r = t.getComponent("Tech"), n = r && r.isTech(i), a = t === i || t.prototype.isPrototypeOf(i.prototype); if (n || !a) { var s = void 0; throw s = n ? "techs must be registered using Tech.registerTech()" : "must be a Component subclass", new Error('Illegal component, "' + e + '"; ' + s + ".") } e = Q(e), t.components_ || (t.components_ = {}); var o = t.getComponent("Player"); if ("Player" === e && o && o.players) { var u = o.players, l = Object.keys(u); if (u && l.length > 0 && l.map(function (t) { return u[t] }).every(Boolean)) throw new Error("Can not register Player component after player has been created.") } return t.components_[e] = i, i }, t.getComponent = function (e) { return e ? (e = Q(e), t.components_ && t.components_[e] ? t.components_[e] : void 0) : void 0 }, t }(); fi.prototype.supportsRaf_ = "function" == typeof Te.requestAnimationFrame && "function" == typeof Te.cancelAnimationFrame, fi.registerComponent("Component", fi); for (var mi = Te.navigator && Te.navigator.userAgent || "", gi = /AppleWebKit\/([\d.]+)/i.exec(mi), yi = gi ? parseFloat(gi.pop()) : null, vi = /iPad/i.test(mi), _i = /iPhone/i.test(mi) && !vi, bi = /iPod/i.test(mi), Ti = _i || vi || bi, Si = function () { var t = mi.match(/OS (\d+)_/i); return t && t[1] ? t[1] : null }(), ki = /Android/i.test(mi), Ei = function () { var t = mi.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i); if (!t) return null; var e = t[1] && parseFloat(t[1]), i = t[2] && parseFloat(t[2]); return e && i ? parseFloat(t[1] + "." + t[2]) : e ? e : null }(), Ci = ki && 5 > Ei && 537 > yi, wi = /Firefox/i.test(mi), Ai = /Edge/i.test(mi), Li = !Ai && (/Chrome/i.test(mi) || /CriOS/i.test(mi)), Pi = function () { var t = mi.match(/(Chrome|CriOS)\/(\d+)/); return t && t[2] ? parseFloat(t[2]) : null }(), Oi = function () { var t = /MSIE\s(\d+)\.\d/.exec(mi), e = t && parseFloat(t[1]); return !e && /Trident\/7.0/i.test(mi) && /rv:11.0/.test(mi) && (e = 11), e }(), Ii = /Safari/i.test(mi) && !Li && !ki && !Ai, xi = (Ii || Ti) && !Li, Di = (h() && ("ontouchstart" in Te || Te.navigator.maxTouchPoints || Te.DocumentTouch && Te.document instanceof Te.DocumentTouch)), Ri = Object.freeze({ IS_IPAD: vi, IS_IPHONE: _i, IS_IPOD: bi, IS_IOS: Ti, IOS_VERSION: Si, IS_ANDROID: ki, ANDROID_VERSION: Ei, IS_NATIVE_ANDROID: Ci, IS_FIREFOX: wi, IS_EDGE: Ai, IS_CHROME: Li, CHROME_VERSION: Pi, IE_VERSION: Oi, IS_SAFARI: Ii, IS_ANY_SAFARI: xi, TOUCH_ENABLED: Di }), Mi = {}, Ui = [["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror"], ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror"], ["webkitRequestFullScreen", "webkitCancelFullScreen", "webkitCurrentFullScreenElement", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitfullscreenerror"], ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror"], ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError"]], Ni = Ui[0], Bi = void 0, ji = 0; ji < Ui.length; ji++)if (Ui[ji][1] in we) { Bi = Ui[ji]; break } if (Bi) for (var Fi = 0; Fi < Bi.length; Fi++)Mi[Ni[Fi]] = Bi[Fi]; st.prototype.code = 0, st.prototype.message = "", st.prototype.status = null, st.errorTypes = ["MEDIA_ERR_CUSTOM", "MEDIA_ERR_ABORTED", "MEDIA_ERR_NETWORK", "MEDIA_ERR_DECODE", "MEDIA_ERR_SRC_NOT_SUPPORTED", "MEDIA_ERR_ENCRYPTED"], st.defaultMessages = { 1: "You aborted the media playback", 2: "A network error caused the media download to fail part-way.", 3: "The media playback was aborted due to a corruption problem or because the media used features your browser did not support.", 4: "The media could not be loaded, either because the server or network failed or because the format is not supported.", 5: "The media is encrypted and we do not have the keys to decrypt it." }; for (var Hi = 0; Hi < st.errorTypes.length; Hi++)st[st.errorTypes[Hi]] = Hi, st.prototype[st.errorTypes[Hi]] = Hi; var Vi = ot, qi = function (t) { var e = ["kind", "label", "language", "id", "inBandMetadataTrackDispatchType", "mode", "src"].reduce(function (e, i, r) { return t[i] && (e[i] = t[i]), e }, { cues: t.cues && Array.prototype.map.call(t.cues, function (t) { return { startTime: t.startTime, endTime: t.endTime, text: t.text, id: t.id } }) }); return e }, Wi = function (t) { var e = t.$$("track"), i = Array.prototype.map.call(e, function (t) { return t.track }), r = Array.prototype.map.call(e, function (t) { var e = qi(t.track); return t.src && (e.src = t.src), e }); return r.concat(Array.prototype.filter.call(t.textTracks(), function (t) { return -1 === i.indexOf(t) }).map(qi)) }, zi = function (t, e) { return t.forEach(function (t) { var i = e.addRemoteTextTrack(t).track; !t.src && t.cues && t.cues.forEach(function (t) { return i.addCue(t) }) }), e.textTracks() }, Gi = { textTracksToJson: Wi, jsonToTextTracks: zi, trackToJson_: qi }, Xi = "vjs-modal-dialog", Yi = 27, $i = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.opened_ = n.hasBeenOpened_ = n.hasBeenFilled_ = !1, n.closeable(!n.options_.uncloseable), n.content(n.options_.content), n.contentEl_ = m("div", { className: Xi + "-content" }, { role: "document" }), n.descEl_ = m("p", { className: Xi + "-description vjs-control-text", id: n.el().getAttribute("aria-describedby") }), g(n.descEl_, n.description()), n.el_.appendChild(n.descEl_), n.el_.appendChild(n.contentEl_), n } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: this.buildCSSClass(), tabIndex: -1 }, { "aria-describedby": this.id() + "_description", "aria-hidden": "true", "aria-label": this.label(), role: "dialog" }) }, e.prototype.dispose = function () { this.contentEl_ = null, this.descEl_ = null, this.previouslyActiveEl_ = null, t.prototype.dispose.call(this) }, e.prototype.buildCSSClass = function () { return Xi + " vjs-hidden " + t.prototype.buildCSSClass.call(this) }, e.prototype.handleKeyPress = function (t) { t.which === Yi && this.closeable() && this.close() }, e.prototype.label = function () { return this.localize(this.options_.label || "Modal Window") }, e.prototype.description = function () { var t = this.options_.description || this.localize("This is a modal window."); return this.closeable() && (t += " " + this.localize("This modal can be closed by pressing the Escape key or activating the close button.")), t }, e.prototype.open = function () { if (!this.opened_) { var t = this.player(); this.trigger("beforemodalopen"), this.opened_ = !0, (this.options_.fillAlways || !this.hasBeenOpened_ && !this.hasBeenFilled_) && this.fill(), this.wasPlaying_ = !t.paused(), this.options_.pauseOnOpen && this.wasPlaying_ && t.pause(), this.closeable() && this.on(this.el_.ownerDocument, "keydown", ei(this, this.handleKeyPress)), this.hadControls_ = t.controls(), t.controls(!1), this.show(), this.conditionalFocus_(), this.el().setAttribute("aria-hidden", "false"), this.trigger("modalopen"), this.hasBeenOpened_ = !0 } }, e.prototype.opened = function (t) { return "boolean" == typeof t && this[t ? "open" : "close"](), this.opened_ }, e.prototype.close = function () { if (this.opened_) { var t = this.player(); this.trigger("beforemodalclose"), this.opened_ = !1, this.wasPlaying_ && this.options_.pauseOnOpen && t.play(), this.closeable() && this.off(this.el_.ownerDocument, "keydown", ei(this, this.handleKeyPress)), this.hadControls_ && t.controls(!0), this.hide(), this.el().setAttribute("aria-hidden", "true"), this.trigger("modalclose"), this.conditionalBlur_(), this.options_.temporary && this.dispose() } }, e.prototype.closeable = function i(t) { if ("boolean" == typeof t) { var i = this.closeable_ = !!t, e = this.getChild("closeButton"); if (i && !e) { var r = this.contentEl_; this.contentEl_ = this.el_, e = this.addChild("closeButton", { controlText: "Close Modal Dialog" }), this.contentEl_ = r, this.on(e, "close", this.close) } !i && e && (this.off(e, "close", this.close), this.removeChild(e), e.dispose()) } return this.closeable_ }, e.prototype.fill = function () { this.fillWith(this.content()) }, e.prototype.fillWith = function (t) { var e = this.contentEl(), i = e.parentNode, r = e.nextSibling; this.trigger("beforemodalfill"), this.hasBeenFilled_ = !0, i.removeChild(e), this.empty(), U(e, t), this.trigger("modalfill"), r ? i.insertBefore(e, r) : i.appendChild(e); var n = this.getChild("closeButton"); n && i.appendChild(n.el_) }, e.prototype.empty = function () { this.trigger("beforemodalempty"), D(this.contentEl()), this.trigger("modalempty") }, e.prototype.content = function (t) { return "undefined" != typeof t && (this.content_ = t), this.content_ }, e.prototype.conditionalFocus_ = function () { var t = we.activeElement, e = this.player_.el_; this.previouslyActiveEl_ = null, (e.contains(t) || e === t) && (this.previouslyActiveEl_ = t, this.focus(), this.on(we, "keydown", this.handleKeyDown)) }, e.prototype.conditionalBlur_ = function () { this.previouslyActiveEl_ && (this.previouslyActiveEl_.focus(), this.previouslyActiveEl_ = null), this.off(we, "keydown", this.handleKeyDown) }, e.prototype.handleKeyDown = function (t) { if (9 === t.which) { for (var e = this.focusableEls_(), i = this.el_.querySelector(":focus"), r = void 0, n = 0; n < e.length; n++)if (i === e[n]) { r = n; break } we.activeElement === this.el_ && (r = 0), t.shiftKey && 0 === r ? (e[e.length - 1].focus(), t.preventDefault()) : t.shiftKey || r !== e.length - 1 || (e[0].focus(), t.preventDefault()) } }, e.prototype.focusableEls_ = function () { var t = this.el_.querySelectorAll("*"); return Array.prototype.filter.call(t, function (t) { return (t instanceof Te.HTMLAnchorElement || t instanceof Te.HTMLAreaElement) && t.hasAttribute("href") || (t instanceof Te.HTMLInputElement || t instanceof Te.HTMLSelectElement || t instanceof Te.HTMLTextAreaElement || t instanceof Te.HTMLButtonElement) && !t.hasAttribute("disabled") || t instanceof Te.HTMLIFrameElement || t instanceof Te.HTMLObjectElement || t instanceof Te.HTMLEmbedElement || t.hasAttribute("tabindex") && -1 !== t.getAttribute("tabindex") || t.hasAttribute("contenteditable") }) }, e }(fi); $i.prototype.options_ = { pauseOnOpen: !0, temporary: !0 }, fi.registerComponent("ModalDialog", $i); var Ki = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []; Re(this, e); var r = Ue(this, t.call(this)); r.tracks_ = [], Object.defineProperty(r, "length", { get: function () { return this.tracks_.length } }); for (var n = 0; n < i.length; n++)r.addTrack(i[n]); return r } return Me(e, t), e.prototype.addTrack = function (t) { var e = this.tracks_.length; "" + e in this || Object.defineProperty(this, e, { get: function () { return this.tracks_[e] } }), -1 === this.tracks_.indexOf(t) && (this.tracks_.push(t), this.trigger({ track: t, type: "addtrack" })) }, e.prototype.removeTrack = function (t) { for (var e = void 0, i = 0, r = this.length; r > i; i++)if (this[i] === t) { e = this[i], e.off && e.off(), this.tracks_.splice(i, 1); break } e && this.trigger({ track: e, type: "removetrack" }) }, e.prototype.getTrackById = function (t) { for (var e = null, i = 0, r = this.length; r > i; i++) { var n = this[i]; if (n.id === t) { e = n; break } } return e }, e }(ni); Ki.prototype.allowedEvents_ = { change: "change", addtrack: "addtrack", removetrack: "removetrack" }; for (var Ji in Ki.prototype.allowedEvents_) Ki.prototype["on" + Ji] = null; var Qi = function (t, e) { for (var i = 0; i < t.length; i++)Object.keys(t[i]).length && e.id !== t[i].id && (t[i].enabled = !1) }, Zi = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []; Re(this, e); for (var r = i.length - 1; r >= 0; r--)if (i[r].enabled) { Qi(i, i[r]); break } var n = Ue(this, t.call(this, i)); return n.changing_ = !1, n } return Me(e, t), e.prototype.addTrack = function (e) { var i = this; e.enabled && Qi(this, e), t.prototype.addTrack.call(this, e), e.addEventListener && e.addEventListener("enabledchange", function () { i.changing_ || (i.changing_ = !0, Qi(i, e), i.changing_ = !1, i.trigger("change")) }) }, e }(Ki), tr = function (t, e) { for (var i = 0; i < t.length; i++)Object.keys(t[i]).length && e.id !== t[i].id && (t[i].selected = !1) }, er = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []; Re(this, e); for (var r = i.length - 1; r >= 0; r--)if (i[r].selected) { tr(i, i[r]); break } var n = Ue(this, t.call(this, i)); return n.changing_ = !1, Object.defineProperty(n, "selectedIndex", { get: function () { for (var t = 0; t < this.length; t++)if (this[t].selected) return t; return -1 }, set: function () { } }), n } return Me(e, t), e.prototype.addTrack = function (e) { var i = this; e.selected && tr(this, e), t.prototype.addTrack.call(this, e), e.addEventListener && e.addEventListener("selectedchange", function () { i.changing_ || (i.changing_ = !0, tr(i, e), i.changing_ = !1, i.trigger("change")) }) }, e }(Ki), ir = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.addTrack = function (e) { t.prototype.addTrack.call(this, e), e.addEventListener("modechange", ei(this, function () { this.trigger("change") })); var i = ["metadata", "chapters"]; -1 === i.indexOf(e.kind) && e.addEventListener("modechange", ei(this, function () { this.trigger("selectedlanguagechange") })) }, e }(Ki), rr = function () { function t() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []; Re(this, t), this.trackElements_ = [], Object.defineProperty(this, "length", { get: function () { return this.trackElements_.length } }); for (var i = 0, r = e.length; r > i; i++)this.addTrackElement_(e[i]) } return t.prototype.addTrackElement_ = function (t) { var e = this.trackElements_.length; "" + e in this || Object.defineProperty(this, e, { get: function () { return this.trackElements_[e] } }), -1 === this.trackElements_.indexOf(t) && this.trackElements_.push(t) }, t.prototype.getTrackElementByTrack_ = function (t) { for (var e = void 0, i = 0, r = this.trackElements_.length; r > i; i++)if (t === this.trackElements_[i].track) { e = this.trackElements_[i]; break } return e }, t.prototype.removeTrackElement_ = function (t) { for (var e = 0, i = this.trackElements_.length; i > e; e++)if (t === this.trackElements_[e]) { this.trackElements_.splice(e, 1); break } }, t }(), nr = function () { function t(e) { Re(this, t), t.prototype.setCues_.call(this, e), Object.defineProperty(this, "length", { get: function () { return this.length_ } }) } return t.prototype.setCues_ = function (t) { var e = this.length || 0, i = 0, r = t.length; this.cues_ = t, this.length_ = t.length; var n = function (t) { "" + t in this || Object.defineProperty(this, "" + t, { get: function () { return this.cues_[t] } }) }; if (r > e) for (i = e; r > i; i++)n.call(this, i) }, t.prototype.getCueById = function (t) { for (var e = null, i = 0, r = this.length; r > i; i++) { var n = this[i]; if (n.id === t) { e = n; break } } return e }, t }(), ar = { alternative: "alternative", captions: "captions", main: "main", sign: "sign", subtitles: "subtitles", commentary: "commentary" }, sr = { alternative: "alternative", descriptions: "descriptions", main: "main", "main-desc": "main-desc", translation: "translation", commentary: "commentary" }, or = { subtitles: "subtitles", captions: "captions", descriptions: "descriptions", chapters: "chapters", metadata: "metadata" }, ur = { disabled: "disabled", hidden: "hidden", showing: "showing" }, lr = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; Re(this, e); var r = Ue(this, t.call(this)), n = { id: i.id || "vjs_track_" + B(), kind: i.kind || "", label: i.label || "", language: i.language || "" }, a = function (t) { Object.defineProperty(r, t, { get: function () { return n[t] }, set: function () { } }) }; for (var s in n) a(s); return r } return Me(e, t), e }(ni), cr = function (t) { var e = ["protocol", "hostname", "port", "pathname", "search", "hash", "host"], i = we.createElement("a"); i.href = t; var r = "" === i.host && "file:" !== i.protocol, n = void 0; r && (n = we.createElement("div"), n.innerHTML = '<a href="' + t + '"></a>', i = n.firstChild, n.setAttribute("style", "display:none; position:absolute;"), we.body.appendChild(n)); for (var a = {}, s = 0; s < e.length; s++)a[e[s]] = i[e[s]]; return "http:" === a.protocol && (a.host = a.host.replace(/:80$/, "")), "https:" === a.protocol && (a.host = a.host.replace(/:443$/, "")), a.protocol || (a.protocol = Te.location.protocol), r && we.body.removeChild(n), a }, hr = function (t) { if (!t.match(/^https?:\/\//)) { var e = we.createElement("div"); e.innerHTML = '<a href="' + t + '">x</a>', t = e.firstChild.href } return t }, dr = function (t) { if ("string" == typeof t) { var e = /^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i, i = e.exec(t); if (i) return i.pop().toLowerCase() } return "" }, pr = function (t) { var e = Te.location, i = cr(t), r = ":" === i.protocol ? e.protocol : i.protocol, n = r + i.host !== e.protocol + e.host; return n }, fr = Object.freeze({ parseUrl: cr, getAbsoluteURL: hr, getFileExtension: dr, isCrossOrigin: pr }), mr = ct, gr = Object.prototype.toString, yr = Object.freeze({ "default": mr, __moduleExports: mr }), vr = t(function (t, e) { function i(t) { return t.replace(/^\s*|\s*$/g, "") } e = t.exports = i, e.left = function (t) { return t.replace(/^\s*/, "") }, e.right = function (t) { return t.replace(/\s*$/, "") } }), _r = vr.left, br = vr.right, Tr = Object.freeze({ "default": vr, __moduleExports: vr, left: _r, right: br }), Sr = yr && mr || yr, kr = ht, Er = Object.prototype.toString, Cr = Object.prototype.hasOwnProperty, wr = Object.freeze({ "default": kr, __moduleExports: kr }), Ar = Tr && vr || Tr, Lr = wr && kr || wr, Pr = function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, Or = function (t) { if (!t) return {}; var e = {}; return Lr(Ar(t).split("\n"), function (t) { var i = t.indexOf(":"), r = Ar(t.slice(0, i)).toLowerCase(), n = Ar(t.slice(i + 1)); "undefined" == typeof e[r] ? e[r] = n : Pr(e[r]) ? e[r].push(n) : e[r] = [e[r], n] }), e }, Ir = Object.freeze({ "default": Or, __moduleExports: Or }), xr = mt, Dr = Object.prototype.hasOwnProperty, Rr = Object.freeze({ "default": xr, __moduleExports: xr }), Mr = Ir && Or || Ir, Ur = Rr && xr || Rr, Nr = _t; _t.XMLHttpRequest = Te.XMLHttpRequest || St, _t.XDomainRequest = "withCredentials" in new _t.XMLHttpRequest ? _t.XMLHttpRequest : Te.XDomainRequest, gt(["get", "put", "post", "patch", "head", "delete"], function (t) { _t["delete" === t ? "del" : t] = function (e, i, r) { return i = vt(e, i, r), i.method = t.toUpperCase(), bt(i) } }); var Br = function (t, e) { var i = new Te.WebVTT.Parser(Te, Te.vttjs, Te.WebVTT.StringDecoder()), r = []; i.oncue = function (t) { e.addCue(t) }, i.onparsingerror = function (t) { r.push(t) }, i.onflush = function () { e.trigger({ type: "loadeddata", target: e }) }, i.parse(t), r.length > 0 && (Te.console && Te.console.groupCollapsed && Te.console.groupCollapsed("Text Track parsing errors for " + e.src), r.forEach(function (t) { return Ie.error(t) }), Te.console && Te.console.groupEnd && Te.console.groupEnd()), i.flush() }, jr = function (t, e) { var i = { uri: t }, r = pr(t); r && (i.cors = r), Nr(i, ei(this, function (t, i, r) { if (t) return Ie.error(t, i); if (e.loaded_ = !0, "function" != typeof Te.WebVTT) { if (e.tech_) { var n = function () { return Br(r, e) }; e.tech_.on("vttjsloaded", n), e.tech_.on("vttjserror", function () { Ie.error("vttjs failed to load, stopping trying to process " + e.src), e.tech_.off("vttjsloaded", n) }) } } else Br(r, e) })) }, Fr = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; if (Re(this, e), !i.tech) throw new Error("A tech was not provided."); var r = tt(i, { kind: or[i.kind] || "subtitles", language: i.language || i.srclang || "" }), n = ur[r.mode] || "disabled", a = r["default"]; ("metadata" === r.kind || "chapters" === r.kind) && (n = "hidden"); var s = Ue(this, t.call(this, r)); s.tech_ = r.tech, s.cues_ = [], s.activeCues_ = []; var o = new nr(s.cues_), u = new nr(s.activeCues_), l = !1, c = ei(s, function () { this.activeCues, l && (this.trigger("cuechange"), l = !1) }); return "disabled" !== n && s.tech_.ready(function () { s.tech_.on("timeupdate", c) }, !0), Object.defineProperties(s, { "default": { get: function () { return a }, set: function () { } }, mode: { get: function () { return n }, set: function (t) { var e = this; ur[t] && (n = t, "showing" === n && this.tech_.ready(function () { e.tech_.on("timeupdate", c) }, !0), this.trigger("modechange")) } }, cues: { get: function () { return this.loaded_ ? o : null }, set: function () { } }, activeCues: { get: function () { if (!this.loaded_) return null; if (0 === this.cues.length) return u; for (var t = this.tech_.currentTime(), e = [], i = 0, r = this.cues.length; r > i; i++) { var n = this.cues[i]; n.startTime <= t && n.endTime >= t ? e.push(n) : n.startTime === n.endTime && n.startTime <= t && n.startTime + .5 >= t && e.push(n) } if (l = !1, e.length !== this.activeCues_.length) l = !0; else for (var a = 0; a < e.length; a++)-1 === this.activeCues_.indexOf(e[a]) && (l = !0); return this.activeCues_ = e, u.setCues_(this.activeCues_), u }, set: function () { } } }), r.src ? (s.src = r.src, jr(r.src, s)) : s.loaded_ = !0, s } return Me(e, t), e.prototype.addCue = function (t) { var e = t; if (Te.vttjs && !(t instanceof Te.vttjs.VTTCue)) { e = new Te.vttjs.VTTCue(t.startTime, t.endTime, t.text); for (var i in t) i in e || (e[i] = t[i]); e.id = t.id, e.originalCue_ = t } for (var r = this.tech_.textTracks(), n = 0; n < r.length; n++)r[n] !== this && r[n].removeCue(e); this.cues_.push(e), this.cues.setCues_(this.cues_) }, e.prototype.removeCue = function (t) { for (var e = this.cues_.length; e--;) { var i = this.cues_[e]; if (i === t || i.originalCue_ && i.originalCue_ === t) { this.cues_.splice(e, 1), this.cues.setCues_(this.cues_); break } } }, e }(lr); Fr.prototype.allowedEvents_ = { cuechange: "cuechange" }; var Hr = function (t) {
    function e() {
      var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; Re(this, e); var r = tt(i, { kind: sr[i.kind] || "" }), n = Ue(this, t.call(this, r)), a = !1; return Object.defineProperty(n, "enabled", {
        get: function () { return a }, set: function (t) { "boolean" == typeof t && t !== a && (a = t, this.trigger("enabledchange")) }
      }), r.enabled && (n.enabled = r.enabled), n.loaded_ = !0, n
    } return Me(e, t), e
  }(lr), Vr = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; Re(this, e); var r = tt(i, { kind: ar[i.kind] || "" }), n = Ue(this, t.call(this, r)), a = !1; return Object.defineProperty(n, "selected", { get: function () { return a }, set: function (t) { "boolean" == typeof t && t !== a && (a = t, this.trigger("selectedchange")) } }), r.selected && (n.selected = r.selected), n } return Me(e, t), e }(lr), qr = 0, Wr = 1, zr = 2, Gr = 3, Xr = function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; Re(this, e); var r = Ue(this, t.call(this)), n = void 0, a = new Fr(i); return r.kind = a.kind, r.src = a.src, r.srclang = a.language, r.label = a.label, r["default"] = a["default"], Object.defineProperties(r, { readyState: { get: function () { return n } }, track: { get: function () { return a } } }), n = qr, a.addEventListener("loadeddata", function () { n = zr, r.trigger({ type: "load", target: r }) }), r } return Me(e, t), e }(ni); Xr.prototype.allowedEvents_ = { load: "load" }, Xr.NONE = qr, Xr.LOADING = Wr, Xr.LOADED = zr, Xr.ERROR = Gr; var Yr = { audio: { ListClass: Zi, TrackClass: Hr, capitalName: "Audio" }, video: { ListClass: er, TrackClass: Vr, capitalName: "Video" }, text: { ListClass: ir, TrackClass: Fr, capitalName: "Text" } }; Object.keys(Yr).forEach(function (t) { Yr[t].getterName = t + "Tracks", Yr[t].privateName = t + "Tracks_" }); var $r = { remoteText: { ListClass: ir, TrackClass: Fr, capitalName: "RemoteText", getterName: "remoteTextTracks", privateName: "remoteTextTracks_" }, remoteTextEl: { ListClass: rr, TrackClass: Xr, capitalName: "RemoteTextTrackEls", getterName: "remoteTextTrackEls", privateName: "remoteTextTrackEls_" } }, Kr = tt(Yr, $r); $r.names = Object.keys($r), Yr.names = Object.keys(Yr), Kr.names = [].concat($r.names).concat(Yr.names); var Jr = Object.create || function () { function t() { } return function (e) { if (1 !== arguments.length) throw new Error("Object.create shim only accepts one parameter."); return t.prototype = e, new t } }(); kt.prototype = Jr(Error.prototype), kt.prototype.constructor = kt, kt.Errors = { BadSignature: { code: 0, message: "Malformed WebVTT signature." }, BadTimeStamp: { code: 1, message: "Malformed time stamp." } }, Ct.prototype = { set: function (t, e) { this.get(t) || "" === e || (this.values[t] = e) }, get: function (t, e, i) { return i ? this.has(t) ? this.values[t] : e[i] : this.has(t) ? this.values[t] : e }, has: function (t) { return t in this.values }, alt: function (t, e, i) { for (var r = 0; r < i.length; ++r)if (e === i[r]) { this.set(t, e); break } }, integer: function (t, e) { /^-?\d+$/.test(e) && this.set(t, parseInt(e, 10)) }, percent: function (t, e) { var i; return (i = e.match(/^([\d]{1,3})(\.[\d]*)?%$/)) && (e = parseFloat(e), e >= 0 && 100 >= e) ? (this.set(t, e), !0) : !1 } }; var Qr = { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&lrm;": "\u200e", "&rlm;": "\u200f", "&nbsp;": "\xa0" }, Zr = { c: "span", i: "i", b: "b", u: "u", ruby: "ruby", rt: "rt", v: "span", lang: "span" }, tn = { v: "title", lang: "lang" }, en = { rt: "ruby" }, rn = [[1470, 1470], [1472, 1472], [1475, 1475], [1478, 1478], [1488, 1514], [1520, 1524], [1544, 1544], [1547, 1547], [1549, 1549], [1563, 1563], [1566, 1610], [1645, 1647], [1649, 1749], [1765, 1766], [1774, 1775], [1786, 1805], [1807, 1808], [1810, 1839], [1869, 1957], [1969, 1969], [1984, 2026], [2036, 2037], [2042, 2042], [2048, 2069], [2074, 2074], [2084, 2084], [2088, 2088], [2096, 2110], [2112, 2136], [2142, 2142], [2208, 2208], [2210, 2220], [8207, 8207], [64285, 64285], [64287, 64296], [64298, 64310], [64312, 64316], [64318, 64318], [64320, 64321], [64323, 64324], [64326, 64449], [64467, 64829], [64848, 64911], [64914, 64967], [65008, 65020], [65136, 65140], [65142, 65276], [67584, 67589], [67592, 67592], [67594, 67637], [67639, 67640], [67644, 67644], [67647, 67669], [67671, 67679], [67840, 67867], [67872, 67897], [67903, 67903], [67968, 68023], [68030, 68031], [68096, 68096], [68112, 68115], [68117, 68119], [68121, 68147], [68160, 68167], [68176, 68184], [68192, 68223], [68352, 68405], [68416, 68437], [68440, 68466], [68472, 68479], [68608, 68680], [126464, 126467], [126469, 126495], [126497, 126498], [126500, 126500], [126503, 126503], [126505, 126514], [126516, 126519], [126521, 126521], [126523, 126523], [126530, 126530], [126535, 126535], [126537, 126537], [126539, 126539], [126541, 126543], [126545, 126546], [126548, 126548], [126551, 126551], [126553, 126553], [126555, 126555], [126557, 126557], [126559, 126559], [126561, 126562], [126564, 126564], [126567, 126570], [126572, 126578], [126580, 126583], [126585, 126588], [126590, 126590], [126592, 126601], [126603, 126619], [126625, 126627], [126629, 126633], [126635, 126651], [1114109, 1114109]]; xt.prototype.applyStyles = function (t, e) { e = e || this.div; for (var i in t) t.hasOwnProperty(i) && (e.style[i] = t[i]) }, xt.prototype.formatStyle = function (t, e) { return 0 === t ? 0 : t + e }, Dt.prototype = Jr(xt.prototype), Dt.prototype.constructor = Dt, Rt.prototype.move = function (t, e) { switch (e = void 0 !== e ? e : this.lineHeight, t) { case "+x": this.left += e, this.right += e; break; case "-x": this.left -= e, this.right -= e; break; case "+y": this.top += e, this.bottom += e; break; case "-y": this.top -= e, this.bottom -= e } }, Rt.prototype.overlaps = function (t) { return this.left < t.right && this.right > t.left && this.top < t.bottom && this.bottom > t.top }, Rt.prototype.overlapsAny = function (t) { for (var e = 0; e < t.length; e++)if (this.overlaps(t[e])) return !0; return !1 }, Rt.prototype.within = function (t) { return this.top >= t.top && this.bottom <= t.bottom && this.left >= t.left && this.right <= t.right }, Rt.prototype.overlapsOppositeAxis = function (t, e) { switch (e) { case "+x": return this.left < t.left; case "-x": return this.right > t.right; case "+y": return this.top < t.top; case "-y": return this.bottom > t.bottom } }, Rt.prototype.intersectPercentage = function (t) { var e = Math.max(0, Math.min(this.right, t.right) - Math.max(this.left, t.left)), i = Math.max(0, Math.min(this.bottom, t.bottom) - Math.max(this.top, t.top)), r = e * i; return r / (this.height * this.width) }, Rt.prototype.toCSSCompatValues = function (t) { return { top: this.top - t.top, bottom: t.bottom - this.bottom, left: this.left - t.left, right: t.right - this.right, height: this.height, width: this.width } }, Rt.getSimpleBoxPosition = function (t) { var e = t.div ? t.div.offsetHeight : t.tagName ? t.offsetHeight : 0, i = t.div ? t.div.offsetWidth : t.tagName ? t.offsetWidth : 0, r = t.div ? t.div.offsetTop : t.tagName ? t.offsetTop : 0; t = t.div ? t.div.getBoundingClientRect() : t.tagName ? t.getBoundingClientRect() : t; var n = { left: t.left, right: t.right, top: t.top || r, height: t.height || e, bottom: t.bottom || r + (t.height || e), width: t.width || i }; return n }, Ut.StringDecoder = function () { return { decode: function (t) { if (!t) return ""; if ("string" != typeof t) throw new Error("Error - expected string data."); return decodeURIComponent(encodeURIComponent(t)) } } }, Ut.convertCueToDOMTree = function (t, e) { return t && e ? Lt(t, e) : null }; var nn = .05, an = "sans-serif", sn = "1.5%"; Ut.processCues = function (t, e, i) { function r(t) { for (var e = 0; e < t.length; e++)if (t[e].hasBeenReset || !t[e].displayState) return !0; return !1 } if (!t || !e || !i) return null; for (; i.firstChild;)i.removeChild(i.firstChild); var n = t.document.createElement("div"); if (n.style.position = "absolute", n.style.left = "0", n.style.right = "0", n.style.top = "0", n.style.bottom = "0", n.style.margin = sn, i.appendChild(n), r(e)) { var a = [], s = Rt.getSimpleBoxPosition(n), o = Math.round(s.height * nn * 100) / 100, u = { font: o + "px " + an }; !function () { for (var i, r, o = 0; o < e.length; o++)r = e[o], i = new Dt(t, r, u), n.appendChild(i.div), Mt(t, i, s, a), r.displayState = i.div, a.push(Rt.getSimpleBoxPosition(i)) }() } else for (var l = 0; l < e.length; l++)n.appendChild(e[l].displayState) }, Ut.Parser = function (t, e, i) { i || (i = e, e = {}), e || (e = {}), this.window = t, this.vttjs = e, this.state = "INITIAL", this.buffer = "", this.decoder = i || new TextDecoder("utf8"), this.regionList = [] }, Ut.Parser.prototype = { reportOrThrowError: function (t) { if (!(t instanceof kt)) throw t; this.onparsingerror && this.onparsingerror(t) }, parse: function (t) { function e() { for (var t = a.buffer, e = 0; e < t.length && "\r" !== t[e] && "\n" !== t[e];)++e; var i = t.substr(0, e); return "\r" === t[e] && ++e, "\n" === t[e] && ++e, a.buffer = t.substr(e), i } function i(t) { var e = new Ct; if (wt(t, function (t, i) { switch (t) { case "id": e.set(t, i); break; case "width": e.percent(t, i); break; case "lines": e.integer(t, i); break; case "regionanchor": case "viewportanchor": var r = i.split(","); if (2 !== r.length) break; var n = new Ct; if (n.percent("x", r[0]), n.percent("y", r[1]), !n.has("x") || !n.has("y")) break; e.set(t + "X", n.get("x")), e.set(t + "Y", n.get("y")); break; case "scroll": e.alt(t, i, ["up"]) } }, /=/, /\s/), e.has("id")) { var i = new (a.vttjs.VTTRegion || a.window.VTTRegion); i.width = e.get("width", 100), i.lines = e.get("lines", 3), i.regionAnchorX = e.get("regionanchorX", 0), i.regionAnchorY = e.get("regionanchorY", 100), i.viewportAnchorX = e.get("viewportanchorX", 0), i.viewportAnchorY = e.get("viewportanchorY", 100), i.scroll = e.get("scroll", ""), a.onregion && a.onregion(i), a.regionList.push({ id: e.get("id"), region: i }) } } function r(t) { var e = new Ct; wt(t, function (t, i) { switch (t) { case "MPEGT": e.integer(t + "S", i); break; case "LOCA": e.set(t + "L", Et(i)) } }, /[^\d]:/, /,/), a.ontimestampmap && a.ontimestampmap({ MPEGTS: e.get("MPEGTS"), LOCAL: e.get("LOCAL") }) } function n(t) { t.match(/X-TIMESTAMP-MAP/) ? wt(t, function (t, e) { switch (t) { case "X-TIMESTAMP-MAP": r(e) } }, /=/) : wt(t, function (t, e) { switch (t) { case "Region": i(e) } }, /:/) } var a = this; t && (a.buffer += a.decoder.decode(t, { stream: !0 })); try { var s; if ("INITIAL" === a.state) { if (!/\r\n|\n/.test(a.buffer)) return this; s = e(); var o = s.match(/^WEBVTT([ \t].*)?$/); if (!o || !o[0]) throw new kt(kt.Errors.BadSignature); a.state = "HEADER" } for (var u = !1; a.buffer;) { if (!/\r\n|\n/.test(a.buffer)) return this; switch (u ? u = !1 : s = e(), a.state) { case "HEADER": /:/.test(s) ? n(s) : s || (a.state = "ID"); continue; case "NOTE": s || (a.state = "ID"); continue; case "ID": if (/^NOTE($|[ \t])/.test(s)) { a.state = "NOTE"; break } if (!s) continue; if (a.cue = new (a.vttjs.VTTCue || a.window.VTTCue)(0, 0, ""), a.state = "CUE", -1 === s.indexOf("-->")) { a.cue.id = s; continue } case "CUE": try { At(s, a.cue, a.regionList) } catch (l) { a.reportOrThrowError(l), a.cue = null, a.state = "BADCUE"; continue } a.state = "CUETEXT"; continue; case "CUETEXT": var c = -1 !== s.indexOf("-->"); if (!s || c && (u = !0)) { a.oncue && a.oncue(a.cue), a.cue = null, a.state = "ID"; continue } a.cue.text && (a.cue.text += "\n"), a.cue.text += s; continue; case "BADCUE": s || (a.state = "ID"); continue } } } catch (l) { a.reportOrThrowError(l), "CUETEXT" === a.state && a.cue && a.oncue && a.oncue(a.cue), a.cue = null, a.state = "INITIAL" === a.state ? "BADWEBVTT" : "BADCUE" } return this }, flush: function () { var t = this; try { if (t.buffer += t.decoder.decode(), (t.cue || "HEADER" === t.state) && (t.buffer += "\n\n", t.parse()), "INITIAL" === t.state) throw new kt(kt.Errors.BadSignature) } catch (e) { t.reportOrThrowError(e) } return t.onflush && t.onflush(), this } }; var on = Ut, un = Object.freeze({ "default": on, __moduleExports: on }), ln = "auto", cn = { "": 1, lr: 1, rl: 1 }, hn = { start: 1, middle: 1, end: 1, left: 1, right: 1 }; jt.prototype.getCueAsHTML = function () { return WebVTT.convertCueToDOMTree(window, this.text) }; var dn = jt, pn = Object.freeze({ "default": dn, __moduleExports: dn }), fn = { "": !0, up: !0 }, mn = Vt, gn = Object.freeze({ "default": mn, __moduleExports: mn }), yn = un && on || un, vn = pn && dn || pn, _n = gn && mn || gn, bn = t(function (t) { var e = t.exports = { WebVTT: yn, VTTCue: vn, VTTRegion: _n }; Te.vttjs = e, Te.WebVTT = e.WebVTT; var i = e.VTTCue, r = e.VTTRegion, n = Te.VTTCue, a = Te.VTTRegion; e.shim = function () { Te.VTTCue = i, Te.VTTRegion = r }, e.restore = function () { Te.VTTCue = n, Te.VTTRegion = a }, Te.VTTCue || e.shim() }), Tn = (bn.WebVTT, bn.VTTCue, bn.VTTRegion, function (t) { function e() { var i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : function () { }; Re(this, e), i.reportTouchActivity = !1; var n = Ue(this, t.call(this, null, i, r)); return n.hasStarted_ = !1, n.on("playing", function () { this.hasStarted_ = !0 }), n.on("loadstart", function () { this.hasStarted_ = !1 }), Kr.names.forEach(function (t) { var e = Kr[t]; i && i[e.getterName] && (n[e.privateName] = i[e.getterName]) }), n.featuresProgressEvents || n.manualProgressOn(), n.featuresTimeupdateEvents || n.manualTimeUpdatesOn(), ["Text", "Audio", "Video"].forEach(function (t) { i["native" + t + "Tracks"] === !1 && (n["featuresNative" + t + "Tracks"] = !1) }), i.nativeCaptions === !1 || i.nativeTextTracks === !1 ? n.featuresNativeTextTracks = !1 : (i.nativeCaptions === !0 || i.nativeTextTracks === !0) && (n.featuresNativeTextTracks = !0), n.featuresNativeTextTracks || n.emulateTextTracks(), n.autoRemoteTextTracks_ = new Kr.text.ListClass, n.initTrackListeners(), i.nativeControlsForTouch || n.emitTapEvents(), n.constructor && (n.name_ = n.constructor.name || "Unknown Tech"), n } return Me(e, t), e.prototype.triggerSourceset = function (t) { var e = this; this.isReady_ || this.one("ready", function () { return e.setTimeout(function () { return e.triggerSourceset(t) }, 1) }), this.trigger({ src: t, type: "sourceset" }) }, e.prototype.manualProgressOn = function () { this.on("durationchange", this.onDurationChange), this.manualProgress = !0, this.one("ready", this.trackProgress) }, e.prototype.manualProgressOff = function () { this.manualProgress = !1, this.stopTrackingProgress(), this.off("durationchange", this.onDurationChange) }, e.prototype.trackProgress = function (t) { this.stopTrackingProgress(), this.progressInterval = this.setInterval(ei(this, function () { var t = this.bufferedPercent(); this.bufferedPercent_ !== t && this.trigger("progress"), this.bufferedPercent_ = t, 1 === t && this.stopTrackingProgress() }), 500) }, e.prototype.onDurationChange = function (t) { this.duration_ = this.duration() }, e.prototype.buffered = function () { return nt(0, 0) }, e.prototype.bufferedPercent = function () { return at(this.buffered(), this.duration_) }, e.prototype.stopTrackingProgress = function () { this.clearInterval(this.progressInterval) }, e.prototype.manualTimeUpdatesOn = function () { this.manualTimeUpdates = !0, this.on("play", this.trackCurrentTime), this.on("pause", this.stopTrackingCurrentTime) }, e.prototype.manualTimeUpdatesOff = function () { this.manualTimeUpdates = !1, this.stopTrackingCurrentTime(), this.off("play", this.trackCurrentTime), this.off("pause", this.stopTrackingCurrentTime) }, e.prototype.trackCurrentTime = function () { this.currentTimeInterval && this.stopTrackingCurrentTime(), this.currentTimeInterval = this.setInterval(function () { this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, 250) }, e.prototype.stopTrackingCurrentTime = function () { this.clearInterval(this.currentTimeInterval), this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, e.prototype.dispose = function () { this.clearTracks(Yr.names), this.manualProgress && this.manualProgressOff(), this.manualTimeUpdates && this.manualTimeUpdatesOff(), t.prototype.dispose.call(this) }, e.prototype.clearTracks = function (t) { var e = this; t = [].concat(t), t.forEach(function (t) { for (var i = e[t + "Tracks"]() || [], r = i.length; r--;) { var n = i[r]; "text" === t && e.removeRemoteTextTrack(n), i.removeTrack(n) } }) }, e.prototype.cleanupAutoTextTracks = function () { for (var t = this.autoRemoteTextTracks_ || [], e = t.length; e--;) { var i = t[e]; this.removeRemoteTextTrack(i) } }, e.prototype.reset = function () { }, e.prototype.error = function (t) { return void 0 !== t && (this.error_ = new st(t), this.trigger("error")), this.error_ }, e.prototype.played = function () { return this.hasStarted_ ? nt(0, 0) : nt() }, e.prototype.setCurrentTime = function () { this.manualTimeUpdates && this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, e.prototype.initTrackListeners = function () { var t = this; Yr.names.forEach(function (e) { var i = Yr[e], r = function () { t.trigger(e + "trackchange") }, n = t[i.getterName](); n.addEventListener("removetrack", r), n.addEventListener("addtrack", r), t.on("dispose", function () { n.removeEventListener("removetrack", r), n.removeEventListener("addtrack", r) }) }) }, e.prototype.addWebVttScript_ = function () { var t = this; if (!Te.WebVTT) if (we.body.contains(this.el())) { if (!this.options_["vtt.js"] && s(bn) && Object.keys(bn).length > 0) return void this.trigger("vttjsloaded"); var e = we.createElement("script"); e.src = this.options_["vtt.js"] || "https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js", e.onload = function () { t.trigger("vttjsloaded") }, e.onerror = function () { t.trigger("vttjserror") }, this.on("dispose", function () { e.onload = null, e.onerror = null }), Te.WebVTT = !0, this.el().parentNode.appendChild(e) } else this.ready(this.addWebVttScript_) }, e.prototype.emulateTextTracks = function () { var t = this, e = this.textTracks(), i = this.remoteTextTracks(), r = function (t) { return e.addTrack(t.track) }, n = function (t) { return e.removeTrack(t.track) }; i.on("addtrack", r), i.on("removetrack", n), this.addWebVttScript_(); var a = function () { return t.trigger("texttrackchange") }, s = function () { a(); for (var t = 0; t < e.length; t++) { var i = e[t]; i.removeEventListener("cuechange", a), "showing" === i.mode && i.addEventListener("cuechange", a) } }; s(), e.addEventListener("change", s), e.addEventListener("addtrack", s), e.addEventListener("removetrack", s), this.on("dispose", function () { i.off("addtrack", r), i.off("removetrack", n), e.removeEventListener("change", s), e.removeEventListener("addtrack", s), e.removeEventListener("removetrack", s); for (var t = 0; t < e.length; t++) { var o = e[t]; o.removeEventListener("cuechange", a) } }) }, e.prototype.addTextTrack = function (t, e, i) { if (!t) throw new Error("TextTrack kind is required but was not provided"); return qt(this, t, e, i) }, e.prototype.createRemoteTextTrack = function (t) { var e = tt(t, { tech: this }); return new $r.remoteTextEl.TrackClass(e) }, e.prototype.addRemoteTextTrack = function () { var t = this, e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = arguments[1], r = this.createRemoteTextTrack(e); return i !== !0 && i !== !1 && (Ie.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'), i = !0), this.remoteTextTrackEls().addTrackElement_(r), this.remoteTextTracks().addTrack(r.track), i !== !0 && this.ready(function () { return t.autoRemoteTextTracks_.addTrack(r.track) }), r }, e.prototype.removeRemoteTextTrack = function (t) { var e = this.remoteTextTrackEls().getTrackElementByTrack_(t); this.remoteTextTrackEls().removeTrackElement_(e), this.remoteTextTracks().removeTrack(t), this.autoRemoteTextTracks_.removeTrack(t) }, e.prototype.getVideoPlaybackQuality = function () { return {} }, e.prototype.setPoster = function () { }, e.prototype.playsinline = function () { }, e.prototype.setPlaysinline = function () { }, e.prototype.overrideNativeAudioTracks = function () { }, e.prototype.overrideNativeVideoTracks = function () { }, e.prototype.canPlayType = function () { return "" }, e.canPlayType = function () { return "" }, e.canPlaySource = function (t, i) { return e.canPlayType(t.type) }, e.isTech = function (t) { return t.prototype instanceof e || t instanceof e || t === e }, e.registerTech = function (t, i) { if (e.techs_ || (e.techs_ = {}), !e.isTech(i)) throw new Error("Tech " + t + " must be a Tech"); if (!e.canPlayType) throw new Error("Techs must have a static canPlayType method on them"); if (!e.canPlaySource) throw new Error("Techs must have a static canPlaySource method on them"); return t = Q(t), e.techs_[t] = i, "Tech" !== t && e.defaultTechOrder_.push(t), i }, e.getTech = function (t) { return t ? (t = Q(t), e.techs_ && e.techs_[t] ? e.techs_[t] : Te && Te.videojs && Te.videojs[t] ? (Ie.warn("The " + t + " tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"), Te.videojs[t]) : void 0) : void 0 }, e }(fi)); Kr.names.forEach(function (t) { var e = Kr[t]; Tn.prototype[e.getterName] = function () { return this[e.privateName] = this[e.privateName] || new e.ListClass, this[e.privateName] } }), Tn.prototype.featuresVolumeControl = !0, Tn.prototype.featuresMuteControl = !0, Tn.prototype.featuresFullscreenResize = !1, Tn.prototype.featuresPlaybackRate = !1, Tn.prototype.featuresProgressEvents = !1, Tn.prototype.featuresSourceset = !1, Tn.prototype.featuresTimeupdateEvents = !1, Tn.prototype.featuresNativeTextTracks = !1, Tn.withSourceHandlers = function (t) { t.registerSourceHandler = function (e, i) { var r = t.sourceHandlers; r || (r = t.sourceHandlers = []), void 0 === i && (i = r.length), r.splice(i, 0, e) }, t.canPlayType = function (e) { for (var i = t.sourceHandlers || [], r = void 0, n = 0; n < i.length; n++)if (r = i[n].canPlayType(e)) return r; return "" }, t.selectSourceHandler = function (e, i) { for (var r = t.sourceHandlers || [], n = void 0, a = 0; a < r.length; a++)if (n = r[a].canHandleSource(e, i)) return r[a]; return null }, t.canPlaySource = function (e, i) { var r = t.selectSourceHandler(e, i); return r ? r.canHandleSource(e, i) : "" }; var e = ["seekable", "seeking", "duration"]; e.forEach(function (t) { var e = this[t]; "function" == typeof e && (this[t] = function () { return this.sourceHandler_ && this.sourceHandler_[t] ? this.sourceHandler_[t].apply(this.sourceHandler_, arguments) : e.apply(this, arguments) }) }, t.prototype), t.prototype.setSource = function (e) { var i = t.selectSourceHandler(e, this.options_); i || (t.nativeSourceHandler ? i = t.nativeSourceHandler : Ie.error("No source handler found for the current source.")), this.disposeSourceHandler(), this.off("dispose", this.disposeSourceHandler), i !== t.nativeSourceHandler && (this.currentSource_ = e), this.sourceHandler_ = i.handleSource(e, this, this.options_), this.on("dispose", this.disposeSourceHandler) }, t.prototype.disposeSourceHandler = function () { this.currentSource_ && (this.clearTracks(["audio", "video"]), this.currentSource_ = null), this.cleanupAutoTextTracks(), this.sourceHandler_ && (this.sourceHandler_.dispose && this.sourceHandler_.dispose(), this.sourceHandler_ = null) } }, fi.registerComponent("Tech", Tn), Tn.registerTech("Tech", Tn), Tn.defaultTechOrder_ = []; var Sn = {}, kn = {}, En = {}, Cn = { buffered: 1, currentTime: 1, duration: 1, seekable: 1, played: 1, paused: 1 }, wn = { setCurrentTime: 1 }, An = { play: 1, pause: 1 }, Ln = { opus: "video/ogg", ogv: "video/ogg", mp4: "video/mp4", mov: "video/mp4", m4v: "video/mp4", mkv: "video/x-matroska", mp3: "audio/mpeg", aac: "audio/aac", oga: "audio/ogg", m3u8: "application/x-mpegURL" }, Pn = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", e = dr(t), i = Ln[e.toLowerCase()]; return i || "" }, On = function (t, e) { if (!e) return ""; if (t.cache_.source.src === e && t.cache_.source.type) return t.cache_.source.type; var i = t.cache_.sources.filter(function (t) { return t.src === e }); if (i.length) return i[0].type; for (var r = t.$$("source"), n = 0; n < r.length; n++) { var a = r[n]; if (a.type && a.src && a.src === e) return a.type } return Pn(e) }, In = function Xd(t) { if (Array.isArray(t)) { var e = []; t.forEach(function (t) { t = Xd(t), Array.isArray(t) ? e = e.concat(t) : a(t) && e.push(t) }), t = e } else t = "string" == typeof t && t.trim() ? [ee({ src: t })] : a(t) && "string" == typeof t.src && t.src && t.src.trim() ? [ee(t)] : []; return t }, xn = function (t) { function e(i, r, n) { Re(this, e); var a = tt({ createEl: !1 }, r), s = Ue(this, t.call(this, i, a, n)); if (r.playerOptions.sources && 0 !== r.playerOptions.sources.length) i.src(r.playerOptions.sources); else for (var o = 0, u = r.playerOptions.techOrder; o < u.length; o++) { var l = Q(u[o]), c = Tn.getTech(l); if (l || (c = fi.getComponent(l)), c && c.isSupported()) { i.loadTech_(l); break } } return s } return Me(e, t), e }(fi); fi.registerComponent("MediaLoader", xn); var Dn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.emitTapEvents(), n.enable(), n } return Me(e, t), e.prototype.createEl = function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "div", i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; i = n({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"></span>', className: this.buildCSSClass(), tabIndex: 0 }, i), "button" === e && Ie.error("Creating a ClickableComponent with an HTML element of " + e + " is not supported; use a Button instead."), r = n({ role: "button" }, r), this.tabIndex_ = i.tabIndex; var a = t.prototype.createEl.call(this, e, i, r); return this.createControlTextEl(a), a }, e.prototype.dispose = function () { this.controlTextEl_ = null, t.prototype.dispose.call(this) }, e.prototype.createControlTextEl = function (t) { return this.controlTextEl_ = m("span", { className: "vjs-control-text" }, { "aria-live": "polite" }), t && t.appendChild(this.controlTextEl_), this.controlText(this.controlText_, t), this.controlTextEl_ }, e.prototype.controlText = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this.el(); if (void 0 === t) return this.controlText_ || "Need Text"; var i = this.localize(t); this.controlText_ = t, g(this.controlTextEl_, i), this.nonIconControl || e.setAttribute("title", i) }, e.prototype.buildCSSClass = function () { return "vjs-control vjs-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.enable = function () { this.enabled_ || (this.enabled_ = !0, this.removeClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "false"), "undefined" != typeof this.tabIndex_ && this.el_.setAttribute("tabIndex", this.tabIndex_), this.on(["tap", "click"], this.handleClick), this.on("focus", this.handleFocus), this.on("blur", this.handleBlur)) }, e.prototype.disable = function () { this.enabled_ = !1, this.addClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "true"), "undefined" != typeof this.tabIndex_ && this.el_.removeAttribute("tabIndex"), this.off(["tap", "click"], this.handleClick), this.off("focus", this.handleFocus), this.off("blur", this.handleBlur) }, e.prototype.handleClick = function (t) { }, e.prototype.handleFocus = function (t) { z(we, "keydown", ei(this, this.handleKeyPress)) }, e.prototype.handleKeyPress = function (e) { 32 === e.which || 13 === e.which ? (e.preventDefault(), this.trigger("click")) : t.prototype.handleKeyPress && t.prototype.handleKeyPress.call(this, e) }, e.prototype.handleBlur = function (t) { G(we, "keydown", ei(this, this.handleKeyPress)) }, e }(fi); fi.registerComponent("ClickableComponent", Dn); var Rn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.update(), i.on("posterchange", ei(n, n.update)), n } return Me(e, t), e.prototype.dispose = function () { this.player().off("posterchange", this.update), t.prototype.dispose.call(this) }, e.prototype.createEl = function () { var t = m("div", { className: "vjs-poster", tabIndex: -1 }); return t }, e.prototype.update = function (t) { var e = this.player().poster(); this.setSrc(e), e ? this.show() : this.hide() }, e.prototype.setSrc = function (t) { var e = ""; t && (e = 'url("' + t + '")'), this.el_.style.backgroundImage = e }, e.prototype.handleClick = function (t) { this.player_.controls() && (this.player_.paused() ? lt(this.player_.play()) : this.player_.pause()) }, e }(Dn); fi.registerComponent("PosterImage", Rn); var Mn = "#222", Un = "#ccc", Nn = { monospace: "monospace", sansSerif: "sans-serif", serif: "serif", monospaceSansSerif: '"Andale Mono", "Lucida Console", monospace', monospaceSerif: '"Courier New", monospace', proportionalSansSerif: "sans-serif", proportionalSerif: "serif", casual: '"Comic Sans MS", Impact, fantasy', script: '"Monotype Corsiva", cursive', smallcaps: '"Andale Mono", "Lucida Console", monospace, sans-serif' }, Bn = function (t) { function e(i, r, n) { Re(this, e); var a = Ue(this, t.call(this, i, r, n)); return i.on("loadstart", ei(a, a.toggleDisplay)), i.on("texttrackchange", ei(a, a.updateDisplay)), i.on("loadstart", ei(a, a.preselectTrack)), i.ready(ei(a, function () { if (i.tech_ && i.tech_.featuresNativeTextTracks) return void this.hide(); i.on("fullscreenchange", ei(this, this.updateDisplay)); for (var t = this.options_.playerOptions.tracks || [], e = 0; e < t.length; e++)this.player_.addRemoteTextTrack(t[e], !0); this.preselectTrack() })), a } return Me(e, t), e.prototype.preselectTrack = function () { for (var t = { captions: 1, subtitles: 1 }, e = this.player_.textTracks(), i = this.player_.cache_.selectedLanguage, r = void 0, n = void 0, a = void 0, s = 0; s < e.length; s++) { var o = e[s]; i && i.enabled && i.language === o.language ? o.kind === i.kind ? a = o : a || (a = o) : i && !i.enabled ? (a = null, r = null, n = null) : o["default"] && ("descriptions" !== o.kind || r ? o.kind in t && !n && (n = o) : r = o) } a ? a.mode = "showing" : n ? n.mode = "showing" : r && (r.mode = "showing") }, e.prototype.toggleDisplay = function () { this.player_.tech_ && this.player_.tech_.featuresNativeTextTracks ? this.hide() : this.show() }, e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-text-track-display" }, { "aria-live": "off", "aria-atomic": "true" }) }, e.prototype.clearDisplay = function () { "function" == typeof Te.WebVTT && Te.WebVTT.processCues(Te, [], this.el_) }, e.prototype.updateDisplay = function () { var t = this.player_.textTracks(); this.clearDisplay(); for (var e = null, i = null, r = t.length; r--;) { var n = t[r]; "showing" === n.mode && ("descriptions" === n.kind ? e = n : i = n) } i ? ("off" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "off"), this.updateForTrack(i)) : e && ("assertive" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "assertive"), this.updateForTrack(e)) }, e.prototype.updateForTrack = function (t) { if ("function" == typeof Te.WebVTT && t.activeCues) { for (var e = [], i = 0; i < t.activeCues.length; i++)e.push(t.activeCues[i]); if (Te.WebVTT.processCues(Te, e, this.el_), this.player_.textTrackSettings) for (var r = this.player_.textTrackSettings.getValues(), n = e.length; n--;) { var a = e[n]; if (a) { var s = a.displayState; if (r.color && (s.firstChild.style.color = r.color), r.textOpacity && re(s.firstChild, "color", ie(r.color || "#fff", r.textOpacity)), r.backgroundColor && (s.firstChild.style.backgroundColor = r.backgroundColor), r.backgroundOpacity && re(s.firstChild, "backgroundColor", ie(r.backgroundColor || "#000", r.backgroundOpacity)), r.windowColor && (r.windowOpacity ? re(s, "backgroundColor", ie(r.windowColor, r.windowOpacity)) : s.style.backgroundColor = r.windowColor), r.edgeStyle && ("dropshadow" === r.edgeStyle ? s.firstChild.style.textShadow = "2px 2px 3px " + Mn + ", 2px 2px 4px " + Mn + ", 2px 2px 5px " + Mn : "raised" === r.edgeStyle ? s.firstChild.style.textShadow = "1px 1px " + Mn + ", 2px 2px " + Mn + ", 3px 3px " + Mn : "depressed" === r.edgeStyle ? s.firstChild.style.textShadow = "1px 1px " + Un + ", 0 1px " + Un + ", -1px -1px " + Mn + ", 0 -1px " + Mn : "uniform" === r.edgeStyle && (s.firstChild.style.textShadow = "0 0 4px " + Mn + ", 0 0 4px " + Mn + ", 0 0 4px " + Mn + ", 0 0 4px " + Mn)), r.fontPercent && 1 !== r.fontPercent) { var o = Te.parseFloat(s.style.fontSize); s.style.fontSize = o * r.fontPercent + "px", s.style.height = "auto", s.style.top = "auto", s.style.bottom = "2px" } r.fontFamily && "default" !== r.fontFamily && ("small-caps" === r.fontFamily ? s.firstChild.style.fontVariant = "small-caps" : s.firstChild.style.fontFamily = Nn[r.fontFamily]) } } } }, e }(fi); fi.registerComponent("TextTrackDisplay", Bn); var jn = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { var e = this.player_.isAudio(), i = this.localize(e ? "Audio Player" : "Video Player"), r = m("span", { className: "vjs-control-text", innerHTML: this.localize("{1} is loading.", [i]) }), n = t.prototype.createEl.call(this, "div", { className: "vjs-loading-spinner", dir: "ltr" }); return n.appendChild(r), n }, e }(fi); fi.registerComponent("LoadingSpinner", jn); var Fn = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; t = "button", e = n({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"></span>', className: this.buildCSSClass() }, e), i = n({ type: "button" }, i); var r = fi.prototype.createEl.call(this, t, e, i); return this.createControlTextEl(r), r }, e.prototype.addChild = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = this.constructor.name; return Ie.warn("Adding an actionable (user controllable) child to a Button (" + i + ") is not supported; use a ClickableComponent instead."), fi.prototype.addChild.call(this, t, e) }, e.prototype.enable = function () { t.prototype.enable.call(this), this.el_.removeAttribute("disabled") }, e.prototype.disable = function () { t.prototype.disable.call(this), this.el_.setAttribute("disabled", "disabled") }, e.prototype.handleKeyPress = function (e) { 32 !== e.which && 13 !== e.which && t.prototype.handleKeyPress.call(this, e) }, e }(Dn); fi.registerComponent("Button", Fn); var Hn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.mouseused_ = !1, n.on("mousedown", n.handleMouseDown), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-big-play-button" }, e.prototype.handleClick = function (t) { var e = this.player_.play(); if (this.mouseused_ && t.clientX && t.clientY) return void lt(e); var i = this.player_.getChild("controlBar"), r = i && i.getChild("playToggle"); if (!r) return void this.player_.focus(); var n = function () { return r.focus() }; ut(e) ? e.then(n, function () { }) : this.setTimeout(n, 1) }, e.prototype.handleKeyPress = function (e) { this.mouseused_ = !1, t.prototype.handleKeyPress.call(this, e) }, e.prototype.handleMouseDown = function (t) { this.mouseused_ = !0 }, e }(Fn); Hn.prototype.controlText_ = "Play Video", fi.registerComponent("BigPlayButton", Hn); var Vn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.controlText(r && r.controlText || n.localize("Close")), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-close-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.handleClick = function (t) { this.trigger({ type: "close", bubbles: !1 }) }, e }(Fn); fi.registerComponent("CloseButton", Vn); var qn = function (t) {
    function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "play", n.handlePlay), n.on(i, "pause", n.handlePause), n.on(i, "ended", n.handleEnded), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-play-control " + t.prototype.buildCSSClass.call(this) }, e.prototype.handleClick = function (t) {
      this.player_.paused() ? this.player_.play() : this.player_.pause()
    }, e.prototype.handleSeeked = function (t) { this.removeClass("vjs-ended"), this.player_.paused() ? this.handlePause(t) : this.handlePlay(t) }, e.prototype.handlePlay = function (t) { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.controlText("Pause") }, e.prototype.handlePause = function (t) { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.controlText("Play") }, e.prototype.handleEnded = function (t) { this.removeClass("vjs-playing"), this.addClass("vjs-ended"), this.controlText("Replay"), this.one(this.player_, "seeked", this.handleSeeked) }, e
  }(Fn); qn.prototype.controlText_ = "Play", fi.registerComponent("PlayToggle", qn); var Wn = function (t, e) { t = 0 > t ? 0 : t; var i = Math.floor(t % 60), r = Math.floor(t / 60 % 60), n = Math.floor(t / 3600), a = Math.floor(e / 60 % 60), s = Math.floor(e / 3600); return (isNaN(t) || t === 1 / 0) && (n = r = i = "-"), n = n > 0 || s > 0 ? n + ":" : "", r = ((n || a >= 10) && 10 > r ? "0" + r : r) + ":", i = 10 > i ? "0" + i : i, n + r + i }, zn = Wn, Gn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.throttledUpdateContent = ii(ei(n, n.updateContent), 25), n.on(i, "timeupdate", n.throttledUpdateContent), n } return Me(e, t), e.prototype.createEl = function (e) { var i = this.buildCSSClass(), r = t.prototype.createEl.call(this, "div", { className: i + " vjs-time-control vjs-control", innerHTML: '<span class="vjs-control-text">' + this.localize(this.labelText_) + "\xa0</span>" }); return this.contentEl_ = m("span", { className: i + "-display" }, { "aria-live": "off" }), this.updateTextNode_(), r.appendChild(this.contentEl_), r }, e.prototype.dispose = function () { this.contentEl_ = null, this.textNode_ = null, t.prototype.dispose.call(this) }, e.prototype.updateTextNode_ = function () { if (this.contentEl_) { for (; this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild); this.textNode_ = we.createTextNode(this.formattedTime_ || this.formatTime_(0)), this.contentEl_.appendChild(this.textNode_) } }, e.prototype.formatTime_ = function (t) { return se(t) }, e.prototype.updateFormattedTime_ = function (t) { var e = this.formatTime_(t); e !== this.formattedTime_ && (this.formattedTime_ = e, this.requestAnimationFrame(this.updateTextNode_)) }, e.prototype.updateContent = function (t) { }, e }(fi); Gn.prototype.labelText_ = "Time", Gn.prototype.controlText_ = "Time", fi.registerComponent("TimeDisplay", Gn); var Xn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "ended", n.handleEnded), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-current-time" }, e.prototype.updateContent = function (t) { var e = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(); this.updateFormattedTime_(e) }, e.prototype.handleEnded = function (t) { this.player_.duration() && this.updateFormattedTime_(this.player_.duration()) }, e }(Gn); Xn.prototype.labelText_ = "Current Time", Xn.prototype.controlText_ = "Current Time", fi.registerComponent("CurrentTimeDisplay", Xn); var Yn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "durationchange", n.updateContent), n.on(i, "loadedmetadata", n.throttledUpdateContent), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-duration" }, e.prototype.updateContent = function (t) { var e = this.player_.duration(); e && this.duration_ !== e && (this.duration_ = e, this.updateFormattedTime_(e)) }, e }(Gn); Yn.prototype.labelText_ = "Duration", Yn.prototype.controlText_ = "Duration", fi.registerComponent("DurationDisplay", Yn); var $n = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-time-control vjs-time-divider", innerHTML: "<div><span>/</span></div>" }) }, e }(fi); fi.registerComponent("TimeDivider", $n); var Kn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "durationchange", n.throttledUpdateContent), n.on(i, "ended", n.handleEnded), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-remaining-time" }, e.prototype.formatTime_ = function (e) { return "-" + t.prototype.formatTime_.call(this, e) }, e.prototype.updateContent = function (t) { this.player_.duration() && (this.player_.remainingTimeDisplay ? this.updateFormattedTime_(this.player_.remainingTimeDisplay()) : this.updateFormattedTime_(this.player_.remainingTime())) }, e.prototype.handleEnded = function (t) { this.player_.duration() && this.updateFormattedTime_(0) }, e }(Gn); Kn.prototype.labelText_ = "Remaining Time", Kn.prototype.controlText_ = "Remaining Time", fi.registerComponent("RemainingTimeDisplay", Kn); var Jn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.updateShowing(), n.on(n.player(), "durationchange", n.updateShowing), n } return Me(e, t), e.prototype.createEl = function () { var e = t.prototype.createEl.call(this, "div", { className: "vjs-live-control vjs-control" }); return this.contentEl_ = m("div", { className: "vjs-live-display", innerHTML: '<span class="vjs-control-text">' + this.localize("Stream Type") + "\xa0</span>" + this.localize("LIVE") }, { "aria-live": "off" }), e.appendChild(this.contentEl_), e }, e.prototype.dispose = function () { this.contentEl_ = null, t.prototype.dispose.call(this) }, e.prototype.updateShowing = function (t) { this.player().duration() === 1 / 0 ? this.show() : this.hide() }, e }(fi); fi.registerComponent("LiveDisplay", Jn); var Qn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.bar = n.getChild(n.options_.barName), n.vertical(!!n.options_.vertical), n.enable(), n } return Me(e, t), e.prototype.enabled = function () { return this.enabled_ }, e.prototype.enable = function () { this.enabled() || (this.on("mousedown", this.handleMouseDown), this.on("touchstart", this.handleMouseDown), this.on("focus", this.handleFocus), this.on("blur", this.handleBlur), this.on("click", this.handleClick), this.on(this.player_, "controlsvisible", this.update), this.playerEvent && this.on(this.player_, this.playerEvent, this.update), this.removeClass("disabled"), this.setAttribute("tabindex", 0), this.enabled_ = !0) }, e.prototype.disable = function () { if (this.enabled()) { var t = this.bar.el_.ownerDocument; this.off("mousedown", this.handleMouseDown), this.off("touchstart", this.handleMouseDown), this.off("focus", this.handleFocus), this.off("blur", this.handleBlur), this.off("click", this.handleClick), this.off(this.player_, "controlsvisible", this.update), this.off(t, "mousemove", this.handleMouseMove), this.off(t, "mouseup", this.handleMouseUp), this.off(t, "touchmove", this.handleMouseMove), this.off(t, "touchend", this.handleMouseUp), this.removeAttribute("tabindex"), this.addClass("disabled"), this.playerEvent && this.off(this.player_, this.playerEvent, this.update), this.enabled_ = !1 } }, e.prototype.createEl = function (e) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; return i.className = i.className + " vjs-slider", i = n({ tabIndex: 0 }, i), r = n({ role: "slider", "aria-valuenow": 0, "aria-valuemin": 0, "aria-valuemax": 100, tabIndex: 0 }, r), t.prototype.createEl.call(this, e, i, r) }, e.prototype.handleMouseDown = function (t) { var e = this.bar.el_.ownerDocument; "mousedown" === t.type && t.preventDefault(), "touchstart" !== t.type || Li || t.preventDefault(), A(), this.addClass("vjs-sliding"), this.trigger("slideractive"), this.on(e, "mousemove", this.handleMouseMove), this.on(e, "mouseup", this.handleMouseUp), this.on(e, "touchmove", this.handleMouseMove), this.on(e, "touchend", this.handleMouseUp), this.handleMouseMove(t) }, e.prototype.handleMouseMove = function (t) { }, e.prototype.handleMouseUp = function () { var t = this.bar.el_.ownerDocument; L(), this.removeClass("vjs-sliding"), this.trigger("sliderinactive"), this.off(t, "mousemove", this.handleMouseMove), this.off(t, "mouseup", this.handleMouseUp), this.off(t, "touchmove", this.handleMouseMove), this.off(t, "touchend", this.handleMouseUp), this.update() }, e.prototype.update = function () { if (this.el_) { var t = this.getPercent(), e = this.bar; if (e) { ("number" != typeof t || t !== t || 0 > t || t === 1 / 0) && (t = 0); var i = (100 * t).toFixed(2) + "%", r = e.el().style; return this.vertical() ? r.height = i : r.width = i, t } } }, e.prototype.calculateDistance = function (t) { var e = I(this.el_, t); return this.vertical() ? e.y : e.x }, e.prototype.handleFocus = function () { this.on(this.bar.el_.ownerDocument, "keydown", this.handleKeyPress) }, e.prototype.handleKeyPress = function (t) { 37 === t.which || 40 === t.which ? (t.preventDefault(), this.stepBack()) : (38 === t.which || 39 === t.which) && (t.preventDefault(), this.stepForward()) }, e.prototype.handleBlur = function () { this.off(this.bar.el_.ownerDocument, "keydown", this.handleKeyPress) }, e.prototype.handleClick = function (t) { t.stopImmediatePropagation(), t.preventDefault() }, e.prototype.vertical = function (t) { return void 0 === t ? this.vertical_ || !1 : (this.vertical_ = !!t, void (this.vertical_ ? this.addClass("vjs-slider-vertical") : this.addClass("vjs-slider-horizontal"))) }, e }(fi); fi.registerComponent("Slider", Qn); var Zn = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.partEls_ = [], n.on(i, "progress", n.update), n } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-load-progress", innerHTML: '<span class="vjs-control-text"><span>' + this.localize("Loaded") + "</span>: 0%</span>" }) }, e.prototype.dispose = function () { this.partEls_ = null, t.prototype.dispose.call(this) }, e.prototype.update = function (t) { var e = this.player_.buffered(), i = this.player_.duration(), r = this.player_.bufferedEnd(), n = this.partEls_, a = function (t, e) { var i = t / e || 0; return 100 * (i >= 1 ? 1 : i) + "%" }; this.el_.style.width = a(r, i); for (var s = 0; s < e.length; s++) { var o = e.start(s), u = e.end(s), l = n[s]; l || (l = this.el_.appendChild(m()), n[s] = l), l.style.left = a(o, r), l.style.width = a(u - o, r) } for (var c = n.length; c > e.length; c--)this.el_.removeChild(n[c - 1]); n.length = e.length }, e }(fi); fi.registerComponent("LoadProgressBar", Zn); var ta = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-time-tooltip" }) }, e.prototype.update = function (t, e, i) { var r = P(this.el_), n = P(this.player_.el()), a = t.width * e; if (n && r) { var s = t.left - n.left + a, o = t.width - a + (n.right - t.right), u = r.width / 2; u > s ? u += u - s : u > o && (u = o), 0 > u ? u = 0 : u > r.width && (u = r.width), this.el_.style.right = "-" + u + "px", g(this.el_, i) } }, e }(fi); fi.registerComponent("TimeTooltip", ta); var ea = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-play-progress vjs-slider-bar", innerHTML: '<span class="vjs-control-text"><span>' + this.localize("Progress") + "</span>: 0%</span>" }) }, e.prototype.update = function (t, e) { var i = this; this.rafId_ && this.cancelAnimationFrame(this.rafId_), this.rafId_ = this.requestAnimationFrame(function () { var r = i.player_.scrubbing() ? i.player_.getCache().currentTime : i.player_.currentTime(), n = se(r, i.player_.duration()), a = i.getChild("timeTooltip"); a && a.update(t, e, n) }) }, e }(fi); ea.prototype.options_ = { children: [] }, Ti || ki || ea.prototype.options_.children.push("timeTooltip"), fi.registerComponent("PlayProgressBar", ea); var ia = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.update = ii(ei(n, n.update), 25), n } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-mouse-display" }) }, e.prototype.update = function (t, e) { var i = this; this.rafId_ && this.cancelAnimationFrame(this.rafId_), this.rafId_ = this.requestAnimationFrame(function () { var r = i.player_.duration(), n = se(e * r, r); i.el_.style.left = t.width * e + "px", i.getChild("timeTooltip").update(t, e, n) }) }, e }(fi); ia.prototype.options_ = { children: ["timeTooltip"] }, fi.registerComponent("MouseTimeDisplay", ia); var ra = 5, na = 30, aa = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.setEventHandlers_(), n } return Me(e, t), e.prototype.setEventHandlers_ = function () { var t = this; this.update = ii(ei(this, this.update), na), this.on(this.player_, "timeupdate", this.update), this.on(this.player_, "ended", this.handleEnded), this.updateInterval = null, this.on(this.player_, ["playing"], function () { t.clearInterval(t.updateInterval), t.updateInterval = t.setInterval(function () { t.requestAnimationFrame(function () { t.update() }) }, na) }), this.on(this.player_, ["ended", "pause", "waiting"], function () { t.clearInterval(t.updateInterval) }), this.on(this.player_, ["timeupdate", "ended"], this.update) }, e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-progress-holder" }, { "aria-label": this.localize("Progress Bar") }) }, e.prototype.update_ = function (t, e) { var i = this.player_.duration(); this.el_.setAttribute("aria-valuenow", (100 * e).toFixed(2)), this.el_.setAttribute("aria-valuetext", this.localize("progress bar timing: currentTime={1} duration={2}", [se(t, i), se(i, i)], "{1} of {2}")), this.bar.update(P(this.el_), e) }, e.prototype.update = function (e) { var i = t.prototype.update.call(this); return this.update_(this.getCurrentTime_(), i), i }, e.prototype.getCurrentTime_ = function () { return this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime() }, e.prototype.handleEnded = function (t) { this.update_(this.player_.duration(), 1) }, e.prototype.getPercent = function () { var t = this.getCurrentTime_() / this.player_.duration(); return t >= 1 ? 1 : t || 0 }, e.prototype.handleMouseDown = function (e) { N(e) && (e.stopPropagation(), this.player_.scrubbing(!0), this.videoWasPlaying = !this.player_.paused(), this.player_.pause(), t.prototype.handleMouseDown.call(this, e)) }, e.prototype.handleMouseMove = function (t) { if (N(t)) { var e = this.calculateDistance(t) * this.player_.duration(); e === this.player_.duration() && (e -= .1), this.player_.currentTime(e) } }, e.prototype.enable = function () { t.prototype.enable.call(this); var e = this.getChild("mouseTimeDisplay"); e && e.show() }, e.prototype.disable = function () { t.prototype.disable.call(this); var e = this.getChild("mouseTimeDisplay"); e && e.hide() }, e.prototype.handleMouseUp = function (e) { t.prototype.handleMouseUp.call(this, e), e && e.stopPropagation(), this.player_.scrubbing(!1), this.player_.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }), this.videoWasPlaying && lt(this.player_.play()) }, e.prototype.stepForward = function () { this.player_.currentTime(this.player_.currentTime() + ra) }, e.prototype.stepBack = function () { this.player_.currentTime(this.player_.currentTime() - ra) }, e.prototype.handleAction = function (t) { this.player_.paused() ? this.player_.play() : this.player_.pause() }, e.prototype.handleKeyPress = function (e) { 32 === e.which || 13 === e.which ? (e.preventDefault(), this.handleAction(e)) : t.prototype.handleKeyPress && t.prototype.handleKeyPress.call(this, e) }, e }(Qn); aa.prototype.options_ = { children: ["loadProgressBar", "playProgressBar"], barName: "playProgressBar" }, Ti || ki || aa.prototype.options_.children.splice(1, 0, "mouseTimeDisplay"), aa.prototype.playerEvent = "timeupdate", fi.registerComponent("SeekBar", aa); var sa = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.handleMouseMove = ii(ei(n, n.handleMouseMove), 25), n.throttledHandleMouseSeek = ii(ei(n, n.handleMouseSeek), 25), n.enable(), n } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-progress-control vjs-control" }) }, e.prototype.handleMouseMove = function (t) { var e = this.getChild("seekBar"); if (e) { var i = e.getChild("mouseTimeDisplay"), r = e.el(), n = P(r), a = I(r, t).x; a > 1 ? a = 1 : 0 > a && (a = 0), i && i.update(n, a) } }, e.prototype.handleMouseSeek = function (t) { var e = this.getChild("seekBar"); e && e.handleMouseMove(t) }, e.prototype.enabled = function () { return this.enabled_ }, e.prototype.disable = function () { this.children().forEach(function (t) { return t.disable && t.disable() }), this.enabled() && (this.off(["mousedown", "touchstart"], this.handleMouseDown), this.off(this.el_, "mousemove", this.handleMouseMove), this.handleMouseUp(), this.addClass("disabled"), this.enabled_ = !1) }, e.prototype.enable = function () { this.children().forEach(function (t) { return t.enable && t.enable() }), this.enabled() || (this.on(["mousedown", "touchstart"], this.handleMouseDown), this.on(this.el_, "mousemove", this.handleMouseMove), this.removeClass("disabled"), this.enabled_ = !0) }, e.prototype.handleMouseDown = function (t) { var e = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseDown(t), this.on(e, "mousemove", this.throttledHandleMouseSeek), this.on(e, "touchmove", this.throttledHandleMouseSeek), this.on(e, "mouseup", this.handleMouseUp), this.on(e, "touchend", this.handleMouseUp) }, e.prototype.handleMouseUp = function (t) { var e = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseUp(t), this.off(e, "mousemove", this.throttledHandleMouseSeek), this.off(e, "touchmove", this.throttledHandleMouseSeek), this.off(e, "mouseup", this.handleMouseUp), this.off(e, "touchend", this.handleMouseUp) }, e }(fi); sa.prototype.options_ = { children: ["seekBar"] }, fi.registerComponent("ProgressControl", sa); var oa = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "fullscreenchange", n.handleFullscreenChange), we[Mi.fullscreenEnabled] === !1 && n.disable(), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-fullscreen-control " + t.prototype.buildCSSClass.call(this) }, e.prototype.handleFullscreenChange = function (t) { this.player_.isFullscreen() ? this.controlText("Non-Fullscreen") : this.controlText("Fullscreen") }, e.prototype.handleClick = function (t) { this.player_.isFullscreen() ? this.player_.exitFullscreen() : this.player_.requestFullscreen() }, e }(Fn); oa.prototype.controlText_ = "Fullscreen", fi.registerComponent("FullscreenToggle", oa); var ua = function (t, e) { e.tech_ && !e.tech_.featuresVolumeControl && t.addClass("vjs-hidden"), t.on(e, "loadstart", function () { e.tech_.featuresVolumeControl ? t.removeClass("vjs-hidden") : t.addClass("vjs-hidden") }) }, la = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-volume-level", innerHTML: '<span class="vjs-control-text"></span>' }) }, e }(fi); fi.registerComponent("VolumeLevel", la); var ca = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on("slideractive", n.updateLastVolume_), n.on(i, "volumechange", n.updateARIAAttributes), i.ready(function () { return n.updateARIAAttributes() }), n } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-volume-bar vjs-slider-bar" }, { "aria-label": this.localize("Volume Level"), "aria-live": "polite" }) }, e.prototype.handleMouseDown = function (e) { N(e) && t.prototype.handleMouseDown.call(this, e) }, e.prototype.handleMouseMove = function (t) { N(t) && (this.checkMuted(), this.player_.volume(this.calculateDistance(t))) }, e.prototype.checkMuted = function () { this.player_.muted() && this.player_.muted(!1) }, e.prototype.getPercent = function () { return this.player_.muted() ? 0 : this.player_.volume() }, e.prototype.stepForward = function () { this.checkMuted(), this.player_.volume(this.player_.volume() + .1) }, e.prototype.stepBack = function () { this.checkMuted(), this.player_.volume(this.player_.volume() - .1) }, e.prototype.updateARIAAttributes = function (t) { var e = this.player_.muted() ? 0 : this.volumeAsPercentage_(); this.el_.setAttribute("aria-valuenow", e), this.el_.setAttribute("aria-valuetext", e + "%") }, e.prototype.volumeAsPercentage_ = function () { return Math.round(100 * this.player_.volume()) }, e.prototype.updateLastVolume_ = function () { var t = this, e = this.player_.volume(); this.one("sliderinactive", function () { 0 === t.player_.volume() && t.player_.lastVolume_(e) }) }, e }(Qn); ca.prototype.options_ = { children: ["volumeLevel"], barName: "volumeLevel" }, ca.prototype.playerEvent = "volumechange", fi.registerComponent("VolumeBar", ca); var ha = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; Re(this, e), r.vertical = r.vertical || !1, ("undefined" == typeof r.volumeBar || s(r.volumeBar)) && (r.volumeBar = r.volumeBar || {}, r.volumeBar.vertical = r.vertical); var n = Ue(this, t.call(this, i, r)); return ua(n, i), n.throttledHandleMouseMove = ii(ei(n, n.handleMouseMove), 25), n.on("mousedown", n.handleMouseDown), n.on("touchstart", n.handleMouseDown), n.on(n.volumeBar, ["focus", "slideractive"], function () { n.volumeBar.addClass("vjs-slider-active"), n.addClass("vjs-slider-active"), n.trigger("slideractive") }), n.on(n.volumeBar, ["blur", "sliderinactive"], function () { n.volumeBar.removeClass("vjs-slider-active"), n.removeClass("vjs-slider-active"), n.trigger("sliderinactive") }), n } return Me(e, t), e.prototype.createEl = function () { var e = "vjs-volume-horizontal"; return this.options_.vertical && (e = "vjs-volume-vertical"), t.prototype.createEl.call(this, "div", { className: "vjs-volume-control vjs-control " + e }) }, e.prototype.handleMouseDown = function (t) { var e = this.el_.ownerDocument; this.on(e, "mousemove", this.throttledHandleMouseMove), this.on(e, "touchmove", this.throttledHandleMouseMove), this.on(e, "mouseup", this.handleMouseUp), this.on(e, "touchend", this.handleMouseUp) }, e.prototype.handleMouseUp = function (t) { var e = this.el_.ownerDocument; this.off(e, "mousemove", this.throttledHandleMouseMove), this.off(e, "touchmove", this.throttledHandleMouseMove), this.off(e, "mouseup", this.handleMouseUp), this.off(e, "touchend", this.handleMouseUp) }, e.prototype.handleMouseMove = function (t) { this.volumeBar.handleMouseMove(t) }, e }(fi); ha.prototype.options_ = { children: ["volumeBar"] }, fi.registerComponent("VolumeControl", ha); var da = function (t, e) { e.tech_ && !e.tech_.featuresMuteControl && t.addClass("vjs-hidden"), t.on(e, "loadstart", function () { e.tech_.featuresMuteControl ? t.removeClass("vjs-hidden") : t.addClass("vjs-hidden") }) }, pa = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return da(n, i), n.on(i, ["loadstart", "volumechange"], n.update), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-mute-control " + t.prototype.buildCSSClass.call(this) }, e.prototype.handleClick = function (t) { var e = this.player_.volume(), i = this.player_.lastVolume_(); if (0 === e) { var r = .1 > i ? .1 : i; this.player_.volume(r), this.player_.muted(!1) } else this.player_.muted(this.player_.muted() ? !1 : !0) }, e.prototype.update = function (t) { this.updateIcon_(), this.updateControlText_() }, e.prototype.updateIcon_ = function () { var t = this.player_.volume(), e = 3; Ti && this.player_.muted(this.player_.tech_.el_.muted), 0 === t || this.player_.muted() ? e = 0 : .33 > t ? e = 1 : .67 > t && (e = 2); for (var i = 0; 4 > i; i++)b(this.el_, "vjs-vol-" + i); _(this.el_, "vjs-vol-" + e) }, e.prototype.updateControlText_ = function () { var t = this.player_.muted() || 0 === this.player_.volume(), e = t ? "Unmute" : "Mute"; this.controlText() !== e && this.controlText(e) }, e }(Fn); pa.prototype.controlText_ = "Mute", fi.registerComponent("MuteToggle", pa); var fa = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; Re(this, e), "undefined" != typeof r.inline ? r.inline = r.inline : r.inline = !0, ("undefined" == typeof r.volumeControl || s(r.volumeControl)) && (r.volumeControl = r.volumeControl || {}, r.volumeControl.vertical = !r.inline); var n = Ue(this, t.call(this, i, r)); return n.on(i, ["loadstart"], n.volumePanelState_), n.on(n.volumeControl, ["slideractive"], n.sliderActive_), n.on(n.volumeControl, ["sliderinactive"], n.sliderInactive_), n } return Me(e, t), e.prototype.sliderActive_ = function () { this.addClass("vjs-slider-active") }, e.prototype.sliderInactive_ = function () { this.removeClass("vjs-slider-active") }, e.prototype.volumePanelState_ = function () { this.volumeControl.hasClass("vjs-hidden") && this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-hidden"), this.volumeControl.hasClass("vjs-hidden") && !this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-mute-toggle-only") }, e.prototype.createEl = function () { var e = "vjs-volume-panel-horizontal"; return this.options_.inline || (e = "vjs-volume-panel-vertical"), t.prototype.createEl.call(this, "div", { className: "vjs-volume-panel vjs-control " + e }) }, e }(fi); fa.prototype.options_ = { children: ["muteToggle", "volumeControl"] }, fi.registerComponent("VolumePanel", fa); var ma = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return r && (n.menuButton_ = r.menuButton), n.focusedChild_ = -1, n.on("keydown", n.handleKeyPress), n } return Me(e, t), e.prototype.addItem = function (t) { this.addChild(t), t.on("click", ei(this, function (e) { this.menuButton_ && (this.menuButton_.unpressButton(), "CaptionSettingsMenuItem" !== t.name() && this.menuButton_.focus()) })) }, e.prototype.createEl = function () { var e = this.options_.contentElType || "ul"; this.contentEl_ = m(e, { className: "vjs-menu-content" }), this.contentEl_.setAttribute("role", "menu"); var i = t.prototype.createEl.call(this, "div", { append: this.contentEl_, className: "vjs-menu" }); return i.appendChild(this.contentEl_), z(i, "click", function (t) { t.preventDefault(), t.stopImmediatePropagation() }), i }, e.prototype.dispose = function () { this.contentEl_ = null, t.prototype.dispose.call(this) }, e.prototype.handleKeyPress = function (t) { 37 === t.which || 40 === t.which ? (t.preventDefault(), this.stepForward()) : (38 === t.which || 39 === t.which) && (t.preventDefault(), this.stepBack()) }, e.prototype.stepForward = function () { var t = 0; void 0 !== this.focusedChild_ && (t = this.focusedChild_ + 1), this.focus(t) }, e.prototype.stepBack = function () { var t = 0; void 0 !== this.focusedChild_ && (t = this.focusedChild_ - 1), this.focus(t) }, e.prototype.focus = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0, e = this.children().slice(), i = e.length && e[0].className && /vjs-menu-title/.test(e[0].className); i && e.shift(), e.length > 0 && (0 > t ? t = 0 : t >= e.length && (t = e.length - 1), this.focusedChild_ = t, e[t].el_.focus()) }, e }(fi); fi.registerComponent("Menu", ma); var ga = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; Re(this, e); var n = Ue(this, t.call(this, i, r)); n.menuButton_ = new Fn(i, r), n.menuButton_.controlText(n.controlText_), n.menuButton_.el_.setAttribute("aria-haspopup", "true"); var a = Fn.prototype.buildCSSClass(); return n.menuButton_.el_.className = n.buildCSSClass() + " " + a, n.menuButton_.removeClass("vjs-control"), n.addChild(n.menuButton_), n.update(), n.enabled_ = !0, n.on(n.menuButton_, "tap", n.handleClick), n.on(n.menuButton_, "click", n.handleClick), n.on(n.menuButton_, "focus", n.handleFocus), n.on(n.menuButton_, "blur", n.handleBlur), n.on("keydown", n.handleSubmenuKeyPress), n } return Me(e, t), e.prototype.update = function () { var t = this.createMenu(); this.menu && (this.menu.dispose(), this.removeChild(this.menu)), this.menu = t, this.addChild(t), this.buttonPressed_ = !1, this.menuButton_.el_.setAttribute("aria-expanded", "false"), this.items && this.items.length <= this.hideThreshold_ ? this.hide() : this.show() }, e.prototype.createMenu = function () { var t = new ma(this.player_, { menuButton: this }); if (this.hideThreshold_ = 0, this.options_.title) { var e = m("li", { className: "vjs-menu-title", innerHTML: Q(this.options_.title), tabIndex: -1 }); this.hideThreshold_ += 1, t.children_.unshift(e), y(e, t.contentEl()) } if (this.items = this.createItems(), this.items) for (var i = 0; i < this.items.length; i++)t.addItem(this.items[i]); return t }, e.prototype.createItems = function () { }, e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: this.buildWrapperCSSClass() }, {}) }, e.prototype.buildWrapperCSSClass = function () { var e = "vjs-menu-button"; e += this.options_.inline === !0 ? "-inline" : "-popup"; var i = Fn.prototype.buildCSSClass(); return "vjs-menu-button " + e + " " + i + " " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildCSSClass = function () { var e = "vjs-menu-button"; return e += this.options_.inline === !0 ? "-inline" : "-popup", "vjs-menu-button " + e + " " + t.prototype.buildCSSClass.call(this) }, e.prototype.controlText = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this.menuButton_.el(); return this.menuButton_.controlText(t, e) }, e.prototype.handleClick = function (t) { this.one(this.menu.contentEl(), "mouseleave", ei(this, function (t) { this.unpressButton(), this.el_.blur() })), this.buttonPressed_ ? this.unpressButton() : this.pressButton() }, e.prototype.focus = function () { this.menuButton_.focus() }, e.prototype.blur = function () { this.menuButton_.blur() }, e.prototype.handleFocus = function () { z(we, "keydown", ei(this, this.handleKeyPress)) }, e.prototype.handleBlur = function () { G(we, "keydown", ei(this, this.handleKeyPress)) }, e.prototype.handleKeyPress = function (t) { 27 === t.which || 9 === t.which ? (this.buttonPressed_ && this.unpressButton(), 9 !== t.which && (t.preventDefault(), this.menuButton_.el_.focus())) : (38 === t.which || 40 === t.which) && (this.buttonPressed_ || (this.pressButton(), t.preventDefault())) }, e.prototype.handleSubmenuKeyPress = function (t) { (27 === t.which || 9 === t.which) && (this.buttonPressed_ && this.unpressButton(), 9 !== t.which && (t.preventDefault(), this.menuButton_.el_.focus())) }, e.prototype.pressButton = function () { if (this.enabled_) { if (this.buttonPressed_ = !0, this.menu.lockShowing(), this.menuButton_.el_.setAttribute("aria-expanded", "true"), Ti && p()) return; this.menu.focus() } }, e.prototype.unpressButton = function () { this.enabled_ && (this.buttonPressed_ = !1, this.menu.unlockShowing(), this.menuButton_.el_.setAttribute("aria-expanded", "false")) }, e.prototype.disable = function () { this.unpressButton(), this.enabled_ = !1, this.addClass("vjs-disabled"), this.menuButton_.disable() }, e.prototype.enable = function () { this.enabled_ = !0, this.removeClass("vjs-disabled"), this.menuButton_.enable() }, e }(fi); fi.registerComponent("MenuButton", ga); var ya = function (t) { function e(i, r) { Re(this, e); var n = r.tracks, a = Ue(this, t.call(this, i, r)); if (a.items.length <= 1 && a.hide(), !n) return Ue(a); var s = ei(a, a.update); return n.addEventListener("removetrack", s), n.addEventListener("addtrack", s), a.player_.on("ready", s), a.player_.on("dispose", function () { n.removeEventListener("removetrack", s), n.removeEventListener("addtrack", s) }), a } return Me(e, t), e }(ga); fi.registerComponent("TrackButton", ya); var va = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.selectable = r.selectable, n.isSelected_ = r.selected || !1, n.multiSelectable = r.multiSelectable, n.selected(n.isSelected_), n.selectable ? n.multiSelectable ? n.el_.setAttribute("role", "menuitemcheckbox") : n.el_.setAttribute("role", "menuitemradio") : n.el_.setAttribute("role", "menuitem"), n } return Me(e, t), e.prototype.createEl = function (e, i, r) { return this.nonIconControl = !0, t.prototype.createEl.call(this, "li", n({ className: "vjs-menu-item", innerHTML: '<span class="vjs-menu-item-text">' + this.localize(this.options_.label) + "</span>", tabIndex: -1 }, i), r) }, e.prototype.handleClick = function (t) { this.selected(!0) }, e.prototype.selected = function (t) { this.selectable && (t ? (this.addClass("vjs-selected"), this.el_.setAttribute("aria-checked", "true"), this.controlText(", selected"), this.isSelected_ = !0) : (this.removeClass("vjs-selected"), this.el_.setAttribute("aria-checked", "false"), this.controlText(""), this.isSelected_ = !1)) }, e }(Dn); fi.registerComponent("MenuItem", va); var _a = function (t) { function e(i, r) { Re(this, e); var n = r.track, a = i.textTracks(); r.label = n.label || n.language || "Unknown", r.selected = "showing" === n.mode; var s = Ue(this, t.call(this, i, r)); s.track = n; var o = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; s.handleTracksChange.apply(s, e) }, u = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; s.handleSelectedLanguageChange.apply(s, e) }; if (i.on(["loadstart", "texttrackchange"], o), a.addEventListener("change", o), a.addEventListener("selectedlanguagechange", u), s.on("dispose", function () { i.off(["loadstart", "texttrackchange"], o), a.removeEventListener("change", o), a.removeEventListener("selectedlanguagechange", u) }), void 0 === a.onchange) { var l = void 0; s.on(["tap", "click"], function () { if ("object" !== De(Te.Event)) try { l = new Te.Event("change") } catch (t) { } l || (l = we.createEvent("Event"), l.initEvent("change", !0, !0)), a.dispatchEvent(l) }) } return s.handleTracksChange(), s } return Me(e, t), e.prototype.handleClick = function (e) { var i = this.track.kind, r = this.track.kinds, n = this.player_.textTracks(); if (r || (r = [i]), t.prototype.handleClick.call(this, e), n) for (var a = 0; a < n.length; a++) { var s = n[a]; s === this.track && r.indexOf(s.kind) > -1 ? "showing" !== s.mode && (s.mode = "showing") : "disabled" !== s.mode && (s.mode = "disabled") } }, e.prototype.handleTracksChange = function (t) { var e = "showing" === this.track.mode; e !== this.isSelected_ && this.selected(e) }, e.prototype.handleSelectedLanguageChange = function (t) { if ("showing" === this.track.mode) { var e = this.player_.cache_.selectedLanguage; if (e && e.enabled && e.language === this.track.language && e.kind !== this.track.kind) return; this.player_.cache_.selectedLanguage = { enabled: !0, language: this.track.language, kind: this.track.kind } } }, e.prototype.dispose = function () { this.track = null, t.prototype.dispose.call(this) }, e }(va); fi.registerComponent("TextTrackMenuItem", _a); var ba = function (t) {
    function e(i, r) { return Re(this, e), r.track = { player: i, kind: r.kind, kinds: r.kinds, "default": !1, mode: "disabled" }, r.kinds || (r.kinds = [r.kind]), r.label ? r.track.label = r.label : r.track.label = r.kinds.join(" and ") + " off", r.selectable = !0, r.multiSelectable = !1, Ue(this, t.call(this, i, r)) } return Me(e, t), e.prototype.handleTracksChange = function (t) { for (var e = this.player().textTracks(), i = !0, r = 0, n = e.length; n > r; r++) { var a = e[r]; if (this.options_.kinds.indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i !== this.isSelected_ && this.selected(i) }, e.prototype.handleSelectedLanguageChange = function (t) { for (var e = this.player().textTracks(), i = !0, r = 0, n = e.length; n > r; r++) { var a = e[r]; if (["captions", "descriptions", "subtitles"].indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i && (this.player_.cache_.selectedLanguage = { enabled: !1 }) }, e
  }(_a); fi.registerComponent("OffTextTrackMenuItem", ba); var Ta = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return Re(this, e), r.tracks = i.textTracks(), Ue(this, t.call(this, i, r)) } return Me(e, t), e.prototype.createItems = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [], e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : _a, i = void 0; this.label_ && (i = this.label_ + " off"), t.push(new ba(this.player_, { kinds: this.kinds_, kind: this.kind_, label: i })), this.hideThreshold_ += 1; var r = this.player_.textTracks(); Array.isArray(this.kinds_) || (this.kinds_ = [this.kind_]); for (var n = 0; n < r.length; n++) { var a = r[n]; if (this.kinds_.indexOf(a.kind) > -1) { var s = new e(this.player_, { track: a, selectable: !0, multiSelectable: !1 }); s.addClass("vjs-" + a.kind + "-menu-item"), t.push(s) } } return t }, e }(ya); fi.registerComponent("TextTrackButton", Ta); var Sa = function (t) { function e(i, r) { Re(this, e); var n = r.track, a = r.cue, s = i.currentTime(); r.selectable = !0, r.multiSelectable = !1, r.label = a.text, r.selected = a.startTime <= s && s < a.endTime; var o = Ue(this, t.call(this, i, r)); return o.track = n, o.cue = a, n.addEventListener("cuechange", ei(o, o.update)), o } return Me(e, t), e.prototype.handleClick = function (e) { t.prototype.handleClick.call(this), this.player_.currentTime(this.cue.startTime), this.update(this.cue.startTime) }, e.prototype.update = function (t) { var e = this.cue, i = this.player_.currentTime(); this.selected(e.startTime <= i && i < e.endTime) }, e }(va); fi.registerComponent("ChaptersTrackMenuItem", Sa); var ka = function (t) { function e(i, r, n) { return Re(this, e), Ue(this, t.call(this, i, r, n)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-chapters-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-chapters-button " + t.prototype.buildWrapperCSSClass.call(this) }, e.prototype.update = function (e) { (!this.track_ || e && ("addtrack" === e.type || "removetrack" === e.type)) && this.setTrack(this.findChaptersTrack()), t.prototype.update.call(this) }, e.prototype.setTrack = function (t) { if (this.track_ !== t) { if (this.updateHandler_ || (this.updateHandler_ = this.update.bind(this)), this.track_) { var e = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); e && e.removeEventListener("load", this.updateHandler_), this.track_ = null } if (this.track_ = t, this.track_) { this.track_.mode = "hidden"; var i = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); i && i.addEventListener("load", this.updateHandler_) } } }, e.prototype.findChaptersTrack = function () { for (var t = this.player_.textTracks() || [], e = t.length - 1; e >= 0; e--) { var i = t[e]; if (i.kind === this.kind_) return i } }, e.prototype.getMenuCaption = function () { return this.track_ && this.track_.label ? this.track_.label : this.localize(Q(this.kind_)) }, e.prototype.createMenu = function () { return this.options_.title = this.getMenuCaption(), t.prototype.createMenu.call(this) }, e.prototype.createItems = function () { var t = []; if (!this.track_) return t; var e = this.track_.cues; if (!e) return t; for (var i = 0, r = e.length; r > i; i++) { var n = e[i], a = new Sa(this.player_, { track: this.track_, cue: n }); t.push(a) } return t }, e }(Ta); ka.prototype.kind_ = "chapters", ka.prototype.controlText_ = "Chapters", fi.registerComponent("ChaptersButton", ka); var Ea = function (t) { function e(i, r, n) { Re(this, e); var a = Ue(this, t.call(this, i, r, n)), s = i.textTracks(), o = ei(a, a.handleTracksChange); return s.addEventListener("change", o), a.on("dispose", function () { s.removeEventListener("change", o) }), a } return Me(e, t), e.prototype.handleTracksChange = function (t) { for (var e = this.player().textTracks(), i = !1, r = 0, n = e.length; n > r; r++) { var a = e[r]; if (a.kind !== this.kind_ && "showing" === a.mode) { i = !0; break } } i ? this.disable() : this.enable() }, e.prototype.buildCSSClass = function () { return "vjs-descriptions-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-descriptions-button " + t.prototype.buildWrapperCSSClass.call(this) }, e }(Ta); Ea.prototype.kind_ = "descriptions", Ea.prototype.controlText_ = "Descriptions", fi.registerComponent("DescriptionsButton", Ea); var Ca = function (t) { function e(i, r, n) { return Re(this, e), Ue(this, t.call(this, i, r, n)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-subtitles-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-subtitles-button " + t.prototype.buildWrapperCSSClass.call(this) }, e }(Ta); Ca.prototype.kind_ = "subtitles", Ca.prototype.controlText_ = "Subtitles", fi.registerComponent("SubtitlesButton", Ca); var wa = function (t) { function e(i, r) { Re(this, e), r.track = { player: i, kind: r.kind, label: r.kind + " settings", selectable: !1, "default": !1, mode: "disabled" }, r.selectable = !1, r.name = "CaptionSettingsMenuItem"; var n = Ue(this, t.call(this, i, r)); return n.addClass("vjs-texttrack-settings"), n.controlText(", opens " + r.kind + " settings dialog"), n } return Me(e, t), e.prototype.handleClick = function (t) { this.player().getChild("textTrackSettings").open() }, e }(_a); fi.registerComponent("CaptionSettingsMenuItem", wa); var Aa = function (t) { function e(i, r, n) { return Re(this, e), Ue(this, t.call(this, i, r, n)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-captions-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-captions-button " + t.prototype.buildWrapperCSSClass.call(this) }, e.prototype.createItems = function () { var e = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (e.push(new wa(this.player_, { kind: this.kind_ })), this.hideThreshold_ += 1), t.prototype.createItems.call(this, e) }, e }(Ta); Aa.prototype.kind_ = "captions", Aa.prototype.controlText_ = "Captions", fi.registerComponent("CaptionsButton", Aa); var La = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function (e, i, r) { var a = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); "captions" === this.options_.track.kind && (a += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> ' + this.localize("Captions") + "</span>\n      "), a += "</span>"; var s = t.prototype.createEl.call(this, e, n({ innerHTML: a }, i), r); return s }, e }(_a); fi.registerComponent("SubsCapsMenuItem", La); var Pa = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.label_ = "subtitles", ["en", "en-us", "en-ca", "fr-ca"].indexOf(n.player_.language_) > -1 && (n.label_ = "captions"), n.menuButton_.controlText(Q(n.label_)), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-subs-caps-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-subs-caps-button " + t.prototype.buildWrapperCSSClass.call(this) }, e.prototype.createItems = function () { var e = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (e.push(new wa(this.player_, { kind: this.label_ })), this.hideThreshold_ += 1), e = t.prototype.createItems.call(this, e, La) }, e }(Ta); Pa.prototype.kinds_ = ["captions", "subtitles"], Pa.prototype.controlText_ = "Subtitles", fi.registerComponent("SubsCapsButton", Pa); var Oa = function (t) { function e(i, r) { Re(this, e); var n = r.track, a = i.audioTracks(); r.label = n.label || n.language || "Unknown", r.selected = n.enabled; var s = Ue(this, t.call(this, i, r)); s.track = n, s.addClass("vjs-" + n.kind + "-menu-item"); var o = function () { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; s.handleTracksChange.apply(s, e) }; return a.addEventListener("change", o), s.on("dispose", function () { a.removeEventListener("change", o) }), s } return Me(e, t), e.prototype.createEl = function (e, i, r) { var a = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); "main-desc" === this.options_.track.kind && (a += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> ' + this.localize("Descriptions") + "</span>\n      "), a += "</span>"; var s = t.prototype.createEl.call(this, e, n({ innerHTML: a }, i), r); return s }, e.prototype.handleClick = function (e) { var i = this.player_.audioTracks(); t.prototype.handleClick.call(this, e); for (var r = 0; r < i.length; r++) { var n = i[r]; n.enabled = n === this.track } }, e.prototype.handleTracksChange = function (t) { this.selected(this.track.enabled) }, e }(va); fi.registerComponent("AudioTrackMenuItem", Oa); var Ia = function (t) { function e(i) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return Re(this, e), r.tracks = i.audioTracks(), Ue(this, t.call(this, i, r)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-audio-button " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-audio-button " + t.prototype.buildWrapperCSSClass.call(this) }, e.prototype.createItems = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []; this.hideThreshold_ = 1; for (var e = this.player_.audioTracks(), i = 0; i < e.length; i++) { var r = e[i]; t.push(new Oa(this.player_, { track: r, selectable: !0, multiSelectable: !1 })) } return t }, e }(ya); Ia.prototype.controlText_ = "Audio Track", fi.registerComponent("AudioTrackButton", Ia); var xa = function (t) { function e(i, r) { Re(this, e); var n = r.rate, a = parseFloat(n, 10); r.label = n, r.selected = 1 === a, r.selectable = !0, r.multiSelectable = !1; var s = Ue(this, t.call(this, i, r)); return s.label = n, s.rate = a, s.on(i, "ratechange", s.update), s } return Me(e, t), e.prototype.handleClick = function (e) { t.prototype.handleClick.call(this), this.player().playbackRate(this.rate) }, e.prototype.update = function (t) { this.selected(this.player().playbackRate() === this.rate) }, e }(va); xa.prototype.contentElType = "button", fi.registerComponent("PlaybackRateMenuItem", xa); var Da = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.updateVisibility(), n.updateLabel(), n.on(i, "loadstart", n.updateVisibility), n.on(i, "ratechange", n.updateLabel), n } return Me(e, t), e.prototype.createEl = function () { var e = t.prototype.createEl.call(this); return this.labelEl_ = m("div", { className: "vjs-playback-rate-value", innerHTML: "1x" }), e.appendChild(this.labelEl_), e }, e.prototype.dispose = function () { this.labelEl_ = null, t.prototype.dispose.call(this) }, e.prototype.buildCSSClass = function () { return "vjs-playback-rate " + t.prototype.buildCSSClass.call(this) }, e.prototype.buildWrapperCSSClass = function () { return "vjs-playback-rate " + t.prototype.buildWrapperCSSClass.call(this) }, e.prototype.createMenu = function () { var t = new ma(this.player()), e = this.playbackRates(); if (e) for (var i = e.length - 1; i >= 0; i--)t.addChild(new xa(this.player(), { rate: e[i] + "x" })); return t }, e.prototype.updateARIAAttributes = function () { this.el().setAttribute("aria-valuenow", this.player().playbackRate()) }, e.prototype.handleClick = function (t) { for (var e = this.player().playbackRate(), i = this.playbackRates(), r = i[0], n = 0; n < i.length; n++)if (i[n] > e) { r = i[n]; break } this.player().playbackRate(r) }, e.prototype.playbackRates = function () { return this.options_.playbackRates || this.options_.playerOptions && this.options_.playerOptions.playbackRates }, e.prototype.playbackRateSupported = function () { return this.player().tech_ && this.player().tech_.featuresPlaybackRate && this.playbackRates() && this.playbackRates().length > 0 }, e.prototype.updateVisibility = function (t) { this.playbackRateSupported() ? this.removeClass("vjs-hidden") : this.addClass("vjs-hidden") }, e.prototype.updateLabel = function (t) { this.playbackRateSupported() && (this.labelEl_.innerHTML = this.player().playbackRate() + "x") }, e }(ga); Da.prototype.controlText_ = "Playback Rate", fi.registerComponent("PlaybackRateMenuButton", Da); var Ra = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-spacer " + t.prototype.buildCSSClass.call(this) }, e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: this.buildCSSClass() }) }, e }(fi); fi.registerComponent("Spacer", Ra); var Ma = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-custom-control-spacer " + t.prototype.buildCSSClass.call(this) }, e.prototype.createEl = function () { var e = t.prototype.createEl.call(this, { className: this.buildCSSClass() }); return e.innerHTML = "\xa0", e }, e }(Ra); fi.registerComponent("CustomControlSpacer", Ma); var Ua = function (t) { function e() { return Re(this, e), Ue(this, t.apply(this, arguments)) } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-control-bar", dir: "ltr" }) }, e }(fi); Ua.prototype.options_ = { children: ["playToggle", "volumePanel", "currentTimeDisplay", "timeDivider", "durationDisplay", "progressControl", "liveDisplay", "remainingTimeDisplay", "customControlSpacer", "playbackRateMenuButton", "chaptersButton", "descriptionsButton", "subsCapsButton", "audioTrackButton", "fullscreenToggle"] }, fi.registerComponent("ControlBar", Ua); var Na = function (t) { function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)); return n.on(i, "error", n.open), n } return Me(e, t), e.prototype.buildCSSClass = function () { return "vjs-error-display " + t.prototype.buildCSSClass.call(this) }, e.prototype.content = function () { var t = this.player().error(); return t ? this.localize(t.message) : "" }, e }($i); Na.prototype.options_ = tt($i.prototype.options_, { pauseOnOpen: !1, fillAlways: !0, temporary: !1, uncloseable: !0 }), fi.registerComponent("ErrorDisplay", Na); var Ba = "vjs-text-track-settings", ja = ["#000", "Black"], Fa = ["#00F", "Blue"], Ha = ["#0FF", "Cyan"], Va = ["#0F0", "Green"], qa = ["#F0F", "Magenta"], Wa = ["#F00", "Red"], za = ["#FFF", "White"], Ga = ["#FF0", "Yellow"], Xa = ["1", "Opaque"], Ya = ["0.5", "Semi-Transparent"], $a = ["0", "Transparent"], Ka = { backgroundColor: { selector: ".vjs-bg-color > select", id: "captions-background-color-%s", label: "Color", options: [ja, za, Wa, Va, Fa, Ga, qa, Ha] }, backgroundOpacity: { selector: ".vjs-bg-opacity > select", id: "captions-background-opacity-%s", label: "Transparency", options: [Xa, Ya, $a] }, color: { selector: ".vjs-fg-color > select", id: "captions-foreground-color-%s", label: "Color", options: [za, ja, Wa, Va, Fa, Ga, qa, Ha] }, edgeStyle: { selector: ".vjs-edge-style > select", id: "%s", label: "Text Edge Style", options: [["none", "None"], ["raised", "Raised"], ["depressed", "Depressed"], ["uniform", "Uniform"], ["dropshadow", "Dropshadow"]] }, fontFamily: { selector: ".vjs-font-family > select", id: "captions-font-family-%s", label: "Font Family", options: [["proportionalSansSerif", "Proportional Sans-Serif"], ["monospaceSansSerif", "Monospace Sans-Serif"], ["proportionalSerif", "Proportional Serif"], ["monospaceSerif", "Monospace Serif"], ["casual", "Casual"], ["script", "Script"], ["small-caps", "Small Caps"]] }, fontPercent: { selector: ".vjs-font-percent > select", id: "captions-font-size-%s", label: "Font Size", options: [["0.50", "50%"], ["0.75", "75%"], ["1.00", "100%"], ["1.25", "125%"], ["1.50", "150%"], ["1.75", "175%"], ["2.00", "200%"], ["3.00", "300%"], ["4.00", "400%"]], "default": 2, parser: function (t) { return "1.00" === t ? null : Number(t) } }, textOpacity: { selector: ".vjs-text-opacity > select", id: "captions-foreground-opacity-%s", label: "Transparency", options: [Xa, Ya] }, windowColor: { selector: ".vjs-window-color > select", id: "captions-window-color-%s", label: "Color" }, windowOpacity: { selector: ".vjs-window-opacity > select", id: "captions-window-opacity-%s", label: "Transparency", options: [$a, Ya, Xa] } }; Ka.windowColor.options = Ka.backgroundColor.options; var Ja = function (t) { function e(r, n) { Re(this, e), n.temporary = !1; var a = Ue(this, t.call(this, r, n)); return a.updateDisplay = ei(a, a.updateDisplay), a.fill(), a.hasBeenOpened_ = a.hasBeenFilled_ = !0, a.endDialog = m("p", { className: "vjs-control-text", textContent: a.localize("End of dialog window.") }), a.el().appendChild(a.endDialog), a.setDefaults(), void 0 === n.persistTextTrackSettings && (a.options_.persistTextTrackSettings = a.options_.playerOptions.persistTextTrackSettings), a.on(a.$(".vjs-done-button"), "click", function () { a.saveSettings(), a.close() }), a.on(a.$(".vjs-default-button"), "click", function () { a.setDefaults(), a.updateDisplay() }), i(Ka, function (t) { a.on(a.$(t.selector), "change", a.updateDisplay) }), a.options_.persistTextTrackSettings && a.restoreSettings(), a } return Me(e, t), e.prototype.dispose = function () { this.endDialog = null, t.prototype.dispose.call(this) }, e.prototype.createElSelect_ = function (t) { var e = this, i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "", r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "label", n = Ka[t], a = n.id.replace("%s", this.id_), s = [i, a].join(" ").trim(); return ["<" + r + ' id="' + a + '" class="' + ("label" === r ? "vjs-label" : "") + '">', this.localize(n.label), "</" + r + ">", '<select aria-labelledby="' + s + '">'].concat(n.options.map(function (t) { var i = a + "-" + t[1].replace(/\W+/g, ""); return ['<option id="' + i + '" value="' + t[0] + '" ', 'aria-labelledby="' + s + " " + i + '">', e.localize(t[1]), "</option>"].join("") })).concat("</select>").join("") }, e.prototype.createElFgColor_ = function () { var t = "captions-text-legend-" + this.id_; return ['<fieldset class="vjs-fg-color vjs-track-setting">', '<legend id="' + t + '">', this.localize("Text"), "</legend>", this.createElSelect_("color", t), '<span class="vjs-text-opacity vjs-opacity">', this.createElSelect_("textOpacity", t), "</span>", "</fieldset>"].join("") }, e.prototype.createElBgColor_ = function () { var t = "captions-background-" + this.id_; return ['<fieldset class="vjs-bg-color vjs-track-setting">', '<legend id="' + t + '">', this.localize("Background"), "</legend>", this.createElSelect_("backgroundColor", t), '<span class="vjs-bg-opacity vjs-opacity">', this.createElSelect_("backgroundOpacity", t), "</span>", "</fieldset>"].join("") }, e.prototype.createElWinColor_ = function () { var t = "captions-window-" + this.id_; return ['<fieldset class="vjs-window-color vjs-track-setting">', '<legend id="' + t + '">', this.localize("Window"), "</legend>", this.createElSelect_("windowColor", t), '<span class="vjs-window-opacity vjs-opacity">', this.createElSelect_("windowOpacity", t), "</span>", "</fieldset>"].join("") }, e.prototype.createElColors_ = function () { return m("div", { className: "vjs-track-settings-colors", innerHTML: [this.createElFgColor_(), this.createElBgColor_(), this.createElWinColor_()].join("") }) }, e.prototype.createElFont_ = function () { return m("div", { className: "vjs-track-settings-font", innerHTML: ['<fieldset class="vjs-font-percent vjs-track-setting">', this.createElSelect_("fontPercent", "", "legend"), "</fieldset>", '<fieldset class="vjs-edge-style vjs-track-setting">', this.createElSelect_("edgeStyle", "", "legend"), "</fieldset>", '<fieldset class="vjs-font-family vjs-track-setting">', this.createElSelect_("fontFamily", "", "legend"), "</fieldset>"].join("") }) }, e.prototype.createElControls_ = function () { var t = this.localize("restore all settings to the default values"); return m("div", { className: "vjs-track-settings-controls", innerHTML: ['<button class="vjs-default-button" title="' + t + '">', this.localize("Reset"), '<span class="vjs-control-text"> ' + t + "</span>", "</button>", '<button class="vjs-done-button">' + this.localize("Done") + "</button>"].join("") }) }, e.prototype.content = function () { return [this.createElColors_(), this.createElFont_(), this.createElControls_()] }, e.prototype.label = function () { return this.localize("Caption Settings Dialog") }, e.prototype.description = function () { return this.localize("Beginning of dialog window. Escape will cancel and close the window.") }, e.prototype.buildCSSClass = function () { return t.prototype.buildCSSClass.call(this) + " vjs-text-track-settings" }, e.prototype.getValues = function () { var t = this; return r(Ka, function (e, i, r) { var n = ue(t.$(i.selector), i.parser); return void 0 !== n && (e[r] = n), e }, {}) }, e.prototype.setValues = function (t) { var e = this; i(Ka, function (i, r) { le(e.$(i.selector), t[r], i.parser) }) }, e.prototype.setDefaults = function () { var t = this; i(Ka, function (e) { var i = e.hasOwnProperty("default") ? e["default"] : 0; t.$(e.selector).selectedIndex = i }) }, e.prototype.restoreSettings = function () { var t = void 0; try { t = JSON.parse(Te.localStorage.getItem(Ba)) } catch (e) { Ie.warn(e) } t && this.setValues(t) }, e.prototype.saveSettings = function () { if (this.options_.persistTextTrackSettings) { var t = this.getValues(); try { Object.keys(t).length ? Te.localStorage.setItem(Ba, JSON.stringify(t)) : Te.localStorage.removeItem(Ba) } catch (e) { Ie.warn(e) } } }, e.prototype.updateDisplay = function () { var t = this.player_.getChild("textTrackDisplay"); t && t.updateDisplay() }, e.prototype.conditionalBlur_ = function () { this.previouslyActiveEl_ = null, this.off(we, "keydown", this.handleKeyDown); var t = this.player_.controlBar, e = t && t.subsCapsButton, i = t && t.captionsButton; e ? e.focus() : i && i.focus() }, e }($i); fi.registerComponent("TextTrackSettings", Ja); var Qa = function (t) { function e(i, r) { Re(this, e); var n = r.ResizeObserver || Te.ResizeObserver; null === r.ResizeObserver && (n = !1); var a = tt({ createEl: !n }, r), s = Ue(this, t.call(this, i, a)); return s.ResizeObserver = r.ResizeObserver || Te.ResizeObserver, s.loadListener_ = null, s.resizeObserver_ = null, s.debouncedHandler_ = ri(function () { s.resizeHandler() }, 100, !1, i), n ? (s.resizeObserver_ = new s.ResizeObserver(s.debouncedHandler_), s.resizeObserver_.observe(i.el())) : (s.loadListener_ = function () { s.el_.contentWindow && z(s.el_.contentWindow, "resize", s.debouncedHandler_), s.off("load", s.loadListener_) }, s.on("load", s.loadListener_)), s } return Me(e, t), e.prototype.createEl = function () { return t.prototype.createEl.call(this, "iframe", { className: "vjs-resize-manager" }) }, e.prototype.resizeHandler = function () { this.player_.trigger("playerresize") }, e.prototype.dispose = function () { this.resizeObserver_ && (this.player_.el() && this.resizeObserver_.unobserve(this.player_.el()), this.resizeObserver_.disconnect()), this.el_ && this.el_.contentWindow && G(this.el_.contentWindow, "resize", this.debouncedHandler_), this.loadListener_ && this.off("load", this.loadListener_), this.ResizeObserver = null, this.resizeObserver = null, this.debouncedHandler_ = null, this.loadListener_ = null }, e }(fi); fi.registerComponent("ResizeManager", Qa); var Za = function (t) { var e = t.el(); if (e.hasAttribute("src")) return t.triggerSourceset(e.src), !0; var i = t.$$("source"), r = [], n = ""; if (!i.length) return !1; for (var a = 0; a < i.length; a++) { var s = i[a].src; s && -1 === r.indexOf(s) && r.push(s) } return r.length ? (1 === r.length && (n = r[0]), t.triggerSourceset(n), !0) : !1 }, ts = Object.defineProperty({}, "innerHTML", { get: function () { return this.cloneNode(!0).innerHTML }, set: function (t) { var e = we.createElement(this.nodeName.toLowerCase()); e.innerHTML = t; for (var i = we.createDocumentFragment(); e.childNodes.length;)i.appendChild(e.childNodes[0]); return this.innerText = "", Te.Element.prototype.appendChild.call(this, i), this.innerHTML } }), es = function (t, e) { for (var i = {}, r = 0; r < t.length && (i = Object.getOwnPropertyDescriptor(t[r], e), !(i && i.set && i.get)); r++); return i.enumerable = !0, i.configurable = !0, i }, is = function (t) { return es([t.el(), Te.HTMLMediaElement.prototype, Te.Element.prototype, ts], "innerHTML") }, rs = function (t) { var e = t.el(); if (!e.resetSourceWatch_) { var i = {}, r = is(t), n = function (i) { return function () { for (var r = arguments.length, n = Array(r), a = 0; r > a; a++)n[a] = arguments[a]; var s = i.apply(e, n); return Za(t), s } };["append", "appendChild", "insertAdjacentHTML"].forEach(function (t) { e[t] && (i[t] = e[t], e[t] = n(i[t])) }), Object.defineProperty(e, "innerHTML", tt(r, { set: n(r.set) })), e.resetSourceWatch_ = function () { e.resetSourceWatch_ = null, Object.keys(i).forEach(function (t) { e[t] = i[t] }), Object.defineProperty(e, "innerHTML", r) }, t.one("sourceset", e.resetSourceWatch_) } }, ns = Object.defineProperty({}, "src", { get: function () { return this.hasAttribute("src") ? hr(Te.Element.prototype.getAttribute.call(this, "src")) : "" }, set: function (t) { return Te.Element.prototype.setAttribute.call(this, "src", t), t } }), as = function (t) { return es([t.el(), Te.HTMLMediaElement.prototype, ns], "src") }, ss = function (t) { if (t.featuresSourceset) { var e = t.el(); if (!e.resetSourceset_) { var i = as(t), r = e.setAttribute, n = e.load; Object.defineProperty(e, "src", tt(i, { set: function (r) { var n = i.set.call(e, r); return t.triggerSourceset(e.src), n } })), e.setAttribute = function (i, n) { var a = r.call(e, i, n); return /src/i.test(i) && t.triggerSourceset(e.src), a }, e.load = function () { var i = n.call(e); return Za(t) || (t.triggerSourceset(""), rs(t)), i }, e.currentSrc ? t.triggerSourceset(e.currentSrc) : Za(t) || rs(t), e.resetSourceset_ = function () { e.resetSourceset_ = null, e.load = n, e.setAttribute = r, Object.defineProperty(e, "src", i), e.resetSourceWatch_ && e.resetSourceWatch_() } } } }, os = Ne(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."], ["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]), us = function (t) {
    function e(i, r) { Re(this, e); var n = Ue(this, t.call(this, i, r)), a = i.source, s = !1; if (a && (n.el_.currentSrc !== a.src || i.tag && 3 === i.tag.initNetworkState_) ? n.setSource(a) : n.handleLateInit_(n.el_), i.enableSourceset && n.setupSourcesetHandling_(), n.el_.hasChildNodes()) { for (var o = n.el_.childNodes, u = o.length, l = []; u--;) { var c = o[u], h = c.nodeName.toLowerCase(); "track" === h && (n.featuresNativeTextTracks ? (n.remoteTextTrackEls().addTrackElement_(c), n.remoteTextTracks().addTrack(c.track), n.textTracks().addTrack(c.track), s || n.el_.hasAttribute("crossorigin") || !pr(c.src) || (s = !0)) : l.push(c)) } for (var d = 0; d < l.length; d++)n.el_.removeChild(l[d]) } return n.proxyNativeTracks_(), n.featuresNativeTextTracks && s && Ie.warn(xe(os)), n.restoreMetadataTracksInIOSNativePlayer_(), (Di || _i || Ci) && i.nativeControlsForTouch === !0 && n.setControls(!0), n.proxyWebkitFullscreen_(), n.triggerReady(), n } return Me(e, t), e.prototype.dispose = function () { this.el_ && this.el_.resetSourceset_ && this.el_.resetSourceset_(), e.disposeMediaElement(this.el_), this.options_ = null, t.prototype.dispose.call(this) }, e.prototype.setupSourcesetHandling_ = function () { ss(this) }, e.prototype.restoreMetadataTracksInIOSNativePlayer_ = function () { var t = this.textTracks(), e = void 0, i = function () { e = []; for (var i = 0; i < t.length; i++) { var r = t[i]; "metadata" === r.kind && e.push({ track: r, storedMode: r.mode }) } }; i(), t.addEventListener("change", i), this.on("dispose", function () { return t.removeEventListener("change", i) }); var r = function n() { for (var i = 0; i < e.length; i++) { var r = e[i]; "disabled" === r.track.mode && r.track.mode !== r.storedMode && (r.track.mode = r.storedMode) } t.removeEventListener("change", n) }; this.on("webkitbeginfullscreen", function () { t.removeEventListener("change", i), t.removeEventListener("change", r), t.addEventListener("change", r) }), this.on("webkitendfullscreen", function () { t.removeEventListener("change", i), t.addEventListener("change", i), t.removeEventListener("change", r) }) }, e.prototype.overrideNative_ = function (t, e) { var i = this; if (e === this["featuresNative" + t + "Tracks"]) { var r = t.toLowerCase(); this[r + "TracksListeners_"] && Object.keys(this[r + "TracksListeners_"]).forEach(function (t) { var e = i.el()[r + "Tracks"]; e.removeEventListener(t, i[r + "TracksListeners_"][t]) }), this["featuresNative" + t + "Tracks"] = !e, this[r + "TracksListeners_"] = null, this.proxyNativeTracksForType_(r) } }, e.prototype.overrideNativeAudioTracks = function (t) { this.overrideNative_("Audio", t) }, e.prototype.overrideNativeVideoTracks = function (t) { this.overrideNative_("Video", t) }, e.prototype.proxyNativeTracksForType_ = function (t) { var e = this, i = Yr[t], r = this.el()[i.getterName], n = this[i.getterName](); if (this["featuresNative" + i.capitalName + "Tracks"] && r && r.addEventListener) { var a = { change: function (t) { n.trigger({ type: "change", target: n, currentTarget: n, srcElement: n }) }, addtrack: function (t) { n.addTrack(t.track) }, removetrack: function (t) { n.removeTrack(t.track) } }, s = function () { for (var t = [], e = 0; e < n.length; e++) { for (var i = !1, a = 0; a < r.length; a++)if (r[a] === n[e]) { i = !0; break } i || t.push(n[e]) } for (; t.length;)n.removeTrack(t.shift()) }; this[i.getterName + "Listeners_"] = a, Object.keys(a).forEach(function (t) { var i = a[t]; r.addEventListener(t, i), e.on("dispose", function (e) { return r.removeEventListener(t, i) }) }), this.on("loadstart", s), this.on("dispose", function (t) { return e.off("loadstart", s) }) } }, e.prototype.proxyNativeTracks_ = function () { var t = this; Yr.names.forEach(function (e) { t.proxyNativeTracksForType_(e) }) }, e.prototype.createEl = function () { var t = this.options_.tag; if (!t || !this.options_.playerElIngest && !this.movingMediaElementInDOM) { if (t) { var i = t.cloneNode(!0); t.parentNode && t.parentNode.insertBefore(i, t), e.disposeMediaElement(t), t = i } else { t = we.createElement("video"); var r = this.options_.tag && k(this.options_.tag), a = tt({}, r); Di && this.options_.nativeControlsForTouch === !0 || delete a.controls, S(t, n(a, { id: this.options_.techId, "class": "vjs-tech" })) } t.playerId = this.options_.playerId } "undefined" != typeof this.options_.preload && C(t, "preload", this.options_.preload); for (var s = ["loop", "muted", "playsinline", "autoplay"], o = 0; o < s.length; o++) { var u = s[o], l = this.options_[u]; "undefined" != typeof l && (l ? C(t, u, u) : w(t, u), t[u] = l) } return t }, e.prototype.handleLateInit_ = function (t) { if (0 !== t.networkState && 3 !== t.networkState) { if (0 === t.readyState) { var e = !1, i = function () { e = !0 }; this.on("loadstart", i); var r = function () { e || this.trigger("loadstart") }; return this.on("loadedmetadata", r), void this.ready(function () { this.off("loadstart", i), this.off("loadedmetadata", r), e || this.trigger("loadstart") }) } var n = ["loadstart"]; n.push("loadedmetadata"), t.readyState >= 2 && n.push("loadeddata"), t.readyState >= 3 && n.push("canplay"), t.readyState >= 4 && n.push("canplaythrough"), this.ready(function () { n.forEach(function (t) { this.trigger(t) }, this) }) } }, e.prototype.setCurrentTime = function (t) { try { this.el_.currentTime = t } catch (e) { Ie(e, "Video is not ready. (Video.js)") } }, e.prototype.duration = function () { var t = this; if (this.el_.duration === 1 / 0 && ki && Li && 0 === this.el_.currentTime) { var e = function i() { t.el_.currentTime > 0 && (t.el_.duration === 1 / 0 && t.trigger("durationchange"), t.off("timeupdate", i)) }; return this.on("timeupdate", e), NaN } return this.el_.duration || NaN }, e.prototype.width = function () { return this.el_.offsetWidth }, e.prototype.height = function () { return this.el_.offsetHeight }, e.prototype.proxyWebkitFullscreen_ = function () { var t = this; if ("webkitDisplayingFullscreen" in this.el_) { var e = function () { this.trigger("fullscreenchange", { isFullscreen: !1 }) }, i = function () { "webkitPresentationMode" in this.el_ && "picture-in-picture" !== this.el_.webkitPresentationMode && (this.one("webkitendfullscreen", e), this.trigger("fullscreenchange", { isFullscreen: !0 })) }; this.on("webkitbeginfullscreen", i), this.on("dispose", function () { t.off("webkitbeginfullscreen", i), t.off("webkitendfullscreen", e) }) } }, e.prototype.supportsFullScreen = function () { if ("function" == typeof this.el_.webkitEnterFullScreen) { var t = Te.navigator && Te.navigator.userAgent || ""; if (/Android/.test(t) || !/Chrome|Mac OS X 10.5/.test(t)) return !0 } return !1 }, e.prototype.enterFullScreen = function () { var t = this.el_; t.paused && t.networkState <= t.HAVE_METADATA ? (this.el_.play(), this.setTimeout(function () { t.pause(), t.webkitEnterFullScreen() }, 0)) : t.webkitEnterFullScreen() }, e.prototype.exitFullScreen = function () { this.el_.webkitExitFullScreen() }, e.prototype.src = function (t) { return void 0 === t ? this.el_.src : void this.setSrc(t) }, e.prototype.reset = function () { e.resetMediaElement(this.el_) }, e.prototype.currentSrc = function () { return this.currentSource_ ? this.currentSource_.src : this.el_.currentSrc }, e.prototype.setControls = function (t) { this.el_.controls = !!t }, e.prototype.addTextTrack = function (e, i, r) { return this.featuresNativeTextTracks ? this.el_.addTextTrack(e, i, r) : t.prototype.addTextTrack.call(this, e, i, r) }, e.prototype.createRemoteTextTrack = function (e) { if (!this.featuresNativeTextTracks) return t.prototype.createRemoteTextTrack.call(this, e); var i = we.createElement("track"); return e.kind && (i.kind = e.kind), e.label && (i.label = e.label), (e.language || e.srclang) && (i.srclang = e.language || e.srclang), e["default"] && (i["default"] = e["default"]), e.id && (i.id = e.id), e.src && (i.src = e.src), i }, e.prototype.addRemoteTextTrack = function (e, i) {
      var r = t.prototype.addRemoteTextTrack.call(this, e, i); return this.featuresNativeTextTracks && this.el().appendChild(r), r
    }, e.prototype.removeRemoteTextTrack = function (e) { if (t.prototype.removeRemoteTextTrack.call(this, e), this.featuresNativeTextTracks) for (var i = this.$$("track"), r = i.length; r--;)(e === i[r] || e === i[r].track) && this.el().removeChild(i[r]) }, e.prototype.getVideoPlaybackQuality = function () { if ("function" == typeof this.el().getVideoPlaybackQuality) return this.el().getVideoPlaybackQuality(); var t = {}; return "undefined" != typeof this.el().webkitDroppedFrameCount && "undefined" != typeof this.el().webkitDecodedFrameCount && (t.droppedVideoFrames = this.el().webkitDroppedFrameCount, t.totalVideoFrames = this.el().webkitDecodedFrameCount), Te.performance && "function" == typeof Te.performance.now ? t.creationTime = Te.performance.now() : Te.performance && Te.performance.timing && "number" == typeof Te.performance.timing.navigationStart && (t.creationTime = Te.Date.now() - Te.performance.timing.navigationStart), t }, e
  }(Tn); if (h()) { us.TEST_VID = we.createElement("video"); var ls = we.createElement("track"); ls.kind = "captions", ls.srclang = "en", ls.label = "English", us.TEST_VID.appendChild(ls) } us.isSupported = function () { try { us.TEST_VID.volume = .5 } catch (t) { return !1 } return !(!us.TEST_VID || !us.TEST_VID.canPlayType) }, us.canPlayType = function (t) { return us.TEST_VID.canPlayType(t) }, us.canPlaySource = function (t, e) { return us.canPlayType(t.type) }, us.canControlVolume = function () { try { var t = us.TEST_VID.volume; return us.TEST_VID.volume = t / 2 + .1, t !== us.TEST_VID.volume } catch (e) { return !1 } }, us.canMuteVolume = function () { try { var t = us.TEST_VID.muted; return us.TEST_VID.muted = !t, us.TEST_VID.muted ? C(us.TEST_VID, "muted", "muted") : w(us.TEST_VID, "muted", "muted"), t !== us.TEST_VID.muted } catch (e) { return !1 } }, us.canControlPlaybackRate = function () { if (ki && Li && 58 > Pi) return !1; try { var t = us.TEST_VID.playbackRate; return us.TEST_VID.playbackRate = t / 2 + .1, t !== us.TEST_VID.playbackRate } catch (e) { return !1 } }, us.canOverrideAttributes = function () { try { var t = function () { }; Object.defineProperty(we.createElement("video"), "src", { get: t, set: t }), Object.defineProperty(we.createElement("audio"), "src", { get: t, set: t }), Object.defineProperty(we.createElement("video"), "innerHTML", { get: t, set: t }), Object.defineProperty(we.createElement("audio"), "innerHTML", { get: t, set: t }) } catch (e) { return !1 } return !0 }, us.supportsNativeTextTracks = function () { return xi || Ti && Li }, us.supportsNativeVideoTracks = function () { return !(!us.TEST_VID || !us.TEST_VID.videoTracks) }, us.supportsNativeAudioTracks = function () { return !(!us.TEST_VID || !us.TEST_VID.audioTracks) }, us.Events = ["loadstart", "suspend", "abort", "error", "emptied", "stalled", "loadedmetadata", "loadeddata", "canplay", "canplaythrough", "playing", "waiting", "seeking", "seeked", "ended", "durationchange", "timeupdate", "progress", "play", "pause", "ratechange", "resize", "volumechange"], us.prototype.featuresVolumeControl = us.canControlVolume(), us.prototype.featuresMuteControl = us.canMuteVolume(), us.prototype.featuresPlaybackRate = us.canControlPlaybackRate(), us.prototype.featuresSourceset = us.canOverrideAttributes(), us.prototype.movingMediaElementInDOM = !Ti, us.prototype.featuresFullscreenResize = !0, us.prototype.featuresProgressEvents = !0, us.prototype.featuresTimeupdateEvents = !0, us.prototype.featuresNativeTextTracks = us.supportsNativeTextTracks(), us.prototype.featuresNativeVideoTracks = us.supportsNativeVideoTracks(), us.prototype.featuresNativeAudioTracks = us.supportsNativeAudioTracks(); var cs = us.TEST_VID && us.TEST_VID.constructor.prototype.canPlayType, hs = /^application\/(?:x-|vnd\.apple\.)mpegurl/i; us.patchCanPlayType = function () { Ei >= 4 && !wi && !Li && (us.TEST_VID.constructor.prototype.canPlayType = function (t) { return t && hs.test(t) ? "maybe" : cs.call(this, t) }) }, us.unpatchCanPlayType = function () { var t = us.TEST_VID.constructor.prototype.canPlayType; return us.TEST_VID.constructor.prototype.canPlayType = cs, t }, us.patchCanPlayType(), us.disposeMediaElement = function (t) { if (t) { for (t.parentNode && t.parentNode.removeChild(t); t.hasChildNodes();)t.removeChild(t.firstChild); t.removeAttribute("src"), "function" == typeof t.load && !function () { try { t.load() } catch (e) { } }() } }, us.resetMediaElement = function (t) { if (t) { for (var e = t.querySelectorAll("source"), i = e.length; i--;)t.removeChild(e[i]); t.removeAttribute("src"), "function" == typeof t.load && !function () { try { t.load() } catch (e) { } }() } }, ["muted", "defaultMuted", "autoplay", "controls", "loop", "playsinline"].forEach(function (t) { us.prototype[t] = function () { return this.el_[t] || this.el_.hasAttribute(t) } }), ["muted", "defaultMuted", "autoplay", "loop", "playsinline"].forEach(function (t) { us.prototype["set" + Q(t)] = function (e) { this.el_[t] = e, e ? this.el_.setAttribute(t, t) : this.el_.removeAttribute(t) } }), ["paused", "currentTime", "buffered", "volume", "poster", "preload", "error", "seeking", "seekable", "ended", "playbackRate", "defaultPlaybackRate", "played", "networkState", "readyState", "videoWidth", "videoHeight"].forEach(function (t) { us.prototype[t] = function () { return this.el_[t] } }), ["volume", "src", "poster", "preload", "playbackRate", "defaultPlaybackRate"].forEach(function (t) { us.prototype["set" + Q(t)] = function (e) { this.el_[t] = e } }), ["pause", "load", "play"].forEach(function (t) { us.prototype[t] = function () { return this.el_[t]() } }), Tn.withSourceHandlers(us), us.nativeSourceHandler = {}, us.nativeSourceHandler.canPlayType = function (t) { try { return us.TEST_VID.canPlayType(t) } catch (e) { return "" } }, us.nativeSourceHandler.canHandleSource = function (t, e) { if (t.type) return us.nativeSourceHandler.canPlayType(t.type); if (t.src) { var i = dr(t.src); return us.nativeSourceHandler.canPlayType("video/" + i) } return "" }, us.nativeSourceHandler.handleSource = function (t, e, i) { e.setSrc(t.src) }, us.nativeSourceHandler.dispose = function () { }, us.registerSourceHandler(us.nativeSourceHandler), Tn.registerTech("Html5", us); var ds = Ne(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "], ["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]), ps = ["progress", "abort", "suspend", "emptied", "stalled", "loadedmetadata", "loadeddata", "timeupdate", "resize", "volumechange", "texttrackchange"], fs = { canplay: "CanPlay", canplaythrough: "CanPlayThrough", playing: "Playing", seeked: "Seeked" }, ms = function (t) {
    function e(i, r, a) { if (Re(this, e), i.id = i.id || r.id || "vjs_video_" + B(), r = n(e.getTagSettings(i), r), r.initChildren = !1, r.createEl = !1, r.evented = !1, r.reportTouchActivity = !1, !r.language) if ("function" == typeof i.closest) { var s = i.closest("[lang]"); s && s.getAttribute && (r.language = s.getAttribute("lang")) } else for (var o = i; o && 1 === o.nodeType;) { if (k(o).hasOwnProperty("lang")) { r.language = o.getAttribute("lang"); break } o = o.parentNode } var u = Ue(this, t.call(this, null, r, a)); if (u.isPosterFromTech_ = !1, u.queuedCallbacks_ = [], u.isReady_ = !1, u.hasStarted_ = !1, u.userActive_ = !1, !u.options_ || !u.options_.techOrder || !u.options_.techOrder.length) throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?"); if (u.tag = i, u.tagAttributes = i && k(i), u.language(u.options_.language), r.languages) { var l = {}; Object.getOwnPropertyNames(r.languages).forEach(function (t) { l[t.toLowerCase()] = r.languages[t] }), u.languages_ = l } else u.languages_ = e.prototype.options_.languages; u.cache_ = {}, u.poster_ = r.poster || "", u.controls_ = !!r.controls, u.cache_.lastVolume = 1, i.controls = !1, i.removeAttribute("controls"), i.hasAttribute("autoplay") ? u.options_.autoplay = !0 : u.autoplay(u.options_.autoplay), u.scrubbing_ = !1, u.el_ = u.createEl(), u.cache_.lastPlaybackRate = u.defaultPlaybackRate(), K(u, { eventBusKey: "el_" }); var c = tt(u.options_); if (r.plugins) { var h = r.plugins; Object.keys(h).forEach(function (t) { if ("function" != typeof this[t]) throw new Error('plugin "' + t + '" does not exist'); this[t](h[t]) }, u) } u.options_.playerOptions = c, u.middleware_ = [], u.initChildren(), u.isAudio("audio" === i.nodeName.toLowerCase()), u.controls() ? u.addClass("vjs-controls-enabled") : u.addClass("vjs-controls-disabled"), u.el_.setAttribute("role", "region"), u.isAudio() ? u.el_.setAttribute("aria-label", u.localize("Audio Player")) : u.el_.setAttribute("aria-label", u.localize("Video Player")), u.isAudio() && u.addClass("vjs-audio"), u.flexNotSupported_() && u.addClass("vjs-no-flex"), Ti || u.addClass("vjs-workinghover"), e.players[u.id_] = u; var d = ve.split(".")[0]; return u.addClass("vjs-v" + d), u.userActive(!0), u.reportUserActivity(), u.one("play", u.listenForUserActivity_), u.on("fullscreenchange", u.handleFullscreenChange_), u.on("stageclick", u.handleStageClick_), u.changingSrc_ = !1, u.playWaitingForReady_ = !1, u.playOnLoadstart_ = null, u } return Me(e, t), e.prototype.dispose = function () { this.trigger("dispose"), this.off("dispose"), this.styleEl_ && this.styleEl_.parentNode && (this.styleEl_.parentNode.removeChild(this.styleEl_), this.styleEl_ = null), e.players[this.id_] = null, this.tag && this.tag.player && (this.tag.player = null), this.el_ && this.el_.player && (this.el_.player = null), this.tech_ && (this.tech_.dispose(), this.isPosterFromTech_ = !1, this.poster_ = ""), this.playerElIngest_ && (this.playerElIngest_ = null), this.tag && (this.tag = null), Qt(this), t.prototype.dispose.call(this) }, e.prototype.createEl = function () { var e = this.tag, i = void 0, r = this.playerElIngest_ = e.parentNode && e.parentNode.hasAttribute && e.parentNode.hasAttribute("data-vjs-player"), n = "video-js" === this.tag.tagName.toLowerCase(); r ? i = this.el_ = e.parentNode : n || (i = this.el_ = t.prototype.createEl.call(this, "div")); var a = k(e); if (n) { for (i = this.el_ = e, e = this.tag = we.createElement("video"); i.children.length;)e.appendChild(i.firstChild); v(i, "video-js") || _(i, "video-js"), i.appendChild(e), r = this.playerElIngest_ = i, Object.keys(i).forEach(function (t) { e[t] = i[t] }) } if (e.setAttribute("tabindex", "-1"), Oi && e.setAttribute("role", "application"), e.removeAttribute("width"), e.removeAttribute("height"), Object.getOwnPropertyNames(a).forEach(function (t) { n && "class" === t || i.setAttribute(t, a[t]), n && e.setAttribute(t, a[t]) }), e.playerId = e.id, e.id += "_html5_api", e.className = "vjs-tech", e.player = i.player = this, this.addClass("vjs-paused"), Te.VIDEOJS_NO_DYNAMIC_STYLE !== !0) { this.styleEl_ = Ze("vjs-styles-dimensions"); var s = He(".vjs-styles-defaults"), o = He("head"); o.insertBefore(this.styleEl_, s ? s.nextSibling : o.firstChild) } this.width(this.options_.width), this.height(this.options_.height), this.fluid(this.options_.fluid), this.aspectRatio(this.options_.aspectRatio); for (var u = e.getElementsByTagName("a"), l = 0; l < u.length; l++) { var c = u.item(l); _(c, "vjs-hidden"), c.setAttribute("hidden", "hidden") } return e.initNetworkState_ = e.networkState, e.parentNode && !r && e.parentNode.insertBefore(i, e), y(e, i), this.children_.unshift(e), this.el_.setAttribute("lang", this.language_), this.el_ = i, i }, e.prototype.width = function (t) { return this.dimension("width", t) }, e.prototype.height = function (t) { return this.dimension("height", t) }, e.prototype.dimension = function (t, e) { var i = t + "_"; if (void 0 === e) return this[i] || 0; if ("" === e) return this[i] = void 0, void this.updateStyleEl_(); var r = parseFloat(e); return isNaN(r) ? void Ie.error('Improper value "' + e + '" supplied for for ' + t) : (this[i] = r, void this.updateStyleEl_()) }, e.prototype.fluid = function (t) { return void 0 === t ? !!this.fluid_ : (this.fluid_ = !!t, t ? this.addClass("vjs-fluid") : this.removeClass("vjs-fluid"), void this.updateStyleEl_()) }, e.prototype.aspectRatio = function (t) { if (void 0 === t) return this.aspectRatio_; if (!/^\d+\:\d+$/.test(t)) throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9."); this.aspectRatio_ = t, this.fluid(!0), this.updateStyleEl_() }, e.prototype.updateStyleEl_ = function () { if (Te.VIDEOJS_NO_DYNAMIC_STYLE === !0) { var t = "number" == typeof this.width_ ? this.width_ : this.options_.width, e = "number" == typeof this.height_ ? this.height_ : this.options_.height, i = this.tech_ && this.tech_.el(); return void (i && (t >= 0 && (i.width = t), e >= 0 && (i.height = e))) } var r = void 0, n = void 0, a = void 0, s = void 0; a = void 0 !== this.aspectRatio_ && "auto" !== this.aspectRatio_ ? this.aspectRatio_ : this.videoWidth() > 0 ? this.videoWidth() + ":" + this.videoHeight() : "16:9"; var o = a.split(":"), u = o[1] / o[0]; r = void 0 !== this.width_ ? this.width_ : void 0 !== this.height_ ? this.height_ / u : this.videoWidth() || 300, n = void 0 !== this.height_ ? this.height_ : r * u, s = /^[^a-zA-Z]/.test(this.id()) ? "dimensions-" + this.id() : this.id() + "-dimensions", this.addClass(s), ti(this.styleEl_, "\n      ." + s + " {\n        width: " + r + "px;\n        height: " + n + "px;\n      }\n\n      ." + s + ".vjs-fluid {\n        padding-top: " + 100 * u + "%;\n      }\n    ") }, e.prototype.loadTech_ = function (t, e) { var i = this; this.tech_ && this.unloadTech_(); var r = Q(t), a = t.charAt(0).toLowerCase() + t.slice(1); "Html5" !== r && this.tag && (Tn.getTech("Html5").disposeMediaElement(this.tag), this.tag.player = null, this.tag = null), this.techName_ = r, this.isReady_ = !1; var s = "string" == typeof this.autoplay() ? !1 : this.autoplay(), o = { source: e, autoplay: s, nativeControlsForTouch: this.options_.nativeControlsForTouch, playerId: this.id(), techId: this.id() + "_" + r + "_api", playsinline: this.options_.playsinline, preload: this.options_.preload, loop: this.options_.loop, muted: this.options_.muted, poster: this.poster(), language: this.language(), playerElIngest: this.playerElIngest_ || !1, "vtt.js": this.options_["vtt.js"], canOverridePoster: !!this.options_.techCanOverridePoster, enableSourceset: this.options_.enableSourceset }; Kr.names.forEach(function (t) { var e = Kr[t]; o[e.getterName] = i[e.privateName] }), n(o, this.options_[r]), n(o, this.options_[a]), n(o, this.options_[t.toLowerCase()]), this.tag && (o.tag = this.tag), e && e.src === this.cache_.src && this.cache_.currentTime > 0 && (o.startTime = this.cache_.currentTime); var u = Tn.getTech(t); if (!u) throw new Error("No Tech named '" + r + "' exists! '" + r + "' should be registered using videojs.registerTech()'"); this.tech_ = new u(o), this.tech_.ready(ei(this, this.handleTechReady_), !0), Gi.jsonToTextTracks(this.textTracksJson_ || [], this.tech_), ps.forEach(function (t) { i.on(i.tech_, t, i["handleTech" + Q(t) + "_"]) }), Object.keys(fs).forEach(function (t) { i.on(i.tech_, t, function (e) { return 0 === i.tech_.playbackRate() && i.tech_.seeking() ? void i.queuedCallbacks_.push({ callback: i["handleTech" + fs[t] + "_"].bind(i), event: e }) : void i["handleTech" + fs[t] + "_"](e) }) }), this.on(this.tech_, "loadstart", this.handleTechLoadStart_), this.on(this.tech_, "sourceset", this.handleTechSourceset_), this.on(this.tech_, "waiting", this.handleTechWaiting_), this.on(this.tech_, "ended", this.handleTechEnded_), this.on(this.tech_, "seeking", this.handleTechSeeking_), this.on(this.tech_, "play", this.handleTechPlay_), this.on(this.tech_, "firstplay", this.handleTechFirstPlay_), this.on(this.tech_, "pause", this.handleTechPause_), this.on(this.tech_, "durationchange", this.handleTechDurationChange_), this.on(this.tech_, "fullscreenchange", this.handleTechFullscreenChange_), this.on(this.tech_, "error", this.handleTechError_), this.on(this.tech_, "loadedmetadata", this.updateStyleEl_), this.on(this.tech_, "posterchange", this.handleTechPosterChange_), this.on(this.tech_, "textdata", this.handleTechTextData_), this.on(this.tech_, "ratechange", this.handleTechRateChange_), this.usingNativeControls(this.techGet_("controls")), this.controls() && !this.usingNativeControls() && this.addTechControlsListeners_(), this.tech_.el().parentNode === this.el() || "Html5" === r && this.tag || y(this.tech_.el(), this.el()), this.tag && (this.tag.player = null, this.tag = null) }, e.prototype.unloadTech_ = function () { var t = this; Kr.names.forEach(function (e) { var i = Kr[e]; t[i.privateName] = t[i.getterName]() }), this.textTracksJson_ = Gi.textTracksToJson(this.tech_), this.isReady_ = !1, this.tech_.dispose(), this.tech_ = !1, this.isPosterFromTech_ && (this.poster_ = "", this.trigger("posterchange")), this.isPosterFromTech_ = !1 }, e.prototype.tech = function (t) { return void 0 === t && Ie.warn(xe(ds)), this.tech_ }, e.prototype.addTechControlsListeners_ = function () { this.removeTechControlsListeners_(), this.on(this.tech_, "mousedown", this.handleTechClick_), this.on(this.tech_, "dblclick", this.handleTechDoubleClick_), this.on(this.tech_, "touchstart", this.handleTechTouchStart_), this.on(this.tech_, "touchmove", this.handleTechTouchMove_), this.on(this.tech_, "touchend", this.handleTechTouchEnd_), this.on(this.tech_, "tap", this.handleTechTap_) }, e.prototype.removeTechControlsListeners_ = function () { this.off(this.tech_, "tap", this.handleTechTap_), this.off(this.tech_, "touchstart", this.handleTechTouchStart_), this.off(this.tech_, "touchmove", this.handleTechTouchMove_), this.off(this.tech_, "touchend", this.handleTechTouchEnd_), this.off(this.tech_, "mousedown", this.handleTechClick_), this.off(this.tech_, "dblclick", this.handleTechDoubleClick_) }, e.prototype.handleTechReady_ = function () { this.triggerReady(), this.cache_.volume && this.techCall_("setVolume", this.cache_.volume), this.handleTechPosterChange_(), this.handleTechDurationChange_() }, e.prototype.handleTechLoadStart_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-seeking"), this.error(null), this.paused() ? (this.hasStarted(!1), this.trigger("loadstart")) : (this.trigger("loadstart"), this.trigger("firstplay")), this.manualAutoplay_(this.autoplay()) }, e.prototype.manualAutoplay_ = function (t) { var e = this; if (this.tech_ && "string" == typeof t) { var i = function () { var t = e.muted(); e.muted(!0); var i = e.play(); if (i && i.then && i["catch"]) return i["catch"](function (i) { e.muted(t) }) }, r = void 0; if ("any" === t ? (r = this.play(), r && r.then && r["catch"] && r["catch"](function () { return i() })) : r = "muted" === t ? i() : this.play(), r && r.then && r["catch"]) return r.then(function () { e.trigger({ type: "autoplay-success", autoplay: t }) })["catch"](function (i) { e.trigger({ type: "autoplay-failure", autoplay: t }) }) } }, e.prototype.updateSourceCaches_ = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", e = t, i = ""; "string" != typeof e && (e = t.src, i = t.type), this.cache_.source = this.cache_.source || {}, this.cache_.sources = this.cache_.sources || [], e && !i && (i = On(this, e)), this.cache_.source = tt({}, t, { src: e, type: i }); for (var r = this.cache_.sources.filter(function (t) { return t.src && t.src === e }), n = [], a = this.$$("source"), s = [], o = 0; o < a.length; o++) { var u = k(a[o]); n.push(u), u.src && u.src === e && s.push(u.src) } s.length && !r.length ? this.cache_.sources = n : r.length || (this.cache_.sources = [this.cache_.source]), this.cache_.src = e }, e.prototype.handleTechSourceset_ = function (t) { var e = this; if (!this.changingSrc_ && (this.updateSourceCaches_(t.src), !t.src)) { var i = function r(t) { "sourceset" !== t.type && e.updateSourceCaches_(e.techGet_("currentSrc")), e.tech_.off(["sourceset", "loadstart"], r) }; this.tech_.one(["sourceset", "loadstart"], i) } this.trigger({ src: t.src, type: "sourceset" }) }, e.prototype.hasStarted = function (t) { return void 0 === t ? this.hasStarted_ : void (t !== this.hasStarted_ && (this.hasStarted_ = t, this.hasStarted_ ? (this.addClass("vjs-has-started"), this.trigger("firstplay")) : this.removeClass("vjs-has-started"))) }, e.prototype.handleTechPlay_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.hasStarted(!0), this.trigger("play") }, e.prototype.handleTechRateChange_ = function () { this.tech_.playbackRate() > 0 && 0 === this.cache_.lastPlaybackRate && (this.queuedCallbacks_.forEach(function (t) { return t.callback(t.event) }), this.queuedCallbacks_ = []), this.cache_.lastPlaybackRate = this.tech_.playbackRate(), this.trigger("ratechange") }, e.prototype.handleTechWaiting_ = function () { var t = this; this.addClass("vjs-waiting"), this.trigger("waiting"), this.one("timeupdate", function () { return t.removeClass("vjs-waiting") }) }, e.prototype.handleTechCanPlay_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplay") }, e.prototype.handleTechCanPlayThrough_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplaythrough") }, e.prototype.handleTechPlaying_ = function () { this.removeClass("vjs-waiting"), this.trigger("playing") }, e.prototype.handleTechSeeking_ = function () { this.addClass("vjs-seeking"), this.trigger("seeking") }, e.prototype.handleTechSeeked_ = function () { this.removeClass("vjs-seeking"), this.trigger("seeked") }, e.prototype.handleTechFirstPlay_ = function () { this.options_.starttime && (Ie.warn("Passing the `starttime` option to the player will be deprecated in 6.0"), this.currentTime(this.options_.starttime)), this.addClass("vjs-has-started"), this.trigger("firstplay") }, e.prototype.handleTechPause_ = function () { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.trigger("pause") }, e.prototype.handleTechEnded_ = function () { this.addClass("vjs-ended"), this.options_.loop ? (this.currentTime(0), this.play()) : this.paused() || this.pause(), this.trigger("ended") }, e.prototype.handleTechDurationChange_ = function () { this.duration(this.techGet_("duration")) }, e.prototype.handleTechClick_ = function (t) { N(t) && this.controls_ && (this.paused() ? lt(this.play()) : this.pause()) }, e.prototype.handleTechDoubleClick_ = function (t) { if (this.controls_) { var e = Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"), function (e) { return e.contains(t.target) }); e || (this.isFullscreen() ? this.exitFullscreen() : this.requestFullscreen()) } }, e.prototype.handleTechTap_ = function () { this.userActive(!this.userActive()) }, e.prototype.handleTechTouchStart_ = function () { this.userWasActive = this.userActive() }, e.prototype.handleTechTouchMove_ = function () { this.userWasActive && this.reportUserActivity() }, e.prototype.handleTechTouchEnd_ = function (t) { t.preventDefault() }, e.prototype.handleFullscreenChange_ = function () { this.isFullscreen() ? this.addClass("vjs-fullscreen") : this.removeClass("vjs-fullscreen") }, e.prototype.handleStageClick_ = function () { this.reportUserActivity() }, e.prototype.handleTechFullscreenChange_ = function (t, e) { e && this.isFullscreen(e.isFullscreen), this.trigger("fullscreenchange") }, e.prototype.handleTechError_ = function () { var t = this.tech_.error(); this.error(t) }, e.prototype.handleTechTextData_ = function () { var t = null; arguments.length > 1 && (t = arguments[1]), this.trigger("textdata", t) }, e.prototype.getCache = function () { return this.cache_ }, e.prototype.techCall_ = function (t, e) { this.ready(function () { if (t in wn) return Yt(this.middleware_, this.tech_, t, e); if (t in An) return $t(this.middleware_, this.tech_, t, e); try { this.tech_ && this.tech_[t](e) } catch (i) { throw Ie(i), i } }, !0) }, e.prototype.techGet_ = function (t) { if (this.tech_ && this.tech_.isReady_) { if (t in Cn) return Xt(this.middleware_, this.tech_, t); if (t in An) return $t(this.middleware_, this.tech_, t); try { return this.tech_[t]() } catch (e) { if (void 0 === this.tech_[t]) throw Ie("Video.js: " + t + " method not defined for " + this.techName_ + " playback technology.", e), e; if ("TypeError" === e.name) throw Ie("Video.js: " + t + " unavailable on " + this.techName_ + " playback technology element.", e), this.tech_.isReady_ = !1, e; throw Ie(e), e } } }, e.prototype.play = function () { var t = this; if (this.playOnLoadstart_ && this.off("loadstart", this.playOnLoadstart_), this.isReady_) { if (!this.changingSrc_ && (this.src() || this.currentSrc())) return this.techGet_("play"); this.playOnLoadstart_ = function () { t.playOnLoadstart_ = null, lt(t.play()) }, this.one("loadstart", this.playOnLoadstart_) } else { if (this.playWaitingForReady_) return; this.playWaitingForReady_ = !0, this.ready(function () { t.playWaitingForReady_ = !1, lt(t.play()) }) } }, e.prototype.pause = function () { this.techCall_("pause") }, e.prototype.paused = function () { return this.techGet_("paused") === !1 ? !1 : !0 }, e.prototype.played = function () { return this.techGet_("played") || nt(0, 0) }, e.prototype.scrubbing = function (t) { return "undefined" == typeof t ? this.scrubbing_ : (this.scrubbing_ = !!t, void (t ? this.addClass("vjs-scrubbing") : this.removeClass("vjs-scrubbing"))) }, e.prototype.currentTime = function (t) { return "undefined" != typeof t ? (0 > t && (t = 0), void this.techCall_("setCurrentTime", t)) : (this.cache_.currentTime = this.techGet_("currentTime") || 0, this.cache_.currentTime) }, e.prototype.duration = function (t) { return void 0 === t ? void 0 !== this.cache_.duration ? this.cache_.duration : NaN : (t = parseFloat(t), 0 > t && (t = 1 / 0), void (t !== this.cache_.duration && (this.cache_.duration = t, t === 1 / 0 ? this.addClass("vjs-live") : this.removeClass("vjs-live"), this.trigger("durationchange")))) }, e.prototype.remainingTime = function () { return this.duration() - this.currentTime() }, e.prototype.remainingTimeDisplay = function () { return Math.floor(this.duration()) - Math.floor(this.currentTime()) }, e.prototype.buffered = function i() { var i = this.techGet_("buffered"); return i && i.length || (i = nt(0, 0)), i }, e.prototype.bufferedPercent = function () { return at(this.buffered(), this.duration()) }, e.prototype.bufferedEnd = function () { var t = this.buffered(), e = this.duration(), i = t.end(t.length - 1); return i > e && (i = e), i }, e.prototype.volume = function (t) { var e = void 0; return void 0 !== t ? (e = Math.max(0, Math.min(1, parseFloat(t))), this.cache_.volume = e, this.techCall_("setVolume", e), void (e > 0 && this.lastVolume_(e))) : (e = parseFloat(this.techGet_("volume")), isNaN(e) ? 1 : e) }, e.prototype.muted = function (t) { return void 0 !== t ? void this.techCall_("setMuted", t) : this.techGet_("muted") || !1 }, e.prototype.defaultMuted = function (t) { return void 0 !== t ? this.techCall_("setDefaultMuted", t) : this.techGet_("defaultMuted") || !1 }, e.prototype.lastVolume_ = function (t) { return void 0 !== t && 0 !== t ? void (this.cache_.lastVolume = t) : this.cache_.lastVolume }, e.prototype.supportsFullScreen = function () { return this.techGet_("supportsFullScreen") || !1 }, e.prototype.isFullscreen = function (t) { return void 0 !== t ? void (this.isFullscreen_ = !!t) : !!this.isFullscreen_ }, e.prototype.requestFullscreen = function () { var t = Mi; this.isFullscreen(!0), t.requestFullscreen ? (z(we, t.fullscreenchange, ei(this, function e(i) { this.isFullscreen(we[t.fullscreenElement]), this.isFullscreen() === !1 && G(we, t.fullscreenchange, e), this.trigger("fullscreenchange") })), this.el_[t.requestFullscreen]()) : this.tech_.supportsFullScreen() ? this.techCall_("enterFullScreen") : (this.enterFullWindow(), this.trigger("fullscreenchange")) }, e.prototype.exitFullscreen = function () { var t = Mi; this.isFullscreen(!1), t.requestFullscreen ? we[t.exitFullscreen]() : this.tech_.supportsFullScreen() ? this.techCall_("exitFullScreen") : (this.exitFullWindow(), this.trigger("fullscreenchange")) }, e.prototype.enterFullWindow = function () { this.isFullWindow = !0, this.docOrigOverflow = we.documentElement.style.overflow, z(we, "keydown", ei(this, this.fullWindowOnEscKey)), we.documentElement.style.overflow = "hidden", _(we.body, "vjs-full-window"), this.trigger("enterFullWindow") }, e.prototype.fullWindowOnEscKey = function (t) { 27 === t.keyCode && (this.isFullscreen() === !0 ? this.exitFullscreen() : this.exitFullWindow()) }, e.prototype.exitFullWindow = function () { this.isFullWindow = !1, G(we, "keydown", this.fullWindowOnEscKey), we.documentElement.style.overflow = this.docOrigOverflow, b(we.body, "vjs-full-window"), this.trigger("exitFullWindow") }, e.prototype.canPlayType = function (t) { for (var e = void 0, i = 0, r = this.options_.techOrder; i < r.length; i++) { var n = r[i], a = Tn.getTech(n); if (a || (a = fi.getComponent(n)), a) { if (a.isSupported() && (e = a.canPlayType(t))) return e } else Ie.error('The "' + n + '" tech is undefined. Skipped browser support check for that tech.') } return "" }, e.prototype.selectSource = function (t) { var e = this, i = this.options_.techOrder.map(function (t) { return [t, Tn.getTech(t)] }).filter(function (t) { var e = t[0], i = t[1]; return i ? i.isSupported() : (Ie.error('The "' + e + '" tech is undefined. Skipped browser support check for that tech.'), !1) }), r = function (t, e, i) { var r = void 0; return t.some(function (t) { return e.some(function (e) { return r = i(t, e), r ? !0 : void 0 }) }), r }, n = void 0, a = function (t) { return function (e, i) { return t(i, e) } }, s = function (t, i) { var r = t[0], n = t[1]; return n.canPlaySource(i, e.options_[r.toLowerCase()]) ? { source: i, tech: r } : void 0 }; return n = this.options_.sourceOrder ? r(t, i, a(s)) : r(i, t, s), n || !1 }, e.prototype.src = function (t) { var e = this; if ("undefined" == typeof t) return this.cache_.src || ""; var i = In(t); return i.length ? (this.changingSrc_ = !0, this.cache_.sources = i, this.updateSourceCaches_(i[0]), void zt(this, i[0], function (t, r) { e.middleware_ = r, e.cache_.sources = i, e.updateSourceCaches_(t); var n = e.src_(t); return n ? i.length > 1 ? e.src(i.slice(1)) : (e.changingSrc_ = !1, e.setTimeout(function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }, 0), void e.triggerReady()) : void Gt(r, e.tech_) })) : void this.setTimeout(function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }, 0) }, e.prototype.src_ = function (t) { var e = this, i = this.selectSource([t]); return i ? Z(i.tech, this.techName_) ? (this.ready(function () { this.tech_.constructor.prototype.hasOwnProperty("setSource") ? this.techCall_("setSource", t) : this.techCall_("src", t.src), this.changingSrc_ = !1 }, !0), !1) : (this.changingSrc_ = !0, this.loadTech_(i.tech, i.source), this.tech_.ready(function () { e.changingSrc_ = !1 }), !1) : !0 }, e.prototype.load = function () { this.techCall_("load") }, e.prototype.reset = function () { this.loadTech_(this.options_.techOrder[0], null), this.techCall_("reset") }, e.prototype.currentSources = function () { var t = this.currentSource(), e = []; return 0 !== Object.keys(t).length && e.push(t), this.cache_.sources || e }, e.prototype.currentSource = function () { return this.cache_.source || {} }, e.prototype.currentSrc = function () { return this.currentSource() && this.currentSource().src || "" }, e.prototype.currentType = function () { return this.currentSource() && this.currentSource().type || "" }, e.prototype.preload = function (t) { return void 0 !== t ? (this.techCall_("setPreload", t), void (this.options_.preload = t)) : this.techGet_("preload") }, e.prototype.autoplay = function (t) { if (void 0 === t) return this.options_.autoplay || !1; var e = void 0; "string" == typeof t && /(any|play|muted)/.test(t) ? (this.options_.autoplay = t, this.manualAutoplay_(t), e = !1) : t ? this.options_.autoplay = !0 : this.options_.autoplay = !1, e = e || this.options_.autoplay, this.tech_ && this.techCall_("setAutoplay", e) }, e.prototype.playsinline = function (t) { return void 0 !== t ? (this.techCall_("setPlaysinline", t), this.options_.playsinline = t, this) : this.techGet_("playsinline") }, e.prototype.loop = function (t) { return void 0 !== t ? (this.techCall_("setLoop", t), void (this.options_.loop = t)) : this.techGet_("loop") }, e.prototype.poster = function (t) { return void 0 === t ? this.poster_ : (t || (t = ""), void (t !== this.poster_ && (this.poster_ = t, this.techCall_("setPoster", t), this.isPosterFromTech_ = !1, this.trigger("posterchange")))) }, e.prototype.handleTechPosterChange_ = function () { if ((!this.poster_ || this.options_.techCanOverridePoster) && this.tech_ && this.tech_.poster) { var t = this.tech_.poster() || ""; t !== this.poster_ && (this.poster_ = t, this.isPosterFromTech_ = !0, this.trigger("posterchange")) } }, e.prototype.controls = function (t) { return void 0 === t ? !!this.controls_ : (t = !!t, void (this.controls_ !== t && (this.controls_ = t, this.usingNativeControls() && this.techCall_("setControls", t), this.controls_ ? (this.removeClass("vjs-controls-disabled"), this.addClass("vjs-controls-enabled"), this.trigger("controlsenabled"), this.usingNativeControls() || this.addTechControlsListeners_()) : (this.removeClass("vjs-controls-enabled"), this.addClass("vjs-controls-disabled"), this.trigger("controlsdisabled"), this.usingNativeControls() || this.removeTechControlsListeners_())))) }, e.prototype.usingNativeControls = function (t) { return void 0 === t ? !!this.usingNativeControls_ : (t = !!t, void (this.usingNativeControls_ !== t && (this.usingNativeControls_ = t, this.usingNativeControls_ ? (this.addClass("vjs-using-native-controls"), this.trigger("usingnativecontrols")) : (this.removeClass("vjs-using-native-controls"), this.trigger("usingcustomcontrols"))))) }, e.prototype.error = function (t) { return void 0 === t ? this.error_ || null : null === t ? (this.error_ = t, this.removeClass("vjs-error"), void (this.errorDisplay && this.errorDisplay.close())) : (this.error_ = new st(t), this.addClass("vjs-error"), Ie.error("(CODE:" + this.error_.code + " " + st.errorTypes[this.error_.code] + ")", this.error_.message, this.error_), void this.trigger("error")) }, e.prototype.reportUserActivity = function (t) { this.userActivity_ = !0 }, e.prototype.userActive = function (t) { if (void 0 === t) return this.userActive_; if (t = !!t, t !== this.userActive_) { if (this.userActive_ = t, this.userActive_) return this.userActivity_ = !0, this.removeClass("vjs-user-inactive"), this.addClass("vjs-user-active"), void this.trigger("useractive"); this.tech_ && this.tech_.one("mousemove", function (t) { t.stopPropagation(), t.preventDefault() }), this.userActivity_ = !1, this.removeClass("vjs-user-active"), this.addClass("vjs-user-inactive"), this.trigger("userinactive") } }, e.prototype.listenForUserActivity_ = function () {
      var t = void 0, e = void 0, i = void 0, r = ei(this, this.reportUserActivity), n = function (t) { (t.screenX !== e || t.screenY !== i) && (e = t.screenX, i = t.screenY, r()) }, a = function () { r(), this.clearInterval(t), t = this.setInterval(r, 250) }, s = function (e) { r(), this.clearInterval(t) }; this.on("mousedown", a), this.on("mousemove", n),
        this.on("mouseup", s), this.on("keydown", r), this.on("keyup", r); var o = void 0; this.setInterval(function () { if (this.userActivity_) { this.userActivity_ = !1, this.userActive(!0), this.clearTimeout(o); var t = this.options_.inactivityTimeout; 0 >= t || (o = this.setTimeout(function () { this.userActivity_ || this.userActive(!1) }, t)) } }, 250)
    }, e.prototype.playbackRate = function (t) { return void 0 !== t ? void this.techCall_("setPlaybackRate", t) : this.tech_ && this.tech_.featuresPlaybackRate ? this.cache_.lastPlaybackRate || this.techGet_("playbackRate") : 1 }, e.prototype.defaultPlaybackRate = function (t) { return void 0 !== t ? this.techCall_("setDefaultPlaybackRate", t) : this.tech_ && this.tech_.featuresPlaybackRate ? this.techGet_("defaultPlaybackRate") : 1 }, e.prototype.isAudio = function (t) { return void 0 !== t ? void (this.isAudio_ = !!t) : !!this.isAudio_ }, e.prototype.addTextTrack = function (t, e, i) { return this.tech_ ? this.tech_.addTextTrack(t, e, i) : void 0 }, e.prototype.addRemoteTextTrack = function (t, e) { return this.tech_ ? this.tech_.addRemoteTextTrack(t, e) : void 0 }, e.prototype.removeRemoteTextTrack = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, e = t.track, i = void 0 === e ? arguments[0] : e; return this.tech_ ? this.tech_.removeRemoteTextTrack(i) : void 0 }, e.prototype.getVideoPlaybackQuality = function () { return this.techGet_("getVideoPlaybackQuality") }, e.prototype.videoWidth = function () { return this.tech_ && this.tech_.videoWidth && this.tech_.videoWidth() || 0 }, e.prototype.videoHeight = function () { return this.tech_ && this.tech_.videoHeight && this.tech_.videoHeight() || 0 }, e.prototype.language = function (t) { return void 0 === t ? this.language_ : void (this.language_ = String(t).toLowerCase()) }, e.prototype.languages = function () { return tt(e.prototype.options_.languages, this.languages_) }, e.prototype.toJSON = function () { var t = tt(this.options_), e = t.tracks; t.tracks = []; for (var i = 0; i < e.length; i++) { var r = e[i]; r = tt(r), r.player = void 0, t.tracks[i] = r } return t }, e.prototype.createModal = function (t, e) { var i = this; e = e || {}, e.content = t || ""; var r = new $i(this, e); return this.addChild(r), r.on("dispose", function () { i.removeChild(r) }), r.open(), r }, e.getTagSettings = function (t) { var e = { sources: [], tracks: [] }, i = k(t), r = i["data-setup"]; if (v(t, "vjs-fluid") && (i.fluid = !0), null !== r) { var a = Vi(r || "{}"), s = a[0], o = a[1]; s && Ie.error(s), n(i, o) } if (n(e, i), t.hasChildNodes()) for (var u = t.childNodes, l = 0, c = u.length; c > l; l++) { var h = u[l], d = h.nodeName.toLowerCase(); "source" === d ? e.sources.push(k(h)) : "track" === d && e.tracks.push(k(h)) } return e }, e.prototype.flexNotSupported_ = function () { var t = we.createElement("i"); return !("flexBasis" in t.style || "webkitFlexBasis" in t.style || "mozFlexBasis" in t.style || "msFlexBasis" in t.style || "msFlexOrder" in t.style) }, e
  }(fi); Kr.names.forEach(function (t) { var e = Kr[t]; ms.prototype[e.getterName] = function () { return this.tech_ ? this.tech_[e.getterName]() : (this[e.privateName] = this[e.privateName] || new e.ListClass, this[e.privateName]) } }), ms.players = {}; var gs = Te.navigator; ms.prototype.options_ = { techOrder: Tn.defaultTechOrder_, html5: {}, flash: {}, inactivityTimeout: 2e3, playbackRates: [], children: ["mediaLoader", "posterImage", "textTrackDisplay", "loadingSpinner", "bigPlayButton", "controlBar", "errorDisplay", "textTrackSettings", "resizeManager"], language: gs && (gs.languages && gs.languages[0] || gs.userLanguage || gs.language) || "en", languages: {}, notSupportedMessage: "No compatible source was found for this media." }, ["ended", "seeking", "seekable", "networkState", "readyState"].forEach(function (t) { ms.prototype[t] = function () { return this.techGet_(t) } }), ps.forEach(function (t) { ms.prototype["handleTech" + Q(t) + "_"] = function () { return this.trigger(t) } }), fi.registerComponent("Player", ms); var ys = "plugin", vs = "activePlugins_", _s = {}, bs = function (t) { return _s.hasOwnProperty(t) }, Ts = function (t) { return bs(t) ? _s[t] : void 0 }, Ss = function (t, e) { t[vs] = t[vs] || {}, t[vs][e] = !0 }, ks = function (t, e, i) { var r = (i ? "before" : "") + "pluginsetup"; t.trigger(r, e), t.trigger(r + ":" + e.name, e) }, Es = function (t, e) { var i = function () { ks(this, { name: t, plugin: e, instance: null }, !0); var i = e.apply(this, arguments); return Ss(this, t), ks(this, { name: t, plugin: e, instance: i }), i }; return Object.keys(e).forEach(function (t) { i[t] = e[t] }), i }, Cs = function (t, e) { return e.prototype.name = t, function () { ks(this, { name: t, plugin: e, instance: null }, !0); for (var i = arguments.length, r = Array(i), n = 0; i > n; n++)r[n] = arguments[n]; var a = new (Function.prototype.bind.apply(e, [null].concat([this].concat(r)))); return this[t] = function () { return a }, ks(this, a.getEventHash()), a } }, ws = function () { function t(e) { if (Re(this, t), this.constructor === t) throw new Error("Plugin must be sub-classed; not directly instantiated."); this.player = e, K(this), delete this.trigger, J(this, this.constructor.defaultState), Ss(e, this.name), this.dispose = ei(this, this.dispose), e.on("dispose", this.dispose) } return t.prototype.version = function () { return this.constructor.VERSION }, t.prototype.getEventHash = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return t.name = this.name, t.plugin = this.constructor, t.instance = this, t }, t.prototype.trigger = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return X(this.eventBusEl_, t, this.getEventHash(e)) }, t.prototype.handleStateChanged = function (t) { }, t.prototype.dispose = function () { var t = this.name, e = this.player; this.trigger("dispose"), this.off(), e.off("dispose", this.dispose), e[vs][t] = !1, this.player = this.state = null, e[t] = Cs(t, _s[t]) }, t.isBasic = function (e) { var i = "string" == typeof e ? Ts(e) : e; return "function" == typeof i && !t.prototype.isPrototypeOf(i.prototype) }, t.registerPlugin = function (e, i) { if ("string" != typeof e) throw new Error('Illegal plugin name, "' + e + '", must be a string, was ' + ("undefined" == typeof e ? "undefined" : De(e)) + "."); if (bs(e)) Ie.warn('A plugin named "' + e + '" already exists. You may want to avoid re-registering plugins!'); else if (ms.prototype.hasOwnProperty(e)) throw new Error('Illegal plugin name, "' + e + '", cannot share a name with an existing player method!'); if ("function" != typeof i) throw new Error('Illegal plugin for "' + e + '", must be a function, was ' + ("undefined" == typeof i ? "undefined" : De(i)) + "."); return _s[e] = i, e !== ys && (t.isBasic(i) ? ms.prototype[e] = Es(e, i) : ms.prototype[e] = Cs(e, i)), i }, t.deregisterPlugin = function (t) { if (t === ys) throw new Error("Cannot de-register base plugin."); bs(t) && (delete _s[t], delete ms.prototype[t]) }, t.getPlugins = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : Object.keys(_s), e = void 0; return t.forEach(function (t) { var i = Ts(t); i && (e = e || {}, e[t] = i) }), e }, t.getPluginVersion = function (t) { var e = Ts(t); return e && e.VERSION || "" }, t }(); ws.getPlugin = Ts, ws.BASE_PLUGIN_NAME = ys, ws.registerPlugin(ys, ws), ms.prototype.usingPlugin = function (t) { return !!this[vs] && this[vs][t] === !0 }, ms.prototype.hasPlugin = function (t) { return !!bs(t) }; var As = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + ("undefined" == typeof e ? "undefined" : De(e))); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (t.super_ = e) }, Ls = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = function () { t.apply(this, arguments) }, r = {}; "object" === ("undefined" == typeof e ? "undefined" : De(e)) ? (e.constructor !== Object.prototype.constructor && (i = e.constructor), r = e) : "function" == typeof e && (i = e), As(i, t); for (var n in r) r.hasOwnProperty(n) && (i.prototype[n] = r[n]); return i }, Ps = function (t) { return 0 === t.indexOf("#") ? t.slice(1) : t }; if (ce.hooks_ = {}, ce.hooks = function (t, e) { return ce.hooks_[t] = ce.hooks_[t] || [], e && (ce.hooks_[t] = ce.hooks_[t].concat(e)), ce.hooks_[t] }, ce.hook = function (t, e) { ce.hooks(t, e) }, ce.hookOnce = function (t, e) { ce.hooks(t, [].concat(e).map(function (e) { var i = function r() { return ce.removeHook(t, r), e.apply(void 0, arguments) }; return i })) }, ce.removeHook = function (t, e) { var i = ce.hooks(t).indexOf(e); return -1 >= i ? !1 : (ce.hooks_[t] = ce.hooks_[t].slice(), ce.hooks_[t].splice(i, 1), !0) }, Te.VIDEOJS_NO_DYNAMIC_STYLE !== !0 && h()) { var Os = He(".vjs-styles-defaults"); if (!Os) { Os = Ze("vjs-styles-defaults"); var Is = He("head"); Is && Is.insertBefore(Os, Is.firstChild), ti(Os, "\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ") } } $(1, ce), ce.VERSION = ve, ce.options = ms.prototype.options_, ce.getPlayers = function () { return ms.players }, ce.getPlayer = function (t) { var e = ms.players, i = void 0; if ("string" == typeof t) { var r = Ps(t), n = e[r]; if (n) return n; i = He("#" + r) } else i = t; if (d(i)) { var a = i, s = a.player, o = a.playerId; if (s || e[o]) return s || e[o] } }, ce.getAllPlayers = function () { return Object.keys(ms.players).map(function (t) { return ms.players[t] }).filter(Boolean) }, ce.players = ms.players, ce.getComponent = fi.getComponent, ce.registerComponent = function (t, e) { Tn.isTech(e) && Ie.warn("The " + t + " tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"), fi.registerComponent.call(fi, t, e) }, ce.getTech = Tn.getTech, ce.registerTech = Tn.registerTech, ce.use = Wt, Object.defineProperty(ce, "middleware", { value: {}, writeable: !1, enumerable: !0 }), Object.defineProperty(ce.middleware, "TERMINATOR", { value: En, writeable: !1, enumerable: !0 }), ce.browser = Ri, ce.TOUCH_ENABLED = Di, ce.extend = Ls, ce.mergeOptions = tt, ce.bind = ei, ce.registerPlugin = ws.registerPlugin, ce.plugin = function (t, e) { return Ie.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"), ws.registerPlugin(t, e) }, ce.getPlugins = ws.getPlugins, ce.getPlugin = ws.getPlugin, ce.getPluginVersion = ws.getPluginVersion, ce.addLanguage = function (t, e) { var i; return t = ("" + t).toLowerCase(), ce.options.languages = tt(ce.options.languages, (i = {}, i[t] = e, i)), ce.options.languages[t] }, ce.log = Ie, ce.createTimeRange = ce.createTimeRanges = nt, ce.formatTime = se, ce.setFormatTime = ne, ce.resetFormatTime = ae, ce.parseUrl = cr, ce.isCrossOrigin = pr, ce.EventTarget = ni, ce.on = z, ce.one = Y, ce.off = G, ce.trigger = X, ce.xhr = Nr, ce.TextTrack = Fr, ce.AudioTrack = Hr, ce.VideoTrack = Vr, ["isEl", "isTextNode", "createEl", "hasClass", "addClass", "removeClass", "toggleClass", "setAttributes", "getAttributes", "emptyEl", "appendContent", "insertContent"].forEach(function (t) { ce[t] = function () { return Ie.warn("videojs." + t + "() is deprecated; use videojs.dom." + t + "() instead"), qe[t].apply(null, arguments) } }), ce.computedStyle = o, ce.dom = qe, ce.url = fr; var xs, Ds, Rs, Ms, Us = t(function (t, e) { !function (e) { var i = /^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/, r = /^([^\/;?#]*)(.*)$/, n = /(?:\/|^)\.(?=\/)/g, a = /(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g, s = { buildAbsoluteURL: function (t, e, i) { if (i = i || {}, t = t.trim(), e = e.trim(), !e) { if (!i.alwaysNormalize) return t; var n = s.parseURL(t); if (!n) throw new Error("Error trying to parse base URL."); return n.path = s.normalizePath(n.path), s.buildURLFromParts(n) } var a = s.parseURL(e); if (!a) throw new Error("Error trying to parse relative URL."); if (a.scheme) return i.alwaysNormalize ? (a.path = s.normalizePath(a.path), s.buildURLFromParts(a)) : e; var o = s.parseURL(t); if (!o) throw new Error("Error trying to parse base URL."); if (!o.netLoc && o.path && "/" !== o.path[0]) { var u = r.exec(o.path); o.netLoc = u[1], o.path = u[2] } o.netLoc && !o.path && (o.path = "/"); var l = { scheme: o.scheme, netLoc: a.netLoc, path: null, params: a.params, query: a.query, fragment: a.fragment }; if (!a.netLoc && (l.netLoc = o.netLoc, "/" !== a.path[0])) if (a.path) { var c = o.path, h = c.substring(0, c.lastIndexOf("/") + 1) + a.path; l.path = s.normalizePath(h) } else l.path = o.path, a.params || (l.params = o.params, a.query || (l.query = o.query)); return null === l.path && (l.path = i.alwaysNormalize ? s.normalizePath(a.path) : a.path), s.buildURLFromParts(l) }, parseURL: function (t) { var e = i.exec(t); return e ? { scheme: e[1] || "", netLoc: e[2] || "", path: e[3] || "", params: e[4] || "", query: e[5] || "", fragment: e[6] || "" } : null }, normalizePath: function (t) { for (t = t.split("").reverse().join("").replace(n, ""); t.length !== (t = t.replace(a, "")).length;); return t.split("").reverse().join("") }, buildURLFromParts: function (t) { return t.scheme + t.netLoc + t.path + t.params + t.query + t.fragment } }; t.exports = s }(_e) }), Ns = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, Bs = Object.assign || function (t) { for (var e = 1; e < arguments.length; e++) { var i = arguments[e]; for (var r in i) Object.prototype.hasOwnProperty.call(i, r) && (t[r] = i[r]) } return t }, js = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + ("undefined" == typeof e ? "undefined" : De(e))); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e) }, Fs = function (t, e) { if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !e || "object" !== ("undefined" == typeof e ? "undefined" : De(e)) && "function" != typeof e ? t : e }, Hs = function () { function t() { Ns(this, t), this.listeners = {} } return t.prototype.on = function (t, e) { this.listeners[t] || (this.listeners[t] = []), this.listeners[t].push(e) }, t.prototype.off = function (t, e) { if (!this.listeners[t]) return !1; var i = this.listeners[t].indexOf(e); return this.listeners[t].splice(i, 1), i > -1 }, t.prototype.trigger = function (t) { var e = this.listeners[t], i = void 0, r = void 0, n = void 0; if (e) if (2 === arguments.length) for (r = e.length, i = 0; r > i; ++i)e[i].call(this, arguments[1]); else for (n = Array.prototype.slice.call(arguments, 1), r = e.length, i = 0; r > i; ++i)e[i].apply(this, n) }, t.prototype.dispose = function () { this.listeners = {} }, t.prototype.pipe = function (t) { this.on("data", function (e) { t.push(e) }) }, t }(), Vs = function (t) { function e() { Ns(this, e); var i = Fs(this, t.call(this)); return i.buffer = "", i } return js(e, t), e.prototype.push = function (t) { var e = void 0; for (this.buffer += t, e = this.buffer.indexOf("\n"); e > -1; e = this.buffer.indexOf("\n"))this.trigger("data", this.buffer.substring(0, e)), this.buffer = this.buffer.substring(e + 1) }, e }(Hs), qs = function () { var t = "[^=]*", e = '"[^"]*"|[^,]*', i = "(?:" + t + ")=(?:" + e + ")"; return new RegExp("(?:^|,)(" + i + ")") }, Ws = function (t) { for (var e = t.split(qs()), i = {}, r = e.length, n = void 0; r--;)"" !== e[r] && (n = /([^=]*)=(.*)/.exec(e[r]).slice(1), n[0] = n[0].replace(/^\s+|\s+$/g, ""), n[1] = n[1].replace(/^\s+|\s+$/g, ""), n[1] = n[1].replace(/^['"](.*)['"]$/g, "$1"), i[n[0]] = n[1]); return i }, zs = function (t) { function e() { Ns(this, e); var i = Fs(this, t.call(this)); return i.customParsers = [], i } return js(e, t), e.prototype.push = function (t) { var e = void 0, i = void 0; if (t = t.replace(/^[\u0000\s]+|[\u0000\s]+$/g, ""), 0 !== t.length) { if ("#" !== t[0]) return void this.trigger("data", { type: "uri", uri: t }); for (var r = 0; r < this.customParsers.length; r++)if (this.customParsers[r].call(this, t)) return; if (0 !== t.indexOf("#EXT")) return void this.trigger("data", { type: "comment", text: t.slice(1) }); if (t = t.replace("\r", ""), e = /^#EXTM3U/.exec(t)) return void this.trigger("data", { type: "tag", tagType: "m3u" }); if (e = /^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t)) return i = { type: "tag", tagType: "inf" }, e[1] && (i.duration = parseFloat(e[1])), e[2] && (i.title = e[2]), void this.trigger("data", i); if (e = /^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "targetduration" }, e[1] && (i.duration = parseInt(e[1], 10)), void this.trigger("data", i); if (e = /^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "totalduration" }, e[1] && (i.duration = parseInt(e[1], 10)), void this.trigger("data", i); if (e = /^#EXT-X-VERSION:?([0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "version" }, e[1] && (i.version = parseInt(e[1], 10)), void this.trigger("data", i); if (e = /^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "media-sequence" }, e[1] && (i.number = parseInt(e[1], 10)), void this.trigger("data", i); if (e = /^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "discontinuity-sequence" }, e[1] && (i.number = parseInt(e[1], 10)), void this.trigger("data", i); if (e = /^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t)) return i = { type: "tag", tagType: "playlist-type" }, e[1] && (i.playlistType = e[1]), void this.trigger("data", i); if (e = /^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t)) return i = { type: "tag", tagType: "byterange" }, e[1] && (i.length = parseInt(e[1], 10)), e[2] && (i.offset = parseInt(e[2], 10)), void this.trigger("data", i); if (e = /^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t)) return i = { type: "tag", tagType: "allow-cache" }, e[1] && (i.allowed = !/NO/.test(e[1])), void this.trigger("data", i); if (e = /^#EXT-X-MAP:?(.*)$/.exec(t)) { if (i = { type: "tag", tagType: "map" }, e[1]) { var n = Ws(e[1]); if (n.URI && (i.uri = n.URI), n.BYTERANGE) { var a = n.BYTERANGE.split("@"), s = a[0], o = a[1]; i.byterange = {}, s && (i.byterange.length = parseInt(s, 10)), o && (i.byterange.offset = parseInt(o, 10)) } } return void this.trigger("data", i) } if (e = /^#EXT-X-STREAM-INF:?(.*)$/.exec(t)) { if (i = { type: "tag", tagType: "stream-inf" }, e[1]) { if (i.attributes = Ws(e[1]), i.attributes.RESOLUTION) { var u = i.attributes.RESOLUTION.split("x"), l = {}; u[0] && (l.width = parseInt(u[0], 10)), u[1] && (l.height = parseInt(u[1], 10)), i.attributes.RESOLUTION = l } i.attributes.BANDWIDTH && (i.attributes.BANDWIDTH = parseInt(i.attributes.BANDWIDTH, 10)), i.attributes["PROGRAM-ID"] && (i.attributes["PROGRAM-ID"] = parseInt(i.attributes["PROGRAM-ID"], 10)) } return void this.trigger("data", i) } return (e = /^#EXT-X-MEDIA:?(.*)$/.exec(t)) ? (i = { type: "tag", tagType: "media" }, e[1] && (i.attributes = Ws(e[1])), void this.trigger("data", i)) : (e = /^#EXT-X-ENDLIST/.exec(t)) ? void this.trigger("data", { type: "tag", tagType: "endlist" }) : (e = /^#EXT-X-DISCONTINUITY/.exec(t)) ? void this.trigger("data", { type: "tag", tagType: "discontinuity" }) : (e = /^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t)) ? (i = { type: "tag", tagType: "program-date-time" }, e[1] && (i.dateTimeString = e[1], i.dateTimeObject = new Date(e[1])), void this.trigger("data", i)) : (e = /^#EXT-X-KEY:?(.*)$/.exec(t)) ? (i = { type: "tag", tagType: "key" }, e[1] && (i.attributes = Ws(e[1]), i.attributes.IV && ("0x" === i.attributes.IV.substring(0, 2).toLowerCase() && (i.attributes.IV = i.attributes.IV.substring(2)), i.attributes.IV = i.attributes.IV.match(/.{8}/g), i.attributes.IV[0] = parseInt(i.attributes.IV[0], 16), i.attributes.IV[1] = parseInt(i.attributes.IV[1], 16), i.attributes.IV[2] = parseInt(i.attributes.IV[2], 16), i.attributes.IV[3] = parseInt(i.attributes.IV[3], 16), i.attributes.IV = new Uint32Array(i.attributes.IV))), void this.trigger("data", i)) : (e = /^#EXT-X-START:?(.*)$/.exec(t)) ? (i = { type: "tag", tagType: "start" }, e[1] && (i.attributes = Ws(e[1]), i.attributes["TIME-OFFSET"] = parseFloat(i.attributes["TIME-OFFSET"]), i.attributes.PRECISE = /YES/.test(i.attributes.PRECISE)), void this.trigger("data", i)) : (e = /^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t)) ? (i = { type: "tag", tagType: "cue-out-cont" }, e[1] ? i.data = e[1] : i.data = "", void this.trigger("data", i)) : (e = /^#EXT-X-CUE-OUT:?(.*)?$/.exec(t)) ? (i = { type: "tag", tagType: "cue-out" }, e[1] ? i.data = e[1] : i.data = "", void this.trigger("data", i)) : (e = /^#EXT-X-CUE-IN:?(.*)?$/.exec(t)) ? (i = { type: "tag", tagType: "cue-in" }, e[1] ? i.data = e[1] : i.data = "", void this.trigger("data", i)) : void this.trigger("data", { type: "tag", data: t.slice(4) }) } }, e.prototype.addParser = function (t) { var e = this, i = t.expression, r = t.customType, n = t.dataParser, a = t.segment; "function" != typeof n && (n = function (t) { return t }), this.customParsers.push(function (t) { var s = i.exec(t); return s ? (e.trigger("data", { type: "custom", data: n(t), customType: r, segment: a }), !0) : void 0 }) }, e }(Hs), Gs = function (t) { function e() { Ns(this, e); var i = Fs(this, t.call(this)); i.lineStream = new Vs, i.parseStream = new zs, i.lineStream.pipe(i.parseStream); var r = i, n = [], a = {}, s = void 0, o = void 0, u = function () { }, l = { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, c = 0; return i.manifest = { allowCache: !0, discontinuityStarts: [], segments: [] }, i.parseStream.on("data", function (t) { var e = void 0, i = void 0; ({ tag: function () { (({ "allow-cache": function () { this.manifest.allowCache = t.allowed, "allowed" in t || (this.trigger("info", { message: "defaulting allowCache to YES" }), this.manifest.allowCache = !0) }, byterange: function h() { var h = {}; "length" in t && (a.byterange = h, h.length = t.length, "offset" in t || (this.trigger("info", { message: "defaulting offset to zero" }), t.offset = 0)), "offset" in t && (a.byterange = h, h.offset = t.offset) }, endlist: function () { this.manifest.endList = !0 }, inf: function () { "mediaSequence" in this.manifest || (this.manifest.mediaSequence = 0, this.trigger("info", { message: "defaulting media sequence to zero" })), "discontinuitySequence" in this.manifest || (this.manifest.discontinuitySequence = 0, this.trigger("info", { message: "defaulting discontinuity sequence to zero" })), t.duration > 0 && (a.duration = t.duration), 0 === t.duration && (a.duration = .01, this.trigger("info", { message: "updating zero segment duration to a small value" })), this.manifest.segments = n }, key: function () { return t.attributes ? "NONE" === t.attributes.METHOD ? void (o = null) : t.attributes.URI ? (t.attributes.METHOD || this.trigger("warn", { message: "defaulting key method to AES-128" }), o = { method: t.attributes.METHOD || "AES-128", uri: t.attributes.URI }, void ("undefined" != typeof t.attributes.IV && (o.iv = t.attributes.IV))) : void this.trigger("warn", { message: "ignoring key declaration without URI" }) : void this.trigger("warn", { message: "ignoring key declaration without attribute list" }) }, "media-sequence": function () { return isFinite(t.number) ? void (this.manifest.mediaSequence = t.number) : void this.trigger("warn", { message: "ignoring invalid media sequence: " + t.number }) }, "discontinuity-sequence": function () { return isFinite(t.number) ? (this.manifest.discontinuitySequence = t.number, void (c = t.number)) : void this.trigger("warn", { message: "ignoring invalid discontinuity sequence: " + t.number }) }, "playlist-type": function () { return /VOD|EVENT/.test(t.playlistType) ? void (this.manifest.playlistType = t.playlistType) : void this.trigger("warn", { message: "ignoring unknown playlist type: " + t.playlist }) }, map: function () { s = {}, t.uri && (s.uri = t.uri), t.byterange && (s.byterange = t.byterange) }, "stream-inf": function () { return this.manifest.playlists = n, this.manifest.mediaGroups = this.manifest.mediaGroups || l, t.attributes ? (a.attributes || (a.attributes = {}), void Bs(a.attributes, t.attributes)) : void this.trigger("warn", { message: "ignoring empty stream-inf attributes" }) }, media: function () { if (this.manifest.mediaGroups = this.manifest.mediaGroups || l, !(t.attributes && t.attributes.TYPE && t.attributes["GROUP-ID"] && t.attributes.NAME)) return void this.trigger("warn", { message: "ignoring incomplete or missing media group" }); var r = this.manifest.mediaGroups[t.attributes.TYPE]; r[t.attributes["GROUP-ID"]] = r[t.attributes["GROUP-ID"]] || {}, e = r[t.attributes["GROUP-ID"]], i = { "default": /yes/i.test(t.attributes.DEFAULT) }, i["default"] ? i.autoselect = !0 : i.autoselect = /yes/i.test(t.attributes.AUTOSELECT), t.attributes.LANGUAGE && (i.language = t.attributes.LANGUAGE), t.attributes.URI && (i.uri = t.attributes.URI), t.attributes["INSTREAM-ID"] && (i.instreamId = t.attributes["INSTREAM-ID"]), t.attributes.CHARACTERISTICS && (i.characteristics = t.attributes.CHARACTERISTICS), t.attributes.FORCED && (i.forced = /yes/i.test(t.attributes.FORCED)), e[t.attributes.NAME] = i }, discontinuity: function () { c += 1, a.discontinuity = !0, this.manifest.discontinuityStarts.push(n.length) }, "program-date-time": function () { "undefined" == typeof this.manifest.dateTimeString && (this.manifest.dateTimeString = t.dateTimeString, this.manifest.dateTimeObject = t.dateTimeObject), a.dateTimeString = t.dateTimeString, a.dateTimeObject = t.dateTimeObject }, targetduration: function () { return !isFinite(t.duration) || t.duration < 0 ? void this.trigger("warn", { message: "ignoring invalid target duration: " + t.duration }) : void (this.manifest.targetDuration = t.duration) }, totalduration: function () { return !isFinite(t.duration) || t.duration < 0 ? void this.trigger("warn", { message: "ignoring invalid total duration: " + t.duration }) : void (this.manifest.totalDuration = t.duration) }, start: function () { return !t.attributes || isNaN(t.attributes["TIME-OFFSET"]) ? void this.trigger("warn", { message: "ignoring start declaration without appropriate attribute list" }) : void (this.manifest.start = { timeOffset: t.attributes["TIME-OFFSET"], precise: t.attributes.PRECISE }) }, "cue-out": function () { a.cueOut = t.data }, "cue-out-cont": function () { a.cueOutCont = t.data }, "cue-in": function () { a.cueIn = t.data } })[t.tagType] || u).call(r) }, uri: function () { a.uri = t.uri, n.push(a), !this.manifest.targetDuration || "duration" in a || (this.trigger("warn", { message: "defaulting segment duration to the target duration" }), a.duration = this.manifest.targetDuration), o && (a.key = o), a.timeline = c, s && (a.map = s), a = {} }, comment: function () { }, custom: function () { t.segment ? (a.custom = a.custom || {}, a.custom[t.customType] = t.data) : (this.manifest.custom = this.manifest.custom || {}, this.manifest.custom[t.customType] = t.data) } })[t.type].call(r) }), i } return js(e, t), e.prototype.push = function (t) { this.lineStream.push(t) }, e.prototype.end = function () { this.lineStream.push("\n") }, e.prototype.addParser = function (t) { this.parseStream.addParser(t) }, e }(Hs), Xs = function (t) { var e, i = t.attributes, r = t.segments, n = { attributes: (e = { NAME: i.id, BANDWIDTH: i.bandwidth, CODECS: i.codecs }, e["PROGRAM-ID"] = 1, e), uri: "", endList: "static" === (i.type || "static"), timeline: i.periodIndex, resolvedUri: "", targetDuration: i.duration, segments: r, mediaSequence: r.length ? r[0].number : 1 }; return i.contentProtection && (n.contentProtection = i.contentProtection), n }, Ys = function (t) { var e, i = t.attributes, r = t.segments; return "undefined" == typeof r && (r = [{ uri: i.baseUrl, timeline: i.periodIndex, resolvedUri: i.baseUrl || "", duration: i.sourceDuration, number: 0 }], i.duration = i.sourceDuration), { attributes: (e = { NAME: i.id, BANDWIDTH: i.bandwidth }, e["PROGRAM-ID"] = 1, e), uri: "", endList: "static" === (i.type || "static"), timeline: i.periodIndex, resolvedUri: i.baseUrl || "", targetDuration: i.duration, segments: r, mediaSequence: r.length ? r[0].number : 1 } }, $s = function (t) { return t.reduce(function (t, e) { var i = e.attributes.role && e.attributes.role.value || "main", r = e.attributes.lang || "", n = "main"; return r && (n = e.attributes.lang + " (" + i + ")"), t[n] && t[n].playlists[0].attributes.BANDWIDTH > e.attributes.bandwidth ? t : (t[n] = { language: r, autoselect: !0, "default": "main" === i, playlists: [Xs(e)], uri: "" }, t) }, {}) }, Ks = function (t) { return t.reduce(function (t, e) { var i = e.attributes.lang || "text"; return t[i] ? t : (t[i] = { language: i, "default": !1, autoselect: !1, playlists: [Ys(e)], uri: "" }, t) }, {}) }, Js = function (t) { var e, i = t.attributes, r = t.segments, n = { attributes: (e = { NAME: i.id, AUDIO: "audio", SUBTITLES: "subs", RESOLUTION: { width: i.width, height: i.height }, CODECS: i.codecs, BANDWIDTH: i.bandwidth }, e["PROGRAM-ID"] = 1, e), uri: "", endList: "static" === (i.type || "static"), timeline: i.periodIndex, resolvedUri: "", targetDuration: i.duration, segments: r, mediaSequence: r.length ? r[0].number : 1 }; return i.contentProtection && (n.contentProtection = i.contentProtection), n }, Qs = function (t) { var e; if (!t.length) return {}; var i = t[0].attributes, r = i.sourceDuration, n = i.minimumUpdatePeriod, a = void 0 === n ? 0 : n, s = function (t) { var e = t.attributes; return "video/mp4" === e.mimeType || "video" === e.contentType }, o = function (t) { var e = t.attributes; return "audio/mp4" === e.mimeType || "audio" === e.contentType }, u = function (t) { var e = t.attributes; return "text/vtt" === e.mimeType || "text" === e.contentType }, l = t.filter(s).map(Js), c = t.filter(o), h = t.filter(u), d = { allowCache: !0, discontinuityStarts: [], segments: [], endList: !0, mediaGroups: (e = { AUDIO: {}, VIDEO: {} }, e["CLOSED-CAPTIONS"] = {}, e.SUBTITLES = {}, e), uri: "", duration: r, playlists: l, minimumUpdatePeriod: 1e3 * a }; return c.length && (d.mediaGroups.AUDIO.audio = $s(c)), h.length && (d.mediaGroups.SUBTITLES.subs = Ks(h)), d }, Zs = "function" == typeof Symbol && "symbol" === De(Symbol.iterator) ? function (t) { return "undefined" == typeof t ? "undefined" : De(t) } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : "undefined" == typeof t ? "undefined" : De(t) }, to = function (t) { return !!t && "object" === ("undefined" == typeof t ? "undefined" : Zs(t)) }, eo = function Yd() { for (var t = arguments.length, e = Array(t), i = 0; t > i; i++)e[i] = arguments[i]; return e.reduce(function (t, e) { return Object.keys(e).forEach(function (i) { Array.isArray(t[i]) && Array.isArray(e[i]) ? t[i] = t[i].concat(e[i]) : to(t[i]) && to(e[i]) ? t[i] = Yd(t[i], e[i]) : t[i] = e[i] }), t }, {}) }, io = function (t, e) { return /^[a-z]+:/i.test(e) ? e : (/\/\//i.test(t) || (t = Us.buildAbsoluteURL(Te.location.href, t)), Us.buildAbsoluteURL(t, e)) }, ro = function (t) { var e = t.baseUrl, i = void 0 === e ? "" : e, r = t.source, n = void 0 === r ? "" : r, a = t.range, s = void 0 === a ? "" : a, o = { uri: n, resolvedUri: io(i || "", n) }; if (s) { var u = s.split("-"), l = parseInt(u[0], 10), c = parseInt(u[1], 10); o.byterange = { length: c - l, offset: l } } return o }, no = function (t, e, i) { var r = t.NOW, n = t.clientOffset, a = t.availabilityStartTime, s = t.timescale, o = void 0 === s ? 1 : s, u = t.start, l = void 0 === u ? 0 : u, c = t.minimumUpdatePeriod, h = void 0 === c ? 0 : c, d = (r + n) / 1e3, p = a + l, f = d + h, m = f - p; return Math.ceil((m * o - e) / i) }, ao = function (t, e) { for (var i = t.type, r = void 0 === i ? "static" : i, n = t.minimumUpdatePeriod, a = void 0 === n ? 0 : n, s = t.media, o = void 0 === s ? "" : s, u = t.sourceDuration, l = t.timescale, c = void 0 === l ? 1 : l, h = t.startNumber, d = void 0 === h ? 1 : h, p = t.periodIndex, f = [], m = -1, g = 0; g < e.length; g++) { var y = e[g], v = y.d, _ = y.r || 0, b = y.t || 0; 0 > m && (m = b), b && b > m && (m = b); var T = void 0; if (0 > _) { var S = g + 1; T = S === e.length ? "dynamic" === r && a > 0 && o.indexOf("$Number$") > 0 ? no(t, m, v) : (u * c - m) / v : (e[S].t - m) / v } else T = _ + 1; for (var k = d + f.length + T, E = d + f.length; k > E;)f.push({ number: E, duration: v / c, time: m, timeline: p }), m += v, E++ } return f }, so = function (t, e) { for (var i = [], r = t; e > r; r++)i.push(r); return i }, oo = function (t) { return t.reduce(function (t, e) { return t.concat(e) }, []) }, uo = function (t) { if (!t.length) return []; for (var e = [], i = 0; i < t.length; i++)e.push(t[i]); return e }, lo = { "static": function (t) { var e = t.duration, i = t.timescale, r = void 0 === i ? 1 : i, n = t.sourceDuration; return { start: 0, end: Math.ceil(n / (e / r)) } }, dynamic: function (t) { var e = t.NOW, i = t.clientOffset, r = t.availabilityStartTime, n = t.timescale, a = void 0 === n ? 1 : n, s = t.duration, o = t.start, u = void 0 === o ? 0 : o, l = t.minimumUpdatePeriod, c = void 0 === l ? 0 : l, h = t.timeShiftBufferDepth, d = void 0 === h ? 1 / 0 : h, p = (e + i) / 1e3, f = r + u, m = p + c, g = m - f, y = Math.ceil(g * a / s), v = Math.floor((p - f - d) * a / s), _ = Math.floor((p - f) * a / s); return { start: Math.max(0, v), end: Math.min(y, _) } } }, co = function (t) { return function (e, i) { var r = t.duration, n = t.timescale, a = void 0 === n ? 1 : n, s = t.periodIndex, o = t.startNumber, u = void 0 === o ? 1 : o; return { number: u + e, duration: r / a, timeline: s, time: i * r } } }, ho = function (t) { var e = t.type, i = void 0 === e ? "static" : e, r = t.duration, n = t.timescale, a = void 0 === n ? 1 : n, s = t.sourceDuration, o = lo[i](t), u = o.start, l = o.end, c = so(u, l).map(co(t)); if ("static" === i) { var h = c.length - 1; c[h].duration = s - r / a * h } return c }, po = /\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g, fo = function (t) { return function (e, i, r, n) { if ("$$" === e) return "$"; if ("undefined" == typeof t[i]) return e; var a = "" + t[i]; return "RepresentationID" === i ? a : (n = r ? parseInt(n, 10) : 1, a.length >= n ? a : "" + new Array(n - a.length + 1).join("0") + a) } }, mo = function (t, e) { return t.replace(po, fo(e)) }, go = function (t, e) { return t.duration || e ? t.duration ? ho(t) : ao(t, e) : [{ number: t.startNumber || 1, duration: t.sourceDuration, time: 0, timeline: t.periodIndex }] }, yo = function (t, e) { var i = { RepresentationID: t.id, Bandwidth: t.bandwidth || 0 }, r = t.initialization, n = void 0 === r ? { sourceURL: "", range: "" } : r, a = ro({ baseUrl: t.baseUrl, source: mo(n.sourceURL, i), range: n.range }), s = go(t, e); return s.map(function (e) { i.Number = e.number, i.Time = e.time; var r = mo(t.media || "", i); return { uri: r, timeline: e.timeline, duration: e.duration, resolvedUri: io(t.baseUrl || "", r), map: a, number: e.number } }) }, vo = { INVALID_NUMBER_OF_PERIOD: "INVALID_NUMBER_OF_PERIOD", DASH_EMPTY_MANIFEST: "DASH_EMPTY_MANIFEST", DASH_INVALID_XML: "DASH_INVALID_XML", NO_BASE_URL: "NO_BASE_URL", MISSING_SEGMENT_INFORMATION: "MISSING_SEGMENT_INFORMATION", SEGMENT_TIME_UNSPECIFIED: "SEGMENT_TIME_UNSPECIFIED", UNSUPPORTED_UTC_TIMING_SCHEME: "UNSUPPORTED_UTC_TIMING_SCHEME" }, _o = function (t, e) { var i = t.baseUrl, r = t.initialization, n = void 0 === r ? {} : r, a = ro({ baseUrl: i, source: n.sourceURL, range: n.range }), s = ro({ baseUrl: i, source: e.media, range: e.mediaRange }); return s.map = a, s }, bo = function (t, e) { var i = t.duration, r = t.segmentUrls, n = void 0 === r ? [] : r; if (!i && !e || i && e) throw new Error(vo.SEGMENT_TIME_UNSPECIFIED); var a = n.map(function (e) { return _o(t, e) }), s = void 0; i && (s = ho(t)), e && (s = ao(t, e)); var o = s.map(function (t, e) { if (a[e]) { var i = a[e]; return i.timeline = t.timeline, i.duration = t.duration, i.number = t.number, i } }).filter(function (t) { return t }); return o }, To = function (t) { var e = t.baseUrl, i = t.initialization, r = void 0 === i ? {} : i, n = t.sourceDuration, a = t.timescale, s = void 0 === a ? 1 : a, o = t.indexRange, u = void 0 === o ? "" : o, l = t.duration; if (!e) throw new Error(vo.NO_BASE_URL); var c = ro({ baseUrl: e, source: r.sourceURL, range: r.range }), h = ro({ baseUrl: e, source: e, range: u }); if (h.map = c, l) { var d = ho(t); d.length && (h.duration = d[0].duration, h.timeline = d[0].timeline) } else n && (h.duration = n / s, h.timeline = 0); return h.number = 0, [h] }, So = function (t) {
    var e = t.attributes, i = t.segmentInfo, r = void 0, n = void 0; if (i.template ? (n = yo, r = eo(e, i.template)) : i.base ? (n = To,
      r = eo(e, i.base)) : i.list && (n = bo, r = eo(e, i.list)), !n) return { attributes: e }; var a = n(r, i.timeline); if (r.duration) { var s = r, o = s.duration, u = s.timescale, l = void 0 === u ? 1 : u; r.duration = o / l } else a.length ? r.duration = a.reduce(function (t, e) { return Math.max(t, Math.ceil(e.duration)) }, 0) : r.duration = 0; return { attributes: r, segments: a }
  }, ko = function (t) { return t.map(So) }, Eo = function (t, e) { return uo(t.childNodes).filter(function (t) { var i = t.tagName; return i === e }) }, Co = function (t) { return t.textContent.trim() }, wo = function (t) { var e = 31536e3, i = 2592e3, r = 86400, n = 3600, a = 60, s = /P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/, o = s.exec(t); if (!o) return 0; var u = o.slice(1), l = u[0], c = u[1], h = u[2], d = u[3], p = u[4], f = u[5]; return parseFloat(l || 0) * e + parseFloat(c || 0) * i + parseFloat(h || 0) * r + parseFloat(d || 0) * n + parseFloat(p || 0) * a + parseFloat(f || 0) }, Ao = function (t) { var e = /^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/; return e.test(t) && (t += "Z"), Date.parse(t) }, Lo = { mediaPresentationDuration: function (t) { return wo(t) }, availabilityStartTime: function (t) { return Ao(t) / 1e3 }, minimumUpdatePeriod: function (t) { return wo(t) }, timeShiftBufferDepth: function (t) { return wo(t) }, start: function (t) { return wo(t) }, width: function (t) { return parseInt(t, 10) }, height: function (t) { return parseInt(t, 10) }, bandwidth: function (t) { return parseInt(t, 10) }, startNumber: function (t) { return parseInt(t, 10) }, timescale: function (t) { return parseInt(t, 10) }, duration: function (t) { var e = parseInt(t, 10); return isNaN(e) ? wo(t) : e }, d: function (t) { return parseInt(t, 10) }, t: function (t) { return parseInt(t, 10) }, r: function (t) { return parseInt(t, 10) }, DEFAULT: function (t) { return t } }, Po = function (t) { return t && t.attributes ? uo(t.attributes).reduce(function (t, e) { var i = Lo[e.name] || Lo.DEFAULT; return t[e.name] = i(e.value), t }, {}) : {} }, Oo = { "urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b": "org.w3.clearkey", "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed": "com.widevine.alpha", "urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95": "com.microsoft.playready", "urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb": "com.adobe.primetime" }, Io = function (t, e) { return e.length ? oo(t.map(function (t) { return e.map(function (e) { return io(t, Co(e)) }) })) : t }, xo = function (t) { var e = Eo(t, "SegmentTemplate")[0], i = Eo(t, "SegmentList")[0], r = i && Eo(i, "SegmentURL").map(function (t) { return eo({ tag: "SegmentURL" }, Po(t)) }), n = Eo(t, "SegmentBase")[0], a = i || e, s = a && Eo(a, "SegmentTimeline")[0], o = i || n || e, u = o && Eo(o, "Initialization")[0], l = e && Po(e); l && u ? l.initialization = u && Po(u) : l && l.initialization && (l.initialization = { sourceURL: l.initialization }); var c = { template: l, timeline: s && Eo(s, "S").map(function (t) { return Po(t) }), list: i && eo(Po(i), { segmentUrls: r, initialization: Po(u) }), base: n && eo(Po(n), { initialization: Po(u) }) }; return Object.keys(c).forEach(function (t) { c[t] || delete c[t] }), c }, Do = function (t, e, i) { return function (r) { var n = Eo(r, "BaseURL"), a = Io(e, n), s = eo(t, Po(r)), o = xo(r); return a.map(function (t) { return { segmentInfo: eo(i, o), attributes: eo(s, { baseUrl: t }) } }) } }, Ro = function (t) { return t.reduce(function (t, e) { var i = Po(e), r = Oo[i.schemeIdUri]; if (r) { t[r] = { attributes: i }; var n = Eo(e, "cenc:pssh")[0]; if (n) { var a = Co(n), s = a && he(a); t[r].pssh = s } } return t }, {}) }, Mo = function (t, e, i) { return function (r) { var n = Po(r), a = Io(e, Eo(r, "BaseURL")), s = Eo(r, "Role")[0], o = { role: Po(s) }, u = eo(t, n, o), l = Ro(Eo(r, "ContentProtection")); Object.keys(l).length && (u = eo(u, { contentProtection: l })); var c = xo(r), h = Eo(r, "Representation"), d = eo(i, c); return oo(h.map(Do(u, a, d))) } }, Uo = function (t, e) { return function (i, r) { var n = Io(e, Eo(i, "BaseURL")), a = Po(i), s = eo(t, a, { periodIndex: r }), o = Eo(i, "AdaptationSet"), u = xo(i); return oo(o.map(Mo(s, n, u))) } }, No = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = e.manifestUri, r = void 0 === i ? "" : i, n = e.NOW, a = void 0 === n ? Date.now() : n, s = e.clientOffset, o = void 0 === s ? 0 : s, u = Eo(t, "Period"); if (1 !== u.length) throw new Error(vo.INVALID_NUMBER_OF_PERIOD); var l = Po(t), c = Io([r], Eo(t, "BaseURL")); return l.sourceDuration = l.mediaPresentationDuration || 0, l.NOW = a, l.clientOffset = o, oo(u.map(Uo(l, c))) }, Bo = function (t) { if ("" === t) throw new Error(vo.DASH_EMPTY_MANIFEST); var e = new Te.DOMParser, i = e.parseFromString(t, "application/xml"), r = i && "MPD" === i.documentElement.tagName ? i.documentElement : null; if (!r || r && r.getElementsByTagName("parsererror").length > 0) throw new Error(vo.DASH_INVALID_XML); return r }, jo = function (t) { var e = Eo(t, "UTCTiming")[0]; if (!e) return null; var i = Po(e); switch (i.schemeIdUri) { case "urn:mpeg:dash:utc:http-head:2014": case "urn:mpeg:dash:utc:http-head:2012": i.method = "HEAD"; break; case "urn:mpeg:dash:utc:http-xsdate:2014": case "urn:mpeg:dash:utc:http-iso:2014": case "urn:mpeg:dash:utc:http-xsdate:2012": case "urn:mpeg:dash:utc:http-iso:2012": i.method = "GET"; break; case "urn:mpeg:dash:utc:direct:2014": case "urn:mpeg:dash:utc:direct:2012": i.method = "DIRECT", i.value = Date.parse(i.value); break; case "urn:mpeg:dash:utc:http-ntp:2014": case "urn:mpeg:dash:utc:ntp:2014": case "urn:mpeg:dash:utc:sntp:2014": default: throw new Error(vo.UNSUPPORTED_UTC_TIMING_SCHEME) }return i }, Fo = function (t, e) { return Qs(ko(No(Bo(t), e))) }, Ho = function (t) { return jo(Bo(t)) }, Vo = function (t) { return t >>> 0 }, qo = { toUnsigned: Vo }, Wo = qo.toUnsigned, zo = Object.freeze({ "default": qo, __moduleExports: qo, toUnsigned: Wo }), Go = zo && qo || zo, Xo = Go.toUnsigned; xs = function (t, e) { var i, r, n, a, s, o = []; if (!e.length) return null; for (i = 0; i < t.byteLength;)r = Xo(t[i] << 24 | t[i + 1] << 16 | t[i + 2] << 8 | t[i + 3]), n = Ds(t.subarray(i + 4, i + 8)), a = r > 1 ? i + r : t.byteLength, n === e[0] && (1 === e.length ? o.push(t.subarray(i + 8, a)) : (s = xs(t.subarray(i + 8, a), e.slice(1)), s.length && (o = o.concat(s)))), i = a; return o }, Ds = function (t) { var e = ""; return e += String.fromCharCode(t[0]), e += String.fromCharCode(t[1]), e += String.fromCharCode(t[2]), e += String.fromCharCode(t[3]) }, Rs = function (t) { var e = {}, i = xs(t, ["moov", "trak"]); return i.reduce(function (t, e) { var i, r, n, a, s; return (i = xs(e, ["tkhd"])[0]) ? (r = i[0], n = 0 === r ? 12 : 20, a = Xo(i[n] << 24 | i[n + 1] << 16 | i[n + 2] << 8 | i[n + 3]), (s = xs(e, ["mdia", "mdhd"])[0]) ? (r = s[0], n = 0 === r ? 12 : 20, t[a] = Xo(s[n] << 24 | s[n + 1] << 16 | s[n + 2] << 8 | s[n + 3]), t) : null) : null }, e) }, Ms = function (t, e) { var i, r, n; return i = xs(e, ["moof", "traf"]), r = [].concat.apply([], i.map(function (e) { return xs(e, ["tfhd"]).map(function (i) { var r, n, a; return r = Xo(i[4] << 24 | i[5] << 16 | i[6] << 8 | i[7]), n = t[r] || 9e4, a = xs(e, ["tfdt"]).map(function (t) { var e, i; return e = t[0], i = Xo(t[4] << 24 | t[5] << 16 | t[6] << 8 | t[7]), 1 === e && (i *= Math.pow(2, 32), i += Xo(t[8] << 24 | t[9] << 16 | t[10] << 8 | t[11])), i })[0], a = a || 1 / 0, a / n }) })), n = Math.min.apply(null, r), isFinite(n) ? n : 0 }; var Yo = { parseType: Ds, timescale: Rs, startTime: Ms }, $o = { H264_STREAM_TYPE: 27, ADTS_STREAM_TYPE: 15, METADATA_STREAM_TYPE: 21 }, Ko = $o.H264_STREAM_TYPE, Jo = $o.ADTS_STREAM_TYPE, Qo = $o.METADATA_STREAM_TYPE, Zo = Object.freeze({ "default": $o, __moduleExports: $o, H264_STREAM_TYPE: Ko, ADTS_STREAM_TYPE: Jo, METADATA_STREAM_TYPE: Qo }), tu = function () { this.init = function () { var t = {}; this.on = function (e, i) { t[e] || (t[e] = []), t[e] = t[e].concat(i) }, this.off = function (e, i) { var r; return t[e] ? (r = t[e].indexOf(i), t[e] = t[e].slice(), t[e].splice(r, 1), r > -1) : !1 }, this.trigger = function (e) { var i, r, n, a; if (i = t[e]) if (2 === arguments.length) for (n = i.length, r = 0; n > r; ++r)i[r].call(this, arguments[1]); else { for (a = [], r = arguments.length, r = 1; r < arguments.length; ++r)a.push(arguments[r]); for (n = i.length, r = 0; n > r; ++r)i[r].apply(this, a) } }, this.dispose = function () { t = {} } } }; tu.prototype.pipe = function (t) { return this.on("data", function (e) { t.push(e) }), this.on("done", function (e) { t.flush(e) }), t }, tu.prototype.push = function (t) { this.trigger("data", t) }, tu.prototype.flush = function (t) { this.trigger("done", t) }; var eu = tu, iu = Object.freeze({ "default": eu, __moduleExports: eu }), ru = iu && eu || iu, nu = 8589934592, au = 4294967296, su = function (t, e) { var i = 1; for (t > e && (i = -1); Math.abs(e - t) > au;)t += i * nu; return t }, ou = function $d(t) { var e, i; $d.prototype.init.call(this), this.type_ = t, this.push = function (t) { t.type === this.type_ && (void 0 === i && (i = t.dts), t.dts = su(t.dts, i), t.pts = su(t.pts, i), e = t.dts, this.trigger("data", t)) }, this.flush = function () { i = e, this.trigger("done") }, this.discontinuity = function () { i = void 0, e = void 0 } }; ou.prototype = new ru; var uu = { TimestampRolloverStream: ou, handleRollover: su }, lu = uu.TimestampRolloverStream, cu = uu.handleRollover, hu = Object.freeze({ "default": uu, __moduleExports: uu, TimestampRolloverStream: lu, handleRollover: cu }), du = Zo && $o || Zo, pu = function (t) { var e = 31 & t[1]; return e <<= 8, e |= t[2] }, fu = function (t) { return !!(64 & t[1]) }, mu = function (t) { var e = 0; return (48 & t[3]) >>> 4 > 1 && (e += t[4] + 1), e }, gu = function (t, e) { var i = pu(t); return 0 === i ? "pat" : i === e ? "pmt" : e ? "pes" : null }, yu = function (t) { var e = fu(t), i = 4 + mu(t); return e && (i += t[i] + 1), (31 & t[i + 10]) << 8 | t[i + 11] }, vu = function (t) { var e = {}, i = fu(t), r = 4 + mu(t); if (i && (r += t[r] + 1), 1 & t[r + 5]) { var n, a, s; n = (15 & t[r + 1]) << 8 | t[r + 2], a = 3 + n - 4, s = (15 & t[r + 10]) << 8 | t[r + 11]; for (var o = 12 + s; a > o;) { var u = r + o; e[(31 & t[u + 1]) << 8 | t[u + 2]] = t[u], o += ((15 & t[u + 3]) << 8 | t[u + 4]) + 5 } return e } }, _u = function (t, e) { var i = pu(t), r = e[i]; switch (r) { case du.H264_STREAM_TYPE: return "video"; case du.ADTS_STREAM_TYPE: return "audio"; case du.METADATA_STREAM_TYPE: return "timed-metadata"; default: return null } }, bu = function (t) { var e = fu(t); if (!e) return null; var i = 4 + mu(t); if (i >= t.byteLength) return null; var r, n = null; return r = t[i + 7], 192 & r && (n = {}, n.pts = (14 & t[i + 9]) << 27 | (255 & t[i + 10]) << 20 | (254 & t[i + 11]) << 12 | (255 & t[i + 12]) << 5 | (254 & t[i + 13]) >>> 3, n.pts *= 4, n.pts += (6 & t[i + 13]) >>> 1, n.dts = n.pts, 64 & r && (n.dts = (14 & t[i + 14]) << 27 | (255 & t[i + 15]) << 20 | (254 & t[i + 16]) << 12 | (255 & t[i + 17]) << 5 | (254 & t[i + 18]) >>> 3, n.dts *= 4, n.dts += (6 & t[i + 18]) >>> 1)), n }, Tu = function (t) { switch (t) { case 5: return "slice_layer_without_partitioning_rbsp_idr"; case 6: return "sei_rbsp"; case 7: return "seq_parameter_set_rbsp"; case 8: return "pic_parameter_set_rbsp"; case 9: return "access_unit_delimiter_rbsp"; default: return null } }, Su = function (t) { for (var e, i = 4 + mu(t), r = t.subarray(i), n = 0, a = 0, s = !1; a < r.byteLength - 3; a++)if (1 === r[a + 2]) { n = a + 5; break } for (; n < r.byteLength;)switch (r[n]) { case 0: if (0 !== r[n - 1]) { n += 2; break } if (0 !== r[n - 2]) { n++; break } a + 3 !== n - 2 && (e = Tu(31 & r[a + 3]), "slice_layer_without_partitioning_rbsp_idr" === e && (s = !0)); do n++; while (1 !== r[n] && n < r.length); a = n - 2, n += 3; break; case 1: if (0 !== r[n - 1] || 0 !== r[n - 2]) { n += 3; break } e = Tu(31 & r[a + 3]), "slice_layer_without_partitioning_rbsp_idr" === e && (s = !0), a = n - 2, n += 3; break; default: n += 3 }return r = r.subarray(a), n -= a, a = 0, r && r.byteLength > 3 && (e = Tu(31 & r[a + 3]), "slice_layer_without_partitioning_rbsp_idr" === e && (s = !0)), s }, ku = { parseType: gu, parsePat: yu, parsePmt: vu, parsePayloadUnitStartIndicator: fu, parsePesType: _u, parsePesTime: bu, videoPacketContainsKeyFrame: Su }, Eu = ku.parseType, Cu = ku.parsePat, wu = ku.parsePmt, Au = ku.parsePayloadUnitStartIndicator, Lu = ku.parsePesType, Pu = ku.parsePesTime, Ou = ku.videoPacketContainsKeyFrame, Iu = Object.freeze({ "default": ku, __moduleExports: ku, parseType: Eu, parsePat: Cu, parsePmt: wu, parsePayloadUnitStartIndicator: Au, parsePesType: Lu, parsePesTime: Pu, videoPacketContainsKeyFrame: Ou }), xu = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350], Du = function (t) { return t[0] << 21 | t[1] << 14 | t[2] << 7 | t[3] }, Ru = function (t, e, i) { var r, n = ""; for (r = e; i > r; r++)n += "%" + ("00" + t[r].toString(16)).slice(-2); return n }, Mu = function (t, e, i) { return unescape(Ru(t, e, i)) }, Uu = function (t, e) { var i = t[e + 6] << 21 | t[e + 7] << 14 | t[e + 8] << 7 | t[e + 9], r = t[e + 5], n = (16 & r) >> 4; return n ? i + 20 : i + 10 }, Nu = function (t, e) { var i = (224 & t[e + 5]) >> 5, r = t[e + 4] << 3, n = 6144 & t[e + 3]; return n | r | i }, Bu = function (t, e) { return t[e] === "I".charCodeAt(0) && t[e + 1] === "D".charCodeAt(0) && t[e + 2] === "3".charCodeAt(0) ? "timed-metadata" : t[e] & !0 && 240 === (240 & t[e + 1]) ? "audio" : null }, ju = function (t) { for (var e = 0; e + 5 < t.length;) { if (255 === t[e] && 240 === (246 & t[e + 1])) return xu[(60 & t[e + 2]) >>> 2]; e++ } return null }, Fu = function (t) { var e, i, r, n; e = 10, 64 & t[5] && (e += 4, e += Du(t.subarray(10, 14))); do { if (i = Du(t.subarray(e + 4, e + 8)), 1 > i) return null; if (n = String.fromCharCode(t[e], t[e + 1], t[e + 2], t[e + 3]), "PRIV" === n) { r = t.subarray(e + 10, e + i + 10); for (var a = 0; a < r.byteLength; a++)if (0 === r[a]) { var s = Mu(r, 0, a); if ("com.apple.streaming.transportStreamTimestamp" === s) { var o = r.subarray(a + 1), u = (1 & o[3]) << 30 | o[4] << 22 | o[5] << 14 | o[6] << 6 | o[7] >>> 2; return u *= 4, u += 3 & o[7] } break } } e += 10, e += i } while (e < t.byteLength); return null }, Hu = { parseId3TagSize: Uu, parseAdtsSize: Nu, parseType: Bu, parseSampleRate: ju, parseAacTimestamp: Fu }, Vu = Hu.parseId3TagSize, qu = Hu.parseAdtsSize, Wu = Hu.parseType, zu = Hu.parseSampleRate, Gu = Hu.parseAacTimestamp, Xu = Object.freeze({ "default": Hu, __moduleExports: Hu, parseId3TagSize: Vu, parseAdtsSize: qu, parseType: Wu, parseSampleRate: zu, parseAacTimestamp: Gu }), Yu = hu && uu || hu, $u = Iu && ku || Iu, Ku = Xu && Hu || Xu, Ju = Yu.handleRollover, Qu = {}; Qu.ts = $u, Qu.aac = Ku; var Zu = 9e4, tl = 188, el = 71, il = function (t) { return t[0] === "I".charCodeAt(0) && t[1] === "D".charCodeAt(0) && t[2] === "3".charCodeAt(0) ? !0 : !1 }, rl = function (t, e) { for (var i, r, n = 0, a = tl; a < t.byteLength;)if (t[n] !== el || t[a] !== el) n++ , a++; else { switch (i = t.subarray(n, a), r = Qu.ts.parseType(i, e.pid)) { case "pat": e.pid || (e.pid = Qu.ts.parsePat(i)); break; case "pmt": e.table || (e.table = Qu.ts.parsePmt(i)) }if (e.pid && e.table) return; n += tl, a += tl } }, nl = function (t, e, i) { for (var r, n, a, s, o, u = 0, l = tl, c = !1; l < t.byteLength;)if (t[u] !== el || t[l] !== el) u++ , l++; else { switch (r = t.subarray(u, l), n = Qu.ts.parseType(r, e.pid)) { case "pes": a = Qu.ts.parsePesType(r, e.table), s = Qu.ts.parsePayloadUnitStartIndicator(r), "audio" === a && s && (o = Qu.ts.parsePesTime(r), o && (o.type = "audio", i.audio.push(o), c = !0)) }if (c) break; u += tl, l += tl } for (l = t.byteLength, u = l - tl, c = !1; u >= 0;)if (t[u] !== el || t[l] !== el) u-- , l--; else { switch (r = t.subarray(u, l), n = Qu.ts.parseType(r, e.pid)) { case "pes": a = Qu.ts.parsePesType(r, e.table), s = Qu.ts.parsePayloadUnitStartIndicator(r), "audio" === a && s && (o = Qu.ts.parsePesTime(r), o && (o.type = "audio", i.audio.push(o), c = !0)) }if (c) break; u -= tl, l -= tl } }, al = function (t, e, i) { for (var r, n, a, s, o, u, l, c, h = 0, d = tl, p = !1, f = { data: [], size: 0 }; d < t.byteLength;)if (t[h] !== el || t[d] !== el) h++ , d++; else { switch (r = t.subarray(h, d), n = Qu.ts.parseType(r, e.pid)) { case "pes": if (a = Qu.ts.parsePesType(r, e.table), s = Qu.ts.parsePayloadUnitStartIndicator(r), "video" === a && (s && !p && (o = Qu.ts.parsePesTime(r), o && (o.type = "video", i.video.push(o), p = !0)), !i.firstKeyFrame)) { if (s && 0 !== f.size) { for (u = new Uint8Array(f.size), l = 0; f.data.length;)c = f.data.shift(), u.set(c, l), l += c.byteLength; Qu.ts.videoPacketContainsKeyFrame(u) && (i.firstKeyFrame = Qu.ts.parsePesTime(u), i.firstKeyFrame.type = "video"), f.size = 0 } f.data.push(r), f.size += r.byteLength } }if (p && i.firstKeyFrame) break; h += tl, d += tl } for (d = t.byteLength, h = d - tl, p = !1; h >= 0;)if (t[h] !== el || t[d] !== el) h-- , d--; else { switch (r = t.subarray(h, d), n = Qu.ts.parseType(r, e.pid)) { case "pes": a = Qu.ts.parsePesType(r, e.table), s = Qu.ts.parsePayloadUnitStartIndicator(r), "video" === a && s && (o = Qu.ts.parsePesTime(r), o && (o.type = "video", i.video.push(o), p = !0)) }if (p) break; h -= tl, d -= tl } }, sl = function (t, e) { if (t.audio && t.audio.length) { var i = e; "undefined" == typeof i && (i = t.audio[0].dts), t.audio.forEach(function (t) { t.dts = Ju(t.dts, i), t.pts = Ju(t.pts, i), t.dtsTime = t.dts / Zu, t.ptsTime = t.pts / Zu }) } if (t.video && t.video.length) { var r = e; if ("undefined" == typeof r && (r = t.video[0].dts), t.video.forEach(function (t) { t.dts = Ju(t.dts, r), t.pts = Ju(t.pts, r), t.dtsTime = t.dts / Zu, t.ptsTime = t.pts / Zu }), t.firstKeyFrame) { var n = t.firstKeyFrame; n.dts = Ju(n.dts, r), n.pts = Ju(n.pts, r), n.dtsTime = n.dts / Zu, n.ptsTime = n.dts / Zu } } }, ol = function (t) { for (var e, i = !1, r = 0, n = null, a = null, s = 0, o = 0; t.length - o >= 3;) { var u = Qu.aac.parseType(t, o); switch (u) { case "timed-metadata": if (t.length - o < 10) { i = !0; break } if (s = Qu.aac.parseId3TagSize(t, o), s > t.length) { i = !0; break } null === a && (e = t.subarray(o, o + s), a = Qu.aac.parseAacTimestamp(e)), o += s; break; case "audio": if (t.length - o < 7) { i = !0; break } if (s = Qu.aac.parseAdtsSize(t, o), s > t.length) { i = !0; break } null === n && (e = t.subarray(o, o + s), n = Qu.aac.parseSampleRate(e)), r++ , o += s; break; default: o++ }if (i) return null } if (null === n || null === a) return null; var l = Zu / n, c = { audio: [{ type: "audio", dts: a, pts: a }, { type: "audio", dts: a + 1024 * r * l, pts: a + 1024 * r * l }] }; return c }, ul = function (t) { var e = { pid: null, table: null }, i = {}; rl(t, e); for (var r in e.table) if (e.table.hasOwnProperty(r)) { var n = e.table[r]; switch (n) { case du.H264_STREAM_TYPE: i.video = [], al(t, e, i), 0 === i.video.length && delete i.video; break; case du.ADTS_STREAM_TYPE: i.audio = [], nl(t, e, i), 0 === i.audio.length && delete i.audio } } return i }, ll = function (t, e) { var i, r = il(t); return i = r ? ol(t) : ul(t), i && (i.audio || i.video) ? (sl(i, e), i) : null }, cl = { inspect: ll }, hl = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, dl = function () { function t(t, e) { for (var i = 0; i < e.length; i++) { var r = e[i]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } return function (e, i, r) { return i && t(e.prototype, i), r && t(e, r), e } }(), pl = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + ("undefined" == typeof e ? "undefined" : De(e))); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e) }, fl = function (t, e) { if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !e || "object" !== ("undefined" == typeof e ? "undefined" : De(e)) && "function" != typeof e ? t : e }, ml = function () { var t = [[[], [], [], [], []], [[], [], [], [], []]], e = t[0], i = t[1], r = e[4], n = i[4], a = void 0, s = void 0, o = void 0, u = [], l = [], c = void 0, h = void 0, d = void 0, p = void 0, f = void 0, m = void 0; for (a = 0; 256 > a; a++)l[(u[a] = a << 1 ^ 283 * (a >> 7)) ^ a] = a; for (s = o = 0; !r[s]; s ^= c || 1, o = l[o] || 1)for (p = o ^ o << 1 ^ o << 2 ^ o << 3 ^ o << 4, p = p >> 8 ^ 255 & p ^ 99, r[s] = p, n[p] = s, d = u[h = u[c = u[s]]], m = 16843009 * d ^ 65537 * h ^ 257 * c ^ 16843008 * s, f = 257 * u[p] ^ 16843008 * p, a = 0; 4 > a; a++)e[a][s] = f = f << 24 ^ f >>> 8, i[a][p] = m = m << 24 ^ m >>> 8; for (a = 0; 5 > a; a++)e[a] = e[a].slice(0), i[a] = i[a].slice(0); return t }, gl = null, yl = function () { function t(e) { hl(this, t), gl || (gl = ml()), this._tables = [[gl[0][0].slice(), gl[0][1].slice(), gl[0][2].slice(), gl[0][3].slice(), gl[0][4].slice()], [gl[1][0].slice(), gl[1][1].slice(), gl[1][2].slice(), gl[1][3].slice(), gl[1][4].slice()]]; var i = void 0, r = void 0, n = void 0, a = void 0, s = void 0, o = this._tables[0][4], u = this._tables[1], l = e.length, c = 1; if (4 !== l && 6 !== l && 8 !== l) throw new Error("Invalid aes key size"); for (a = e.slice(0), s = [], this._key = [a, s], i = l; 4 * l + 28 > i; i++)n = a[i - 1], (i % l === 0 || 8 === l && i % l === 4) && (n = o[n >>> 24] << 24 ^ o[n >> 16 & 255] << 16 ^ o[n >> 8 & 255] << 8 ^ o[255 & n], i % l === 0 && (n = n << 8 ^ n >>> 24 ^ c << 24, c = c << 1 ^ 283 * (c >> 7))), a[i] = a[i - l] ^ n; for (r = 0; i; r++ , i--)n = a[3 & r ? i : i - 4], 4 >= i || 4 > r ? s[r] = n : s[r] = u[0][o[n >>> 24]] ^ u[1][o[n >> 16 & 255]] ^ u[2][o[n >> 8 & 255]] ^ u[3][o[255 & n]] } return t.prototype.decrypt = function (t, e, i, r, n, a) { var s = this._key[1], o = t ^ s[0], u = r ^ s[1], l = i ^ s[2], c = e ^ s[3], h = void 0, d = void 0, p = void 0, f = s.length / 4 - 2, m = void 0, g = 4, y = this._tables[1], v = y[0], _ = y[1], b = y[2], T = y[3], S = y[4]; for (m = 0; f > m; m++)h = v[o >>> 24] ^ _[u >> 16 & 255] ^ b[l >> 8 & 255] ^ T[255 & c] ^ s[g], d = v[u >>> 24] ^ _[l >> 16 & 255] ^ b[c >> 8 & 255] ^ T[255 & o] ^ s[g + 1], p = v[l >>> 24] ^ _[c >> 16 & 255] ^ b[o >> 8 & 255] ^ T[255 & u] ^ s[g + 2], c = v[c >>> 24] ^ _[o >> 16 & 255] ^ b[u >> 8 & 255] ^ T[255 & l] ^ s[g + 3], g += 4, o = h, u = d, l = p; for (m = 0; 4 > m; m++)n[(3 & -m) + a] = S[o >>> 24] << 24 ^ S[u >> 16 & 255] << 16 ^ S[l >> 8 & 255] << 8 ^ S[255 & c] ^ s[g++], h = o, o = u, u = l, l = c, c = h }, t }(), vl = function () { function t() { hl(this, t), this.listeners = {} } return t.prototype.on = function (t, e) { this.listeners[t] || (this.listeners[t] = []), this.listeners[t].push(e) }, t.prototype.off = function (t, e) { if (!this.listeners[t]) return !1; var i = this.listeners[t].indexOf(e); return this.listeners[t].splice(i, 1), i > -1 }, t.prototype.trigger = function (t) { var e = this.listeners[t]; if (e) if (2 === arguments.length) for (var i = e.length, r = 0; i > r; ++r)e[r].call(this, arguments[1]); else for (var n = Array.prototype.slice.call(arguments, 1), a = e.length, s = 0; a > s; ++s)e[s].apply(this, n) }, t.prototype.dispose = function () { this.listeners = {} }, t.prototype.pipe = function (t) { this.on("data", function (e) { t.push(e) }) }, t }(), _l = function (t) { function e() { hl(this, e); var i = fl(this, t.call(this, vl)); return i.jobs = [], i.delay = 1, i.timeout_ = null, i } return pl(e, t), e.prototype.processJob_ = function () { this.jobs.shift()(), this.jobs.length ? this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay) : this.timeout_ = null }, e.prototype.push = function (t) { this.jobs.push(t), this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }, e }(vl), bl = function (t) { return t << 24 | (65280 & t) << 8 | (16711680 & t) >> 8 | t >>> 24 }, Tl = function (t, e, i) { var r = new Int32Array(t.buffer, t.byteOffset, t.byteLength >> 2), n = new yl(Array.prototype.slice.call(e)), a = new Uint8Array(t.byteLength), s = new Int32Array(a.buffer), o = void 0, u = void 0, l = void 0, c = void 0, h = void 0, d = void 0, p = void 0, f = void 0, m = void 0; for (o = i[0], u = i[1], l = i[2], c = i[3], m = 0; m < r.length; m += 4)h = bl(r[m]), d = bl(r[m + 1]), p = bl(r[m + 2]), f = bl(r[m + 3]), n.decrypt(h, d, p, f, s, m), s[m] = bl(s[m] ^ o), s[m + 1] = bl(s[m + 1] ^ u), s[m + 2] = bl(s[m + 2] ^ l), s[m + 3] = bl(s[m + 3] ^ c), o = h, u = d, l = p, c = f; return a }, Sl = function () { function t(e, i, r, n) { hl(this, t); var a = t.STEP, s = new Int32Array(e.buffer), o = new Uint8Array(e.byteLength), u = 0; for (this.asyncStream_ = new _l, this.asyncStream_.push(this.decryptChunk_(s.subarray(u, u + a), i, r, o)), u = a; u < s.length; u += a)r = new Uint32Array([bl(s[u - 4]), bl(s[u - 3]), bl(s[u - 2]), bl(s[u - 1])]), this.asyncStream_.push(this.decryptChunk_(s.subarray(u, u + a), i, r, o)); this.asyncStream_.push(function () { n(null, de(o)) }) } return t.prototype.decryptChunk_ = function (t, e, i, r) { return function () { var n = Tl(t, e, i); r.set(n, t.byteOffset) } }, dl(t, null, [{ key: "STEP", get: function () { return 32e3 } }]), t }(), kl = function (t, e) { return /^[a-z]+:/i.test(e) ? e : (/\/\//i.test(t) || (t = Us.buildAbsoluteURL(Te.location.href, t)), Us.buildAbsoluteURL(t, e)) }, El = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, Cl = function () { function t(t, e) { for (var i = 0; i < e.length; i++) { var r = e[i]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } return function (e, i, r) { return i && t(e.prototype, i), r && t(e, r), e } }(), wl = function Kd(t, e, i) { null === t && (t = Function.prototype); var r = Object.getOwnPropertyDescriptor(t, e); if (void 0 === r) { var n = Object.getPrototypeOf(t); return null === n ? void 0 : Kd(n, e, i) } if ("value" in r) return r.value; var a = r.get; if (void 0 !== a) return a.call(i) }, Al = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + ("undefined" == typeof e ? "undefined" : De(e))); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e) }, Ll = function (t, e) { if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !e || "object" !== ("undefined" == typeof e ? "undefined" : De(e)) && "function" != typeof e ? t : e }, Pl = function () { function t(t, e) { var i = [], r = !0, n = !1, a = void 0; try { for (var s, o = t[Symbol.iterator](); !(r = (s = o.next()).done) && (i.push(s.value), !e || i.length !== e); r = !0); } catch (u) { n = !0, a = u } finally { try { !r && o["return"] && o["return"]() } finally { if (n) throw a } } return i } return function (e, i) { if (Array.isArray(e)) return e; if (Symbol.iterator in Object(e)) return t(e, i); throw new TypeError("Invalid attempt to destructure non-iterable instance") } }(), Ol = ce.mergeOptions, Il = ce.EventTarget, xl = ce.log, Dl = function (t, e) { ["AUDIO", "SUBTITLES"].forEach(function (i) { for (var r in t.mediaGroups[i]) for (var n in t.mediaGroups[i][r]) { var a = t.mediaGroups[i][r][n]; e(a, i, r, n) } }) }, Rl = function (t, e, i) { var r = e.slice(); i = i || 0; for (var n = Math.min(t.length, e.length + i), a = i; n > a; a++)r[a - i] = Ol(t[a], r[a - i]); return r }, Ml = function (t, e) { t.resolvedUri || (t.resolvedUri = kl(e, t.uri)), t.key && !t.key.resolvedUri && (t.key.resolvedUri = kl(e, t.key.uri)), t.map && !t.map.resolvedUri && (t.map.resolvedUri = kl(e, t.map.uri)) }, Ul = function (t, e) { var i = Ol(t, {}), r = i.playlists[e.uri]; if (!r) return null; if (r.segments && e.segments && r.segments.length === e.segments.length && r.mediaSequence === e.mediaSequence) return null; var n = Ol(r, e); r.segments && (n.segments = Rl(r.segments, e.segments, e.mediaSequence - r.mediaSequence)), n.segments.forEach(function (t) { Ml(t, n.resolvedUri) }); for (var a = 0; a < i.playlists.length; a++)i.playlists[a].uri === e.uri && (i.playlists[a] = n); return i.playlists[e.uri] = n, i }, Nl = function (t) { for (var e = t.playlists.length; e--;) { var i = t.playlists[e]; t.playlists[i.uri] = i, i.resolvedUri = kl(t.uri, i.uri), i.id = e, i.attributes || (i.attributes = {}, xl.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")) } }, Bl = function (t) { Dl(t, function (e) { e.uri && (e.resolvedUri = kl(t.uri, e.uri)) }) }, jl = function (t, e) { var i = t.segments[t.segments.length - 1], r = void 0; return r = e && i && i.duration ? 1e3 * i.duration : 500 * (t.targetDuration || 10) }, Fl = function (t) { function e(t, i, r) { El(this, e); var n = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)); if (n.srcUrl = t, n.hls_ = i, n.withCredentials = r, !n.srcUrl) throw new Error("A non-empty playlist URL is required"); return n.state = "HAVE_NOTHING", n.on("mediaupdatetimeout", function () { "HAVE_METADATA" === n.state && (n.state = "HAVE_CURRENT_METADATA", n.request = n.hls_.xhr({ uri: kl(n.master.uri, n.media().uri), withCredentials: n.withCredentials }, function (t, e) { return n.request ? t ? n.playlistRequestError(n.request, n.media().uri, "HAVE_METADATA") : void n.haveMetadata(n.request, n.media().uri) : void 0 })) }), n } return Al(e, t), Cl(e, [{ key: "playlistRequestError", value: function (t, e, i) { this.request = null, i && (this.state = i), this.error = { playlist: this.master.playlists[e], status: t.status, message: "HLS playlist request error at URL: " + e, responseText: t.responseText, code: t.status >= 500 ? 4 : 2 }, this.trigger("error") } }, { key: "haveMetadata", value: function (t, e) { var i = this; this.request = null, this.state = "HAVE_METADATA"; var r = new Gs; r.push(t.responseText), r.end(), r.manifest.uri = e, r.manifest.attributes = r.manifest.attributes || {}; var n = Ul(this.master, r.manifest); this.targetDuration = r.manifest.targetDuration, n ? (this.master = n, this.media_ = this.master.playlists[r.manifest.uri]) : this.trigger("playlistunchanged"), this.media().endList || (Te.clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = Te.setTimeout(function () { i.trigger("mediaupdatetimeout") }, jl(this.media(), !!n))), this.trigger("loadedplaylist") } }, { key: "dispose", value: function () { this.stopRequest(), Te.clearTimeout(this.mediaUpdateTimeout) } }, { key: "stopRequest", value: function () { if (this.request) { var t = this.request; this.request = null, t.onreadystatechange = null, t.abort() } } }, { key: "media", value: function (t) { var e = this; if (!t) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); var i = this.state; if ("string" == typeof t) { if (!this.master.playlists[t]) throw new Error("Unknown playlist URI: " + t); t = this.master.playlists[t] } var r = !this.media_ || t.uri !== this.media_.uri; if (this.master.playlists[t.uri].endList) return this.request && (this.request.onreadystatechange = null, this.request.abort(), this.request = null), this.state = "HAVE_METADATA", this.media_ = t, void (r && (this.trigger("mediachanging"), this.trigger("mediachange"))); if (r) { if (this.state = "SWITCHING_MEDIA", this.request) { if (kl(this.master.uri, t.uri) === this.request.url) return; this.request.onreadystatechange = null, this.request.abort(), this.request = null } this.media_ && this.trigger("mediachanging"), this.request = this.hls_.xhr({ uri: kl(this.master.uri, t.uri), withCredentials: this.withCredentials }, function (r, n) { if (e.request) { if (r) return e.playlistRequestError(e.request, t.uri, i); e.haveMetadata(n, t.uri), "HAVE_MASTER" === i ? e.trigger("loadedmetadata") : e.trigger("mediachange") } }) } } }, { key: "pause", value: function () { this.stopRequest(), Te.clearTimeout(this.mediaUpdateTimeout), "HAVE_NOTHING" === this.state && (this.started = !1), "SWITCHING_MEDIA" === this.state ? this.media_ ? this.state = "HAVE_METADATA" : this.state = "HAVE_MASTER" : "HAVE_CURRENT_METADATA" === this.state && (this.state = "HAVE_METADATA") } }, { key: "load", value: function (t) { var e = this; Te.clearTimeout(this.mediaUpdateTimeout); var i = this.media(); if (t) { var r = i ? i.targetDuration / 2 * 1e3 : 5e3; return void (this.mediaUpdateTimeout = Te.setTimeout(function () { return e.load() }, r)) } return this.started ? void (i && !i.endList ? this.trigger("mediaupdatetimeout") : this.trigger("loadedplaylist")) : void this.start() } }, { key: "start", value: function () { var t = this; this.started = !0, this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (e, i) { if (t.request) { if (t.request = null, e) return t.error = { status: i.status, message: "HLS playlist request error at URL: " + t.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); var r = new Gs; return r.push(i.responseText), r.end(), t.state = "HAVE_MASTER", r.manifest.uri = t.srcUrl, r.manifest.playlists ? (t.master = r.manifest, Nl(t.master), Bl(t.master), t.trigger("loadedplaylist"), void (t.request || t.media(r.manifest.playlists[0]))) : (t.master = { mediaGroups: { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, uri: Te.location.href, playlists: [{ uri: t.srcUrl, id: 0 }] }, t.master.playlists[t.srcUrl] = t.master.playlists[0], t.master.playlists[0].resolvedUri = t.srcUrl, t.master.playlists[0].attributes = t.master.playlists[0].attributes || {}, t.haveMetadata(i, t.srcUrl), t.trigger("loadedmetadata")) } }) } }]), e }(Il), Hl = ce.createTimeRange, Vl = function (t, e) { var i = 0, r = e - t.mediaSequence, n = t.segments[r]; if (n) { if ("undefined" != typeof n.start) return { result: n.start, precise: !0 }; if ("undefined" != typeof n.end) return { result: n.end - n.duration, precise: !0 } } for (; r--;) { if (n = t.segments[r], "undefined" != typeof n.end) return { result: i + n.end, precise: !0 }; if (i += n.duration, "undefined" != typeof n.start) return { result: i + n.start, precise: !0 } } return { result: i, precise: !1 } }, ql = function (t, e) { for (var i = 0, r = void 0, n = e - t.mediaSequence; n < t.segments.length; n++) { if (r = t.segments[n], "undefined" != typeof r.start) return { result: r.start - i, precise: !0 }; if (i += r.duration, "undefined" != typeof r.end) return { result: r.end - i, precise: !0 } } return { result: -1, precise: !1 } }, Wl = function (t, e, i) { var r = void 0, n = void 0; return "undefined" == typeof e && (e = t.mediaSequence + t.segments.length), e < t.mediaSequence ? 0 : (r = Vl(t, e), r.precise ? r.result : (n = ql(t, e), n.precise ? n.result : r.result + i)) }, zl = function (t, e, i) { if (!t) return 0; if ("number" != typeof i && (i = 0), "undefined" == typeof e) { if (t.totalDuration) return t.totalDuration; if (!t.endList) return Te.Infinity } return Wl(t, e, i) }, Gl = function (t, e, i) { var r = 0; if (e > i) { var n = [i, e]; e = n[0], i = n[1] } if (0 > e) { for (var a = e; a < Math.min(0, i); a++)r += t.targetDuration; e = 0 } for (var s = e; i > s; s++)r += t.segments[s].duration; return r }, Xl = function (t) { if (!t.segments.length) return 0; for (var e = t.segments.length - 1, i = t.segments[e].duration || t.targetDuration, r = i + 2 * t.targetDuration; e-- && (i += t.segments[e].duration, !(i >= r));); return Math.max(0, e) }, Yl = function (t, e, i) { if (!t || !t.segments) return null; if (t.endList) return zl(t); if (null === e) return null; e = e || 0; var r = i ? Xl(t) : t.segments.length; return Wl(t, t.mediaSequence + r, e) }, $l = function (t, e) { var i = !0, r = e || 0, n = Yl(t, e, i); return null === n ? Hl() : Hl(r, n) }, Kl = function (t) { return t - Math.floor(t) === 0 }, Jl = function (t, e) { if (Kl(e)) return e + .1 * t; for (var i = e.toString().split(".")[1].length, r = 1; i >= r; r++) { var n = Math.pow(10, r), a = e * n; if (Kl(a) || r === i) return (a + t) / n } }, Ql = Jl.bind(null, 1), Zl = Jl.bind(null, -1), tc = function (t, e, i, r) { var n = void 0, a = void 0, s = t.segments.length, o = e - r; if (0 > o) { if (i > 0) for (n = i - 1; n >= 0; n--)if (a = t.segments[n], o += Zl(a.duration), o > 0) return { mediaIndex: n, startTime: r - Gl(t, i, n) }; return { mediaIndex: 0, startTime: e } } if (0 > i) { for (n = i; 0 > n; n++)if (o -= t.targetDuration, 0 > o) return { mediaIndex: 0, startTime: e }; i = 0 } for (n = i; s > n; n++)if (a = t.segments[n], o -= Ql(a.duration), 0 > o) return { mediaIndex: n, startTime: r + Gl(t, i, n) }; return { mediaIndex: s - 1, startTime: e } }, ec = function (t) { return t.excludeUntil && t.excludeUntil > Date.now() }, ic = function (t) { return t.excludeUntil && t.excludeUntil === 1 / 0 }, rc = function (t) { var e = ec(t); return !t.disabled && !e }, nc = function (t) { return t.disabled }, ac = function (t) { for (var e = 0; e < t.segments.length; e++)if (t.segments[e].key) return !0; return !1 }, sc = function (t) { for (var e = 0; e < t.segments.length; e++)if (t.segments[e].map) return !0; return !1 }, oc = function (t, e) { return e.attributes && e.attributes[t] }, uc = function (t, e, i) { var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0; if (!oc("BANDWIDTH", i)) return NaN; var n = t * i.attributes.BANDWIDTH; return (n - 8 * r) / e }, lc = function (t, e) { if (1 === t.playlists.length) return !0; var i = e.attributes.BANDWIDTH || Number.MAX_VALUE; return 0 === t.playlists.filter(function (t) { return rc(t) ? (t.attributes.BANDWIDTH || 0) < i : !1 }).length }, cc = { duration: zl, seekable: $l, safeLiveIndex: Xl, getMediaInfoForTime: tc, isEnabled: rc, isDisabled: nc, isBlacklisted: ec, isIncompatible: ic, playlistEnd: Yl, isAes: ac, isFmp4: sc, hasAttribute: oc, estimateSegmentRequestTime: uc, isLowestEnabledRendition: lc }, hc = ce.xhr, dc = ce.mergeOptions, pc = function () {
    var t = function e(t, i) {
      t = dc({ timeout: 45e3 }, t); var r = e.beforeRequest || ce.Hls.xhr.beforeRequest; if (r && "function" == typeof r) { var n = r(t); n && (t = n) } var a = hc(t, function (t, e) {
        var r = a.response; !t && r && (a.responseTime = Date.now(),
          a.roundTripTime = a.responseTime - a.requestTime, a.bytesReceived = r.byteLength || r.length, a.bandwidth || (a.bandwidth = Math.floor(a.bytesReceived / a.roundTripTime * 8 * 1e3))), e.headers && (a.responseHeaders = e.headers), t && "ETIMEDOUT" === t.code && (a.timedout = !0), t || a.aborted || 200 === e.statusCode || 206 === e.statusCode || 0 === e.statusCode || (t = new Error("XHR Failed with a response of: " + (a && (r || a.responseText)))), i(t, a)
      }), s = a.abort; return a.abort = function () { return a.aborted = !0, s.apply(a, arguments) }, a.uri = t.uri, a.requestTime = Date.now(), a
    }; return t
  }, fc = function (t, e) { return t.start(e) + "-" + t.end(e) }, mc = function (t, e) { var i = t.toString(16); return "00".substring(0, 2 - i.length) + i + (e % 2 ? " " : "") }, gc = function (t) { return t >= 32 && 126 > t ? String.fromCharCode(t) : "." }, yc = function (t) { var e = {}; return Object.keys(t).forEach(function (i) { var r = t[i]; ArrayBuffer.isView(r) ? e[i] = { bytes: r.buffer, byteOffset: r.byteOffset, byteLength: r.byteLength } : e[i] = r }), e }, vc = function (t) { var e = t.byterange || { length: 1 / 0, offset: 0 }; return [e.length, e.offset, t.resolvedUri].join(",") }, _c = function (t) { for (var e = Array.prototype.slice.call(t), i = 16, r = "", n = void 0, a = void 0, s = 0; s < e.length / i; s++)n = e.slice(s * i, s * i + i).map(mc).join(""), a = e.slice(s * i, s * i + i).map(gc).join(""), r += n + " " + a + "\n"; return r }, bc = function (t) { var e = t.bytes; return _c(e) }, Tc = function (t) { var e = "", i = void 0; for (i = 0; i < t.length; i++)e += fc(t, i) + " "; return e }, Sc = Object.freeze({ createTransferableMessage: yc, initSegmentId: vc, hexDump: _c, tagDump: bc, textRanges: Tc }), kc = 1 / 30, Ec = 3 * kc, Cc = function (t, e) { var i = [], r = void 0; if (t && t.length) for (r = 0; r < t.length; r++)e(t.start(r), t.end(r)) && i.push([t.start(r), t.end(r)]); return ce.createTimeRanges(i) }, wc = function (t, e) { return Cc(t, function (t, i) { return e >= t - kc && i + kc >= e }) }, Ac = function (t, e) { return Cc(t, function (t) { return t - kc >= e }) }, Lc = function (t) { if (t.length < 2) return ce.createTimeRanges(); for (var e = [], i = 1; i < t.length; i++) { var r = t.end(i - 1), n = t.start(i); e.push([r, n]) } return ce.createTimeRanges(e) }, Pc = function (t) { var e = []; if (!t || !t.length) return ""; for (var i = 0; i < t.length; i++)e.push(t.start(i) + " => " + t.end(i)); return e.join(", ") }, Oc = function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, r = t.length ? t.end(t.length - 1) : 0; return (r - e) / i }, Ic = function (t) { for (var e = [], i = 0; i < t.length; i++)e.push({ start: t.start(i), end: t.end(i) }); return e }, xc = function (t, e, i) { var r = e.player_; if (i.captions && i.captions.length) { t.inbandTextTracks_ || (t.inbandTextTracks_ = {}); for (var n in i.captionStreams) if (!t.inbandTextTracks_[n]) { r.tech_.trigger({ type: "usage", name: "hls-608" }); var a = r.textTracks().getTrackById(n); a ? t.inbandTextTracks_[n] = a : t.inbandTextTracks_[n] = r.addRemoteTextTrack({ kind: "captions", id: n, label: n }, !1).track } } i.metadata && i.metadata.length && !t.metadataTrack_ && (t.metadataTrack_ = r.addRemoteTextTrack({ kind: "metadata", label: "Timed Metadata" }, !1).track, t.metadataTrack_.inBandMetadataTrackDispatchType = i.metadata.dispatchType) }, Dc = function (t, e, i) { var r = void 0, n = void 0; if (i && i.cues) for (r = i.cues.length; r--;)n = i.cues[r], n.startTime <= e && n.endTime >= t && i.removeCue(n) }, Rc = function (t) { Object.defineProperties(t.frame, { id: { get: function () { return ce.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."), t.value.key } }, value: { get: function () { return ce.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."), t.value.data } }, privateData: { get: function () { return ce.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."), t.value.data } } }) }, Mc = function (t) { var e = void 0; return e = isNaN(t) || Math.abs(t) === 1 / 0 ? Number.MAX_VALUE : t }, Uc = function (t, e, i) { var r = Te.WebKitDataCue || Te.VTTCue; if (e && e.forEach(function (t) { var e = t.stream; this.inbandTextTracks_[e].addCue(new r(t.startTime + this.timestampOffset, t.endTime + this.timestampOffset, t.text)) }, t), i) { var n = Mc(t.mediaSource_.duration); if (i.forEach(function (t) { var e = t.cueTime + this.timestampOffset; t.frames.forEach(function (t) { var i = new r(e, e, t.value || t.url || t.data || ""); i.frame = t, i.value = t, Rc(i), this.metadataTrack_.addCue(i) }, this) }, t), t.metadataTrack_ && t.metadataTrack_.cues && t.metadataTrack_.cues.length) { for (var a = t.metadataTrack_.cues, s = [], o = 0; o < a.length; o++)a[o] && s.push(a[o]); var u = s.reduce(function (t, e) { var i = t[e.startTime] || []; return i.push(e), t[e.startTime] = i, t }, {}), l = Object.keys(u).sort(function (t, e) { return Number(t) - Number(e) }); l.forEach(function (t, e) { var i = u[t], r = Number(l[e + 1]) || n; i.forEach(function (t) { t.endTime = r }) }) } } }, Nc = "undefined" != typeof window ? window : {}, Bc = "undefined" == typeof Symbol ? "__target" : Symbol(), jc = "application/javascript", Fc = Nc.BlobBuilder || Nc.WebKitBlobBuilder || Nc.MozBlobBuilder || Nc.MSBlobBuilder, Hc = Nc.URL || Nc.webkitURL || Hc && Hc.msURL, Vc = Nc.Worker; if (Vc) { var qc, Wc = fe("self.onmessage = function () {}"), zc = new Uint8Array(1); try { qc = new Vc(Wc), qc.postMessage(zc, [zc.buffer]) } catch (Gc) { Vc = null } finally { Hc.revokeObjectURL(Wc), qc && qc.terminate() } } var Xc = new pe("./transmuxer-worker.worker.js", function (t, e) {
    var i = this; (function () {
      var e, r = "undefined" != typeof t ? t : "undefined" != typeof global ? global : "undefined" != typeof i ? i : {}; e = "undefined" != typeof t ? t : "undefined" != typeof r ? r : "undefined" != typeof i ? i : {}; var n, a, s, o, u, l, c, h, d, p, f, m, g, y, v, _, b, T, S, k, E, C, w, A, L, P, O, I, x, D, R, M, U, N, B, j, F = e, H = Math.pow(2, 32) - 1; !function () { var t; if (w = { avc1: [], avcC: [], btrt: [], dinf: [], dref: [], esds: [], ftyp: [], hdlr: [], mdat: [], mdhd: [], mdia: [], mfhd: [], minf: [], moof: [], moov: [], mp4a: [], mvex: [], mvhd: [], sdtp: [], smhd: [], stbl: [], stco: [], stsc: [], stsd: [], stsz: [], stts: [], styp: [], tfdt: [], tfhd: [], traf: [], trak: [], trun: [], trex: [], tkhd: [], vmhd: [] }, "undefined" != typeof Uint8Array) { for (t in w) w.hasOwnProperty(t) && (w[t] = [t.charCodeAt(0), t.charCodeAt(1), t.charCodeAt(2), t.charCodeAt(3)]); A = new Uint8Array(["i".charCodeAt(0), "s".charCodeAt(0), "o".charCodeAt(0), "m".charCodeAt(0)]), P = new Uint8Array(["a".charCodeAt(0), "v".charCodeAt(0), "c".charCodeAt(0), "1".charCodeAt(0)]), L = new Uint8Array([0, 0, 0, 1]), O = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0]), I = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0]), x = { video: O, audio: I }, M = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]), R = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), U = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), N = U, B = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]), j = U, D = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]) } }(), n = function (t) { var e, i, r, n = [], a = 0; for (e = 1; e < arguments.length; e++)n.push(arguments[e]); for (e = n.length; e--;)a += n[e].byteLength; for (i = new Uint8Array(a + 8), r = new DataView(i.buffer, i.byteOffset, i.byteLength), r.setUint32(0, i.byteLength), i.set(t, 4), e = 0, a = 8; e < n.length; e++)i.set(n[e], a), a += n[e].byteLength; return i }, a = function () { return n(w.dinf, n(w.dref, M)) }, s = function (t) { return n(w.esds, new Uint8Array([0, 0, 0, 0, 3, 25, 0, 0, 0, 4, 17, 64, 21, 0, 6, 0, 0, 0, 218, 192, 0, 0, 218, 192, 5, 2, t.audioobjecttype << 3 | t.samplingfrequencyindex >>> 1, t.samplingfrequencyindex << 7 | t.channelcount << 3, 6, 1, 2])) }, o = function () { return n(w.ftyp, A, L, A, P) }, _ = function (t) { return n(w.hdlr, x[t]) }, u = function (t) { return n(w.mdat, t) }, v = function (t) { var e = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 1, 95, 144, t.duration >>> 24 & 255, t.duration >>> 16 & 255, t.duration >>> 8 & 255, 255 & t.duration, 85, 196, 0, 0]); return t.samplerate && (e[12] = t.samplerate >>> 24 & 255, e[13] = t.samplerate >>> 16 & 255, e[14] = t.samplerate >>> 8 & 255, e[15] = 255 & t.samplerate), n(w.mdhd, e) }, y = function (t) { return n(w.mdia, v(t), _(t.type), c(t)) }, l = function (t) { return n(w.mfhd, new Uint8Array([0, 0, 0, 0, (4278190080 & t) >> 24, (16711680 & t) >> 16, (65280 & t) >> 8, 255 & t])) }, c = function (t) { return n(w.minf, "video" === t.type ? n(w.vmhd, D) : n(w.smhd, R), a(), T(t)) }, h = function (t, e) { for (var i = [], r = e.length; r--;)i[r] = k(e[r]); return n.apply(null, [w.moof, l(t)].concat(i)) }, d = function (t) { for (var e = t.length, i = []; e--;)i[e] = m(t[e]); return n.apply(null, [w.moov, f(4294967295)].concat(i).concat(p(t))) }, p = function (t) { for (var e = t.length, i = []; e--;)i[e] = E(t[e]); return n.apply(null, [w.mvex].concat(i)) }, f = function (t) { var e = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 1, 95, 144, (4278190080 & t) >> 24, (16711680 & t) >> 16, (65280 & t) >> 8, 255 & t, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255]); return n(w.mvhd, e) }, b = function (t) { var e, i, r = t.samples || [], a = new Uint8Array(4 + r.length); for (i = 0; i < r.length; i++)e = r[i].flags, a[i + 4] = e.dependsOn << 4 | e.isDependedOn << 2 | e.hasRedundancy; return n(w.sdtp, a) }, T = function (t) { return n(w.stbl, S(t), n(w.stts, j), n(w.stsc, N), n(w.stsz, B), n(w.stco, U)) }, function () { var t, e; S = function (i) { return n(w.stsd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]), "video" === i.type ? t(i) : e(i)) }, t = function (t) { var e, i = t.sps || [], r = t.pps || [], a = [], s = []; for (e = 0; e < i.length; e++)a.push((65280 & i[e].byteLength) >>> 8), a.push(255 & i[e].byteLength), a = a.concat(Array.prototype.slice.call(i[e])); for (e = 0; e < r.length; e++)s.push((65280 & r[e].byteLength) >>> 8), s.push(255 & r[e].byteLength), s = s.concat(Array.prototype.slice.call(r[e])); return n(w.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & t.width) >> 8, 255 & t.width, (65280 & t.height) >> 8, 255 & t.height, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106, 115, 45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 17, 17]), n(w.avcC, new Uint8Array([1, t.profileIdc, t.profileCompatibility, t.levelIdc, 255].concat([i.length]).concat(a).concat([r.length]).concat(s))), n(w.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192]))) }, e = function (t) { return n(w.mp4a, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & t.channelcount) >> 8, 255 & t.channelcount, (65280 & t.samplesize) >> 8, 255 & t.samplesize, 0, 0, 0, 0, (65280 & t.samplerate) >> 8, 255 & t.samplerate, 0, 0]), s(t)) } }(), g = function (t) { var e = new Uint8Array([0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, (4278190080 & t.id) >> 24, (16711680 & t.id) >> 16, (65280 & t.id) >> 8, 255 & t.id, 0, 0, 0, 0, (4278190080 & t.duration) >> 24, (16711680 & t.duration) >> 16, (65280 & t.duration) >> 8, 255 & t.duration, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, (65280 & t.width) >> 8, 255 & t.width, 0, 0, (65280 & t.height) >> 8, 255 & t.height, 0, 0]); return n(w.tkhd, e) }, k = function (t) { var e, i, r, a, s, o, u; return e = n(w.tfhd, new Uint8Array([0, 0, 0, 58, (4278190080 & t.id) >> 24, (16711680 & t.id) >> 16, (65280 & t.id) >> 8, 255 & t.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])), o = Math.floor(t.baseMediaDecodeTime / (H + 1)), u = Math.floor(t.baseMediaDecodeTime % (H + 1)), i = n(w.tfdt, new Uint8Array([1, 0, 0, 0, o >>> 24 & 255, o >>> 16 & 255, o >>> 8 & 255, 255 & o, u >>> 24 & 255, u >>> 16 & 255, u >>> 8 & 255, 255 & u])), s = 92, "audio" === t.type ? (r = C(t, s), n(w.traf, e, i, r)) : (a = b(t), r = C(t, a.length + s), n(w.traf, e, i, r, a)) }, m = function (t) { return t.duration = t.duration || 4294967295, n(w.trak, g(t), y(t)) }, E = function (t) { var e = new Uint8Array([0, 0, 0, 0, (4278190080 & t.id) >> 24, (16711680 & t.id) >> 16, (65280 & t.id) >> 8, 255 & t.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1]); return "video" !== t.type && (e[e.length - 1] = 0), n(w.trex, e) }, function () { var t, e, i; i = function (t, e) { var i = 0, r = 0, n = 0, a = 0; return t.length && (void 0 !== t[0].duration && (i = 1), void 0 !== t[0].size && (r = 2), void 0 !== t[0].flags && (n = 4), void 0 !== t[0].compositionTimeOffset && (a = 8)), [0, 0, i | r | n | a, 1, (4278190080 & t.length) >>> 24, (16711680 & t.length) >>> 16, (65280 & t.length) >>> 8, 255 & t.length, (4278190080 & e) >>> 24, (16711680 & e) >>> 16, (65280 & e) >>> 8, 255 & e] }, e = function (t, e) { var r, a, s, o; for (a = t.samples || [], e += 20 + 16 * a.length, r = i(a, e), o = 0; o < a.length; o++)s = a[o], r = r.concat([(4278190080 & s.duration) >>> 24, (16711680 & s.duration) >>> 16, (65280 & s.duration) >>> 8, 255 & s.duration, (4278190080 & s.size) >>> 24, (16711680 & s.size) >>> 16, (65280 & s.size) >>> 8, 255 & s.size, s.flags.isLeading << 2 | s.flags.dependsOn, s.flags.isDependedOn << 6 | s.flags.hasRedundancy << 4 | s.flags.paddingValue << 1 | s.flags.isNonSyncSample, 61440 & s.flags.degradationPriority, 15 & s.flags.degradationPriority, (4278190080 & s.compositionTimeOffset) >>> 24, (16711680 & s.compositionTimeOffset) >>> 16, (65280 & s.compositionTimeOffset) >>> 8, 255 & s.compositionTimeOffset]); return n(w.trun, new Uint8Array(r)) }, t = function (t, e) { var r, a, s, o; for (a = t.samples || [], e += 20 + 8 * a.length, r = i(a, e), o = 0; o < a.length; o++)s = a[o], r = r.concat([(4278190080 & s.duration) >>> 24, (16711680 & s.duration) >>> 16, (65280 & s.duration) >>> 8, 255 & s.duration, (4278190080 & s.size) >>> 24, (16711680 & s.size) >>> 16, (65280 & s.size) >>> 8, 255 & s.size]); return n(w.trun, new Uint8Array(r)) }, C = function (i, r) { return "audio" === i.type ? t(i, r) : e(i, r) } }(); var V = { ftyp: o, mdat: u, moof: h, moov: d, initSegment: function (t) { var e, i = o(), r = d(t); return e = new Uint8Array(i.byteLength + r.byteLength), e.set(i), e.set(r, i.byteLength), e } }, q = function () { this.init = function () { var t = {}; this.on = function (e, i) { t[e] || (t[e] = []), t[e] = t[e].concat(i) }, this.off = function (e, i) { var r; return t[e] ? (r = t[e].indexOf(i), t[e] = t[e].slice(), t[e].splice(r, 1), r > -1) : !1 }, this.trigger = function (e) { var i, r, n, a; if (i = t[e]) if (2 === arguments.length) for (n = i.length, r = 0; n > r; ++r)i[r].call(this, arguments[1]); else { for (a = [], r = arguments.length, r = 1; r < arguments.length; ++r)a.push(arguments[r]); for (n = i.length, r = 0; n > r; ++r)i[r].apply(this, a) } }, this.dispose = function () { t = {} } } }; q.prototype.pipe = function (t) { return this.on("data", function (e) { t.push(e) }), this.on("done", function (e) { t.flush(e) }), t }, q.prototype.push = function (t) { this.trigger("data", t) }, q.prototype.flush = function (t) { this.trigger("done", t) }; var W = q, z = 4, G = 128, X = function (t) { for (var e = 0, i = { payloadType: -1, payloadSize: 0 }, r = 0, n = 0; e < t.byteLength && t[e] !== G;) { for (; 255 === t[e];)r += 255, e++; for (r += t[e++]; 255 === t[e];)n += 255, e++; if (n += t[e++], !i.payload && r === z) { i.payloadType = r, i.payloadSize = n, i.payload = t.subarray(e, e + n); break } e += n, r = 0, n = 0 } return i }, Y = function (t) { return 181 !== t.payload[0] ? null : 49 !== (t.payload[1] << 8 | t.payload[2]) ? null : "GA94" !== String.fromCharCode(t.payload[3], t.payload[4], t.payload[5], t.payload[6]) ? null : 3 !== t.payload[7] ? null : t.payload.subarray(8, t.payload.length - 1) }, $ = function (t, e) { var i, r, n, a, s = []; if (!(64 & e[0])) return s; for (r = 31 & e[0], i = 0; r > i; i++)n = 3 * i, a = { type: 3 & e[n + 2], pts: t }, 4 & e[n + 2] && (a.ccData = e[n + 3] << 8 | e[n + 4], s.push(a)); return s }, K = function be() { be.prototype.init.call(this), this.captionPackets_ = [], this.ccStreams_ = [new it(0, 0), new it(0, 1), new it(1, 0), new it(1, 1)], this.reset(), this.ccStreams_.forEach(function (t) { t.on("data", this.trigger.bind(this, "data")), t.on("done", this.trigger.bind(this, "done")) }, this) }; K.prototype = new W, K.prototype.push = function (t) { var e, i; if ("sei_rbsp" === t.nalUnitType && (e = X(t.escapedRBSP), e.payloadType === z && (i = Y(e)))) { if (t.dts < this.latestDts_) return void (this.ignoreNextEqualDts_ = !0); if (t.dts === this.latestDts_ && this.ignoreNextEqualDts_) return this.numSameDts_-- , void (this.numSameDts_ || (this.ignoreNextEqualDts_ = !1)); this.captionPackets_ = this.captionPackets_.concat($(t.pts, i)), this.latestDts_ !== t.dts && (this.numSameDts_ = 0), this.numSameDts_++ , this.latestDts_ = t.dts } }, K.prototype.flush = function () { return this.captionPackets_.length ? (this.captionPackets_.forEach(function (t, e) { t.presortIndex = e }), this.captionPackets_.sort(function (t, e) { return t.pts === e.pts ? t.presortIndex - e.presortIndex : t.pts - e.pts }), this.captionPackets_.forEach(function (t) { t.type < 2 && this.dispatchCea608Packet(t) }, this), this.captionPackets_.length = 0, void this.ccStreams_.forEach(function (t) { t.flush() }, this)) : void this.ccStreams_.forEach(function (t) { t.flush() }, this) }, K.prototype.reset = function () { this.latestDts_ = null, this.ignoreNextEqualDts_ = !1, this.numSameDts_ = 0, this.activeCea608Channel_ = [null, null], this.ccStreams_.forEach(function (t) { t.reset() }) }, K.prototype.dispatchCea608Packet = function (t) { this.setsChannel1Active(t) ? this.activeCea608Channel_[t.type] = 0 : this.setsChannel2Active(t) && (this.activeCea608Channel_[t.type] = 1), null !== this.activeCea608Channel_[t.type] && this.ccStreams_[(t.type << 1) + this.activeCea608Channel_[t.type]].push(t) }, K.prototype.setsChannel1Active = function (t) { return 4096 === (30720 & t.ccData) }, K.prototype.setsChannel2Active = function (t) { return 6144 === (30720 & t.ccData) }; var J = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 304: 174, 305: 176, 306: 189, 307: 191, 308: 8482, 309: 162, 310: 163, 311: 9834, 312: 224, 313: 160, 314: 232, 315: 226, 316: 234, 317: 238, 318: 244, 319: 251, 544: 193, 545: 201, 546: 211, 547: 218, 548: 220, 549: 252, 550: 8216, 551: 161, 552: 42, 553: 39, 554: 8212, 555: 169, 556: 8480, 557: 8226, 558: 8220, 559: 8221, 560: 192, 561: 194, 562: 199, 563: 200, 564: 202, 565: 203, 566: 235, 567: 206, 568: 207, 569: 239, 570: 212, 571: 217, 572: 249, 573: 219, 574: 171, 575: 187, 800: 195, 801: 227, 802: 205, 803: 204, 804: 236, 805: 210, 806: 242, 807: 213, 808: 245, 809: 123, 810: 125, 811: 92, 812: 94, 813: 95, 814: 124, 815: 126, 816: 196, 817: 228, 818: 214, 819: 246, 820: 223, 821: 165, 822: 164, 823: 9474, 824: 197, 825: 229, 826: 216, 827: 248, 828: 9484, 829: 9488, 830: 9492, 831: 9496 }, Q = function (t) { return null === t ? "" : (t = J[t] || t, String.fromCharCode(t)) }, Z = 14, tt = [4352, 4384, 4608, 4640, 5376, 5408, 5632, 5664, 5888, 5920, 4096, 4864, 4896, 5120, 5152], et = function () { for (var t = [], e = Z + 1; e--;)t.push(""); return t }, it = function Te(t, e) { Te.prototype.init.call(this), this.field_ = t || 0, this.dataChannel_ = e || 0, this.name_ = "CC" + ((this.field_ << 1 | this.dataChannel_) + 1), this.setConstants(), this.reset(), this.push = function (t) { var e, i, r, n, a; if (e = 32639 & t.ccData, e === this.lastControlCode_) return void (this.lastControlCode_ = null); if (4096 === (61440 & e) ? this.lastControlCode_ = e : e !== this.PADDING_ && (this.lastControlCode_ = null), r = e >>> 8, n = 255 & e, e !== this.PADDING_) if (e === this.RESUME_CAPTION_LOADING_) this.mode_ = "popOn"; else if (e === this.END_OF_CAPTION_) this.clearFormatting(t.pts), this.flushDisplayed(t.pts), i = this.displayed_, this.displayed_ = this.nonDisplayed_, this.nonDisplayed_ = i, this.startPts_ = t.pts; else if (e === this.ROLL_UP_2_ROWS_) this.topRow_ = Z - 1, this.mode_ = "rollUp"; else if (e === this.ROLL_UP_3_ROWS_) this.topRow_ = Z - 2, this.mode_ = "rollUp"; else if (e === this.ROLL_UP_4_ROWS_) this.topRow_ = Z - 3, this.mode_ = "rollUp"; else if (e === this.CARRIAGE_RETURN_) this.clearFormatting(t.pts), this.flushDisplayed(t.pts), this.shiftRowsUp_(), this.startPts_ = t.pts; else if (e === this.BACKSPACE_) "popOn" === this.mode_ ? this.nonDisplayed_[Z] = this.nonDisplayed_[Z].slice(0, -1) : this.displayed_[Z] = this.displayed_[Z].slice(0, -1); else if (e === this.ERASE_DISPLAYED_MEMORY_) this.flushDisplayed(t.pts), this.displayed_ = et(); else if (e === this.ERASE_NON_DISPLAYED_MEMORY_) this.nonDisplayed_ = et(); else if (e === this.RESUME_DIRECT_CAPTIONING_) this.mode_ = "paintOn"; else if (this.isSpecialCharacter(r, n)) r = (3 & r) << 8, a = Q(r | n), this[this.mode_](t.pts, a), this.column_++; else if (this.isExtCharacter(r, n)) "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[Z] = this.displayed_[Z].slice(0, -1), r = (3 & r) << 8, a = Q(r | n), this[this.mode_](t.pts, a), this.column_++; else if (this.isMidRowCode(r, n)) this.clearFormatting(t.pts), this[this.mode_](t.pts, " "), this.column_++ , 14 === (14 & n) && this.addFormatting(t.pts, ["i"]), 1 === (1 & n) && this.addFormatting(t.pts, ["u"]); else if (this.isOffsetControlCode(r, n)) this.column_ += 3 & n; else if (this.isPAC(r, n)) { var s = tt.indexOf(7968 & e); s !== this.row_ && (this.clearFormatting(t.pts), this.row_ = s), 1 & n && -1 === this.formatting_.indexOf("u") && this.addFormatting(t.pts, ["u"]), 16 === (16 & e) && (this.column_ = 4 * ((14 & e) >> 1)), this.isColorPAC(n) && 14 === (14 & n) && this.addFormatting(t.pts, ["i"]) } else this.isNormalChar(r) && (0 === n && (n = null), a = Q(r), a += Q(n), this[this.mode_](t.pts, a), this.column_ += a.length) } }; it.prototype = new W, it.prototype.flushDisplayed = function (t) { var e = this.displayed_.map(function (t) { return t.trim() }).join("\n").replace(/^\n+|\n+$/g, ""); e.length && this.trigger("data", { startPts: this.startPts_, endPts: t, text: e, stream: this.name_ }) }, it.prototype.reset = function () { this.mode_ = "popOn", this.topRow_ = 0, this.startPts_ = 0, this.displayed_ = et(), this.nonDisplayed_ = et(), this.lastControlCode_ = null, this.column_ = 0, this.row_ = Z, this.formatting_ = [] }, it.prototype.setConstants = function () { 0 === this.dataChannel_ ? (this.BASE_ = 16, this.EXT_ = 17, this.CONTROL_ = (20 | this.field_) << 8, this.OFFSET_ = 23) : 1 === this.dataChannel_ && (this.BASE_ = 24, this.EXT_ = 25, this.CONTROL_ = (28 | this.field_) << 8, this.OFFSET_ = 31), this.PADDING_ = 0, this.RESUME_CAPTION_LOADING_ = 32 | this.CONTROL_, this.END_OF_CAPTION_ = 47 | this.CONTROL_, this.ROLL_UP_2_ROWS_ = 37 | this.CONTROL_, this.ROLL_UP_3_ROWS_ = 38 | this.CONTROL_, this.ROLL_UP_4_ROWS_ = 39 | this.CONTROL_, this.CARRIAGE_RETURN_ = 45 | this.CONTROL_, this.RESUME_DIRECT_CAPTIONING_ = 41 | this.CONTROL_, this.BACKSPACE_ = 33 | this.CONTROL_, this.ERASE_DISPLAYED_MEMORY_ = 44 | this.CONTROL_, this.ERASE_NON_DISPLAYED_MEMORY_ = 46 | this.CONTROL_ }, it.prototype.isSpecialCharacter = function (t, e) { return t === this.EXT_ && e >= 48 && 63 >= e }, it.prototype.isExtCharacter = function (t, e) { return (t === this.EXT_ + 1 || t === this.EXT_ + 2) && e >= 32 && 63 >= e }, it.prototype.isMidRowCode = function (t, e) { return t === this.EXT_ && e >= 32 && 47 >= e }, it.prototype.isOffsetControlCode = function (t, e) { return t === this.OFFSET_ && e >= 33 && 35 >= e }, it.prototype.isPAC = function (t, e) { return t >= this.BASE_ && t < this.BASE_ + 8 && e >= 64 && 127 >= e }, it.prototype.isColorPAC = function (t) { return t >= 64 && 79 >= t || t >= 96 && 127 >= t }, it.prototype.isNormalChar = function (t) { return t >= 32 && 127 >= t }, it.prototype.addFormatting = function (t, e) { this.formatting_ = this.formatting_.concat(e); var i = e.reduce(function (t, e) { return t + "<" + e + ">" }, ""); this[this.mode_](t, i) }, it.prototype.clearFormatting = function (t) { if (this.formatting_.length) { var e = this.formatting_.reverse().reduce(function (t, e) { return t + "</" + e + ">" }, ""); this.formatting_ = [], this[this.mode_](t, e) } }, it.prototype.popOn = function (t, e) { var i = this.nonDisplayed_[this.row_]; i += e, this.nonDisplayed_[this.row_] = i }, it.prototype.rollUp = function (t, e) { var i = this.displayed_[Z]; i += e, this.displayed_[Z] = i }, it.prototype.shiftRowsUp_ = function () { var t; for (t = 0; t < this.topRow_; t++)this.displayed_[t] = ""; for (t = this.topRow_; Z > t; t++)this.displayed_[t] = this.displayed_[t + 1]; this.displayed_[Z] = "" }, it.prototype.paintOn = function () { }; var rt = { CaptionStream: K, Cea608Stream: it }, nt = { H264_STREAM_TYPE: 27, ADTS_STREAM_TYPE: 15, METADATA_STREAM_TYPE: 21 }, at = 8589934592, st = 4294967296, ot = function (t, e) { var i = 1; for (t > e && (i = -1); Math.abs(e - t) > st;)t += i * at; return t }, ut = function Se(t) { var e, i; Se.prototype.init.call(this), this.type_ = t, this.push = function (t) { t.type === this.type_ && (void 0 === i && (i = t.dts), t.dts = ot(t.dts, i), t.pts = ot(t.pts, i), e = t.dts, this.trigger("data", t)) }, this.flush = function () { i = e, this.trigger("done") }, this.discontinuity = function () { i = void 0, e = void 0 } }; ut.prototype = new W; var lt, ct = { TimestampRolloverStream: ut, handleRollover: ot }, ht = function (t, e, i) { var r, n = ""; for (r = e; i > r; r++)n += "%" + ("00" + t[r].toString(16)).slice(-2); return n }, dt = function (t, e, i) { return decodeURIComponent(ht(t, e, i)) }, pt = function (t, e, i) { return unescape(ht(t, e, i)) }, ft = function (t) { return t[0] << 21 | t[1] << 14 | t[2] << 7 | t[3] }, mt = { TXXX: function (t) { var e; if (3 === t.data[0]) { for (e = 1; e < t.data.length; e++)if (0 === t.data[e]) { t.description = dt(t.data, 1, e), t.value = dt(t.data, e + 1, t.data.length).replace(/\0*$/, ""); break } t.data = t.value } }, WXXX: function (t) { var e; if (3 === t.data[0]) for (e = 1; e < t.data.length; e++)if (0 === t.data[e]) { t.description = dt(t.data, 1, e), t.url = dt(t.data, e + 1, t.data.length); break } }, PRIV: function (t) { var e; for (e = 0; e < t.data.length; e++)if (0 === t.data[e]) { t.owner = pt(t.data, 0, e); break } t.privateData = t.data.subarray(e + 1), t.data = t.privateData } }; lt = function (t) { var e, i = { debug: !(!t || !t.debug), descriptor: t && t.descriptor }, r = 0, n = [], a = 0; if (lt.prototype.init.call(this), this.dispatchType = nt.METADATA_STREAM_TYPE.toString(16), i.descriptor) for (e = 0; e < i.descriptor.length; e++)this.dispatchType += ("00" + i.descriptor[e].toString(16)).slice(-2); this.push = function (t) { var e, s, o, u, l, c; if ("timed-metadata" === t.type) { if (t.dataAlignmentIndicator && (a = 0, n.length = 0), 0 === n.length && (t.data.length < 10 || t.data[0] !== "I".charCodeAt(0) || t.data[1] !== "D".charCodeAt(0) || t.data[2] !== "3".charCodeAt(0))) return void i.debug; if (n.push(t), a += t.data.byteLength, 1 === n.length && (r = ft(t.data.subarray(6, 10)), r += 10), !(r > a)) { for (e = { data: new Uint8Array(r), frames: [], pts: n[0].pts, dts: n[0].dts }, l = 0; r > l;)e.data.set(n[0].data.subarray(0, r - l), l), l += n[0].data.byteLength, a -= n[0].data.byteLength, n.shift(); s = 10, 64 & e.data[5] && (s += 4, s += ft(e.data.subarray(10, 14)), r -= ft(e.data.subarray(16, 20))); do { if (o = ft(e.data.subarray(s + 4, s + 8)), 1 > o) return; if (c = String.fromCharCode(e.data[s], e.data[s + 1], e.data[s + 2], e.data[s + 3]), u = { id: c, data: e.data.subarray(s + 10, s + o + 10) }, u.key = u.id, mt[u.id] && (mt[u.id](u), "com.apple.streaming.transportStreamTimestamp" === u.owner)) { var h = u.data, d = (1 & h[3]) << 30 | h[4] << 22 | h[5] << 14 | h[6] << 6 | h[7] >>> 2; d *= 4, d += 3 & h[7], u.timeStamp = d, void 0 === e.pts && void 0 === e.dts && (e.pts = u.timeStamp, e.dts = u.timeStamp), this.trigger("timestamp", u) } e.frames.push(u), s += 10, s += o } while (r > s); this.trigger("data", e) } } } }, lt.prototype = new W; var gt, yt, vt, _t = lt, bt = ct.TimestampRolloverStream, Tt = 188, St = 71; gt = function () { var t = new Uint8Array(Tt), e = 0; gt.prototype.init.call(this), this.push = function (i) { var r, n = 0, a = Tt; for (e ? (r = new Uint8Array(i.byteLength + e), r.set(t.subarray(0, e)), r.set(i, e), e = 0) : r = i; a < r.byteLength;)r[n] !== St || r[a] !== St ? (n++ , a++) : (this.trigger("data", r.subarray(n, a)), n += Tt, a += Tt); n < r.byteLength && (t.set(r.subarray(n), 0), e = r.byteLength - n) }, this.flush = function () { e === Tt && t[0] === St && (this.trigger("data", t), e = 0), this.trigger("done") } }, gt.prototype = new W, yt = function () { var t, e, i, r; yt.prototype.init.call(this), r = this, this.packetsWaitingForPmt = [], this.programMapTable = void 0, t = function (t, r) { var n = 0; r.payloadUnitStartIndicator && (n += t[n] + 1), "pat" === r.type ? e(t.subarray(n), r) : i(t.subarray(n), r) }, e = function (t, e) { e.section_number = t[7], e.last_section_number = t[8], r.pmtPid = (31 & t[10]) << 8 | t[11], e.pmtPid = r.pmtPid }, i = function (t, e) { var i, n, a, s; if (1 & t[5]) { for (r.programMapTable = { video: null, audio: null, "timed-metadata": {} }, i = (15 & t[1]) << 8 | t[2], n = 3 + i - 4, a = (15 & t[10]) << 8 | t[11], s = 12 + a; n > s;) { var o = t[s], u = (31 & t[s + 1]) << 8 | t[s + 2]; o === nt.H264_STREAM_TYPE && null === r.programMapTable.video ? r.programMapTable.video = u : o === nt.ADTS_STREAM_TYPE && null === r.programMapTable.audio ? r.programMapTable.audio = u : o === nt.METADATA_STREAM_TYPE && (r.programMapTable["timed-metadata"][u] = o), s += ((15 & t[s + 3]) << 8 | t[s + 4]) + 5 } e.programMapTable = r.programMapTable } }, this.push = function (e) { var i = {}, r = 4; if (i.payloadUnitStartIndicator = !!(64 & e[1]), i.pid = 31 & e[1], i.pid <<= 8, i.pid |= e[2], (48 & e[3]) >>> 4 > 1 && (r += e[r] + 1), 0 === i.pid) i.type = "pat", t(e.subarray(r), i), this.trigger("data", i); else if (i.pid === this.pmtPid) for (i.type = "pmt", t(e.subarray(r), i), this.trigger("data", i); this.packetsWaitingForPmt.length;)this.processPes_.apply(this, this.packetsWaitingForPmt.shift()); else void 0 === this.programMapTable ? this.packetsWaitingForPmt.push([e, r, i]) : this.processPes_(e, r, i) }, this.processPes_ = function (t, e, i) { i.pid === this.programMapTable.video ? i.streamType = nt.H264_STREAM_TYPE : i.pid === this.programMapTable.audio ? i.streamType = nt.ADTS_STREAM_TYPE : i.streamType = this.programMapTable["timed-metadata"][i.pid], i.type = "pes", i.data = t.subarray(e), this.trigger("data", i) } }, yt.prototype = new W, yt.STREAM_TYPES = { h264: 27, adts: 15 }, vt = function () { var t = this, e = { data: [], size: 0 }, i = { data: [], size: 0 }, r = { data: [], size: 0 }, n = function (t, e) { var i; e.packetLength = 6 + (t[4] << 8 | t[5]), e.dataAlignmentIndicator = 0 !== (4 & t[6]), i = t[7], 192 & i && (e.pts = (14 & t[9]) << 27 | (255 & t[10]) << 20 | (254 & t[11]) << 12 | (255 & t[12]) << 5 | (254 & t[13]) >>> 3, e.pts *= 4, e.pts += (6 & t[13]) >>> 1, e.dts = e.pts, 64 & i && (e.dts = (14 & t[14]) << 27 | (255 & t[15]) << 20 | (254 & t[16]) << 12 | (255 & t[17]) << 5 | (254 & t[18]) >>> 3, e.dts *= 4, e.dts += (6 & t[18]) >>> 1)), e.data = t.subarray(9 + t[8]) }, a = function (e, i, r) { var a, s = new Uint8Array(e.size), o = { type: i }, u = 0, l = 0, c = !1; if (e.data.length && !(e.size < 9)) { for (o.trackId = e.data[0].pid, u = 0; u < e.data.length; u++)a = e.data[u], s.set(a.data, l), l += a.data.byteLength; n(s, o), c = "video" === i || o.packetLength <= e.size, (r || c) && (e.size = 0, e.data.length = 0), c && t.trigger("data", o) } }; vt.prototype.init.call(this), this.push = function (n) { ({ pat: function () { }, pes: function () { var t, s; switch (n.streamType) { case nt.H264_STREAM_TYPE: case nt.H264_STREAM_TYPE: t = e, s = "video"; break; case nt.ADTS_STREAM_TYPE: t = i, s = "audio"; break; case nt.METADATA_STREAM_TYPE: t = r, s = "timed-metadata"; break; default: return }n.payloadUnitStartIndicator && a(t, s, !0), t.data.push(n), t.size += n.data.byteLength }, pmt: function () { var e = { type: "metadata", tracks: [] }, i = n.programMapTable; null !== i.video && e.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +i.video, codec: "avc", type: "video" }), null !== i.audio && e.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +i.audio, codec: "adts", type: "audio" }), t.trigger("data", e) } })[n.type]() }, this.flush = function () { a(e, "video"), a(i, "audio"), a(r, "timed-metadata"), this.trigger("done") } }, vt.prototype = new W; var kt = { PAT_PID: 0, MP2T_PACKET_LENGTH: Tt, TransportPacketStream: gt, TransportParseStream: yt, ElementaryStream: vt, TimestampRolloverStream: bt, CaptionStream: rt.CaptionStream, Cea608Stream: rt.Cea608Stream, MetadataStream: _t }; for (var Et in nt) nt.hasOwnProperty(Et) && (kt[Et] = nt[Et]); var Ct, wt = kt, At = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350]; Ct = function () { var t; Ct.prototype.init.call(this), this.push = function (e) { var i, r, n, a, s, o, u = 0, l = 0; if ("audio" === e.type) for (t ? (a = t, t = new Uint8Array(a.byteLength + e.data.byteLength), t.set(a), t.set(e.data, a.byteLength)) : t = e.data; u + 5 < t.length;)if (255 === t[u] && 240 === (246 & t[u + 1])) { if (r = 2 * (1 & ~t[u + 1]), i = (3 & t[u + 3]) << 11 | t[u + 4] << 3 | (224 & t[u + 5]) >> 5, s = 1024 * ((3 & t[u + 6]) + 1), o = 9e4 * s / At[(60 & t[u + 2]) >>> 2], n = u + i, t.byteLength < n) return; if (this.trigger("data", { pts: e.pts + l * o, dts: e.dts + l * o, sampleCount: s, audioobjecttype: (t[u + 2] >>> 6 & 3) + 1, channelcount: (1 & t[u + 2]) << 2 | (192 & t[u + 3]) >>> 6, samplerate: At[(60 & t[u + 2]) >>> 2], samplingfrequencyindex: (60 & t[u + 2]) >>> 2, samplesize: 16, data: t.subarray(u + 7 + r, n) }), t.byteLength === n) return void (t = void 0); l++ , t = t.subarray(n) } else u++ }, this.flush = function () { this.trigger("done") } }, Ct.prototype = new W; var Lt, Pt = Ct; Lt = function (t) { var e = t.byteLength, i = 0, r = 0; this.length = function () { return 8 * e }, this.bitsAvailable = function () { return 8 * e + r }, this.loadWord = function () { var n = t.byteLength - e, a = new Uint8Array(4), s = Math.min(4, e); if (0 === s) throw new Error("no bytes available"); a.set(t.subarray(n, n + s)), i = new DataView(a.buffer).getUint32(0), r = 8 * s, e -= s }, this.skipBits = function (t) { var n; r > t ? (i <<= t, r -= t) : (t -= r, n = Math.floor(t / 8), t -= 8 * n, e -= n, this.loadWord(), i <<= t, r -= t) }, this.readBits = function (t) { var n = Math.min(r, t), a = i >>> 32 - n; return r -= n, r > 0 ? i <<= n : e > 0 && this.loadWord(), n = t - n, n > 0 ? a << n | this.readBits(n) : a }, this.skipLeadingZeros = function () { var t; for (t = 0; r > t; ++t)if (0 !== (i & 2147483648 >>> t)) return i <<= t, r -= t, t; return this.loadWord(), t + this.skipLeadingZeros() }, this.skipUnsignedExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.skipExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.readUnsignedExpGolomb = function () { var t = this.skipLeadingZeros(); return this.readBits(t + 1) - 1 }, this.readExpGolomb = function () { var t = this.readUnsignedExpGolomb(); return 1 & t ? 1 + t >>> 1 : -1 * (t >>> 1) }, this.readBoolean = function () { return 1 === this.readBits(1) }, this.readUnsignedByte = function () { return this.readBits(8) }, this.loadWord() }; var Ot, It, xt, Dt = Lt; It = function () { var t, e, i = 0; It.prototype.init.call(this), this.push = function (r) { var n; for (e ? (n = new Uint8Array(e.byteLength + r.data.byteLength), n.set(e), n.set(r.data, e.byteLength), e = n) : e = r.data; i < e.byteLength - 3; i++)if (1 === e[i + 2]) { t = i + 5; break } for (; t < e.byteLength;)switch (e[t]) { case 0: if (0 !== e[t - 1]) { t += 2; break } if (0 !== e[t - 2]) { t++; break } i + 3 !== t - 2 && this.trigger("data", e.subarray(i + 3, t - 2)); do t++; while (1 !== e[t] && t < e.length); i = t - 2, t += 3; break; case 1: if (0 !== e[t - 1] || 0 !== e[t - 2]) { t += 3; break } this.trigger("data", e.subarray(i + 3, t - 2)), i = t - 2, t += 3; break; default: t += 3 }e = e.subarray(i), t -= i, i = 0 }, this.flush = function () { e && e.byteLength > 3 && this.trigger("data", e.subarray(i + 3)), e = null, i = 0, this.trigger("done") } }, It.prototype = new W, xt = { 100: !0, 110: !0, 122: !0, 244: !0, 44: !0, 83: !0, 86: !0, 118: !0, 128: !0, 138: !0, 139: !0, 134: !0 }, Ot = function () {
        var t, e, i, r, n, a, s, o = new It; Ot.prototype.init.call(this), t = this, this.push = function (t) { "video" === t.type && (e = t.trackId, i = t.pts, r = t.dts, o.push(t)) }, o.on("data", function (s) { var o = { trackId: e, pts: i, dts: r, data: s }; switch (31 & s[0]) { case 5: o.nalUnitType = "slice_layer_without_partitioning_rbsp_idr"; break; case 6: o.nalUnitType = "sei_rbsp", o.escapedRBSP = n(s.subarray(1)); break; case 7: o.nalUnitType = "seq_parameter_set_rbsp", o.escapedRBSP = n(s.subarray(1)), o.config = a(o.escapedRBSP); break; case 8: o.nalUnitType = "pic_parameter_set_rbsp"; break; case 9: o.nalUnitType = "access_unit_delimiter_rbsp" }t.trigger("data", o) }), o.on("done", function () { t.trigger("done") }), this.flush = function () { o.flush() }, s = function (t, e) { var i, r, n = 8, a = 8; for (i = 0; t > i; i++)0 !== a && (r = e.readExpGolomb(), a = (n + r + 256) % 256), n = 0 === a ? n : a }, n = function (t) {
          for (var e, i, r = t.byteLength, n = [], a = 1; r - 2 > a;)0 === t[a] && 0 === t[a + 1] && 3 === t[a + 2] ? (n.push(a + 2),
            a += 2) : a++; if (0 === n.length) return t; e = r - n.length, i = new Uint8Array(e); var s = 0; for (a = 0; e > a; s++ , a++)s === n[0] && (s++ , n.shift()), i[a] = t[s]; return i
        }, a = function (t) { var e, i, r, n, a, o, u, l, c, h, d, p, f, m, g = 0, y = 0, v = 0, _ = 0, b = 1; if (e = new Dt(t), i = e.readUnsignedByte(), n = e.readUnsignedByte(), r = e.readUnsignedByte(), e.skipUnsignedExpGolomb(), xt[i] && (a = e.readUnsignedExpGolomb(), 3 === a && e.skipBits(1), e.skipUnsignedExpGolomb(), e.skipUnsignedExpGolomb(), e.skipBits(1), e.readBoolean())) for (d = 3 !== a ? 8 : 12, m = 0; d > m; m++)e.readBoolean() && (6 > m ? s(16, e) : s(64, e)); if (e.skipUnsignedExpGolomb(), o = e.readUnsignedExpGolomb(), 0 === o) e.readUnsignedExpGolomb(); else if (1 === o) for (e.skipBits(1), e.skipExpGolomb(), e.skipExpGolomb(), u = e.readUnsignedExpGolomb(), m = 0; u > m; m++)e.skipExpGolomb(); if (e.skipUnsignedExpGolomb(), e.skipBits(1), l = e.readUnsignedExpGolomb(), c = e.readUnsignedExpGolomb(), h = e.readBits(1), 0 === h && e.skipBits(1), e.skipBits(1), e.readBoolean() && (g = e.readUnsignedExpGolomb(), y = e.readUnsignedExpGolomb(), v = e.readUnsignedExpGolomb(), _ = e.readUnsignedExpGolomb()), e.readBoolean() && e.readBoolean()) { switch (f = e.readUnsignedByte()) { case 1: p = [1, 1]; break; case 2: p = [12, 11]; break; case 3: p = [10, 11]; break; case 4: p = [16, 11]; break; case 5: p = [40, 33]; break; case 6: p = [24, 11]; break; case 7: p = [20, 11]; break; case 8: p = [32, 11]; break; case 9: p = [80, 33]; break; case 10: p = [18, 11]; break; case 11: p = [15, 11]; break; case 12: p = [64, 33]; break; case 13: p = [160, 99]; break; case 14: p = [4, 3]; break; case 15: p = [3, 2]; break; case 16: p = [2, 1]; break; case 255: p = [e.readUnsignedByte() << 8 | e.readUnsignedByte(), e.readUnsignedByte() << 8 | e.readUnsignedByte()] }p && (b = p[0] / p[1]) } return { profileIdc: i, levelIdc: r, profileCompatibility: n, width: Math.ceil((16 * (l + 1) - 2 * g - 2 * y) * b), height: (2 - h) * (c + 1) * 16 - 2 * v - 2 * _ } }
      }, Ot.prototype = new W; var Rt, Mt = { H264Stream: Ot, NalByteStream: It }; Rt = function () { var t = new Uint8Array, e = 0; Rt.prototype.init.call(this), this.setTimestamp = function (t) { e = t }, this.parseId3TagSize = function (t, e) { var i = t[e + 6] << 21 | t[e + 7] << 14 | t[e + 8] << 7 | t[e + 9], r = t[e + 5], n = (16 & r) >> 4; return n ? i + 20 : i + 10 }, this.parseAdtsSize = function (t, e) { var i = (224 & t[e + 5]) >> 5, r = t[e + 4] << 3, n = 6144 & t[e + 3]; return n | r | i }, this.push = function (i) { var r, n, a, s, o = 0, u = 0; for (t.length ? (s = t.length, t = new Uint8Array(i.byteLength + s), t.set(t.subarray(0, s)), t.set(i, s)) : t = i; t.length - u >= 3;)if (t[u] !== "I".charCodeAt(0) || t[u + 1] !== "D".charCodeAt(0) || t[u + 2] !== "3".charCodeAt(0)) if (t[u] & !0 && 240 === (240 & t[u + 1])) { if (t.length - u < 7) break; if (o = this.parseAdtsSize(t, u), o > t.length) break; a = { type: "audio", data: t.subarray(u, u + o), pts: e, dts: e }, this.trigger("data", a), u += o } else u++; else { if (t.length - u < 10) break; if (o = this.parseId3TagSize(t, u), o > t.length) break; n = { type: "timed-metadata", data: t.subarray(u, u + o) }, this.trigger("data", n), u += o } r = t.length - u, t = r > 0 ? t.subarray(u) : new Uint8Array } }, Rt.prototype = new W; var Ut, Nt, Bt, jt, Ft, Ht, Vt = Rt, qt = [33, 16, 5, 32, 164, 27], Wt = [33, 65, 108, 84, 1, 2, 4, 8, 168, 2, 4, 8, 17, 191, 252], zt = function (t) { for (var e = []; t--;)e.push(0); return e }, Gt = function (t) { return Object.keys(t).reduce(function (e, i) { return e[i] = new Uint8Array(t[i].reduce(function (t, e) { return t.concat(e) }, [])), e }, {}) }, Xt = { 96e3: [qt, [227, 64], zt(154), [56]], 88200: [qt, [231], zt(170), [56]], 64e3: [qt, [248, 192], zt(240), [56]], 48e3: [qt, [255, 192], zt(268), [55, 148, 128], zt(54), [112]], 44100: [qt, [255, 192], zt(268), [55, 163, 128], zt(84), [112]], 32e3: [qt, [255, 192], zt(268), [55, 234], zt(226), [112]], 24e3: [qt, [255, 192], zt(268), [55, 255, 128], zt(268), [111, 112], zt(126), [224]], 16e3: [qt, [255, 192], zt(268), [55, 255, 128], zt(268), [111, 255], zt(269), [223, 108], zt(195), [1, 192]], 12e3: [Wt, zt(268), [3, 127, 248], zt(268), [6, 255, 240], zt(268), [13, 255, 224], zt(268), [27, 253, 128], zt(259), [56]], 11025: [Wt, zt(268), [3, 127, 248], zt(268), [6, 255, 240], zt(268), [13, 255, 224], zt(268), [27, 255, 192], zt(268), [55, 175, 128], zt(108), [112]], 8e3: [Wt, zt(268), [3, 121, 16], zt(47), [7]] }, Yt = Gt(Xt), $t = 9e4; Ut = function (t) { return t * $t }, Nt = function (t, e) { return t * e }, Bt = function (t) { return t / $t }, jt = function (t, e) { return t / e }, Ft = function (t, e) { return Ut(jt(t, e)) }, Ht = function (t, e) { return Nt(Bt(t), e) }; var Kt, Jt, Qt, Zt, te, ee, ie, re, ne, ae, se, oe = { secondsToVideoTs: Ut, secondsToAudioTs: Nt, videoTsToSeconds: Bt, audioTsToSeconds: jt, audioTsToVideoTs: Ft, videoTsToAudioTs: Ht }, ue = Mt.H264Stream, le = ["audioobjecttype", "channelcount", "samplerate", "samplingfrequencyindex", "samplesize"], ce = ["width", "height", "profileIdc", "levelIdc", "profileCompatibility"], he = 9e4; te = function () { return { size: 0, flags: { isLeading: 0, dependsOn: 1, isDependedOn: 0, hasRedundancy: 0, degradationPriority: 0 } } }, ee = function (t) { return t[0] === "I".charCodeAt(0) && t[1] === "D".charCodeAt(0) && t[2] === "3".charCodeAt(0) ? !0 : !1 }, ae = function (t, e) { var i; if (t.length !== e.length) return !1; for (i = 0; i < t.length; i++)if (t[i] !== e[i]) return !1; return !0 }, se = function (t) { var e, i, r = 0; for (e = 0; e < t.length; e++)i = t[e], r += i.data.byteLength; return r }, Jt = function (t, e) { var i = [], r = 0, n = 0, a = 0, s = 1 / 0; e = e || {}, Jt.prototype.init.call(this), this.push = function (e) { ie(t, e), t && le.forEach(function (i) { t[i] = e[i] }), i.push(e) }, this.setEarliestDts = function (e) { n = e - t.timelineStartInfo.baseMediaDecodeTime }, this.setVideoBaseMediaDecodeTime = function (t) { s = t }, this.setAudioAppendStart = function (t) { a = t }, this.flush = function () { var n, a, s, o; return 0 === i.length ? void this.trigger("done", "AudioSegmentStream") : (n = this.trimAdtsFramesByEarliestDts_(i), t.baseMediaDecodeTime = ne(t, e.keepOriginalTimestamps), this.prefixWithSilence_(t, n), t.samples = this.generateSampleTable_(n), s = V.mdat(this.concatenateFrameData_(n)), i = [], a = V.moof(r, [t]), o = new Uint8Array(a.byteLength + s.byteLength), r++ , o.set(a), o.set(s, a.byteLength), re(t), this.trigger("data", { track: t, boxes: o }), void this.trigger("done", "AudioSegmentStream")) }, this.prefixWithSilence_ = function (t, e) { var i, r, n, o = 0, u = 0, l = 0, c = 0; if (e.length && (i = oe.audioTsToVideoTs(t.baseMediaDecodeTime, t.samplerate), o = Math.ceil(he / (t.samplerate / 1024)), a && s && (u = i - Math.max(a, s), l = Math.floor(u / o), c = l * o), !(1 > l || c > he / 2))) { for (r = Yt[t.samplerate], r || (r = e[0].data), n = 0; l > n; n++)e.splice(n, 0, { data: r }); t.baseMediaDecodeTime -= Math.floor(oe.videoTsToAudioTs(c, t.samplerate)) } }, this.trimAdtsFramesByEarliestDts_ = function (e) { return t.minSegmentDts >= n ? e : (t.minSegmentDts = 1 / 0, e.filter(function (e) { return e.dts >= n ? (t.minSegmentDts = Math.min(t.minSegmentDts, e.dts), t.minSegmentPts = t.minSegmentDts, !0) : !1 })) }, this.generateSampleTable_ = function (t) { var e, i, r = []; for (e = 0; e < t.length; e++)i = t[e], r.push({ size: i.data.byteLength, duration: 1024 }); return r }, this.concatenateFrameData_ = function (t) { var e, i, r = 0, n = new Uint8Array(se(t)); for (e = 0; e < t.length; e++)i = t[e], n.set(i.data, r), r += i.data.byteLength; return n } }, Jt.prototype = new W, Kt = function (t, e) { var i, r, n = 0, a = [], s = []; e = e || {}, Kt.prototype.init.call(this), delete t.minPTS, this.gopCache_ = [], this.push = function (e) { ie(t, e), "seq_parameter_set_rbsp" !== e.nalUnitType || i || (i = e.config, t.sps = [e.data], ce.forEach(function (e) { t[e] = i[e] }, this)), "pic_parameter_set_rbsp" !== e.nalUnitType || r || (r = e.data, t.pps = [e.data]), a.push(e) }, this.flush = function () { for (var i, r, o, u, l, c; a.length && "access_unit_delimiter_rbsp" !== a[0].nalUnitType;)a.shift(); if (0 === a.length) return this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); if (i = this.groupNalsIntoFrames_(a), o = this.groupFramesIntoGops_(i), o[0][0].keyFrame || (r = this.getGopForFusion_(a[0], t), r ? (o.unshift(r), o.byteLength += r.byteLength, o.nalCount += r.nalCount, o.pts = r.pts, o.dts = r.dts, o.duration += r.duration) : o = this.extendFirstKeyFrame_(o)), s.length) { var h; if (h = e.alignGopsAtEnd ? this.alignGopsAtEnd_(o) : this.alignGopsAtStart_(o), !h) return this.gopCache_.unshift({ gop: o.pop(), pps: t.pps, sps: t.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); re(t), o = h } ie(t, o), t.samples = this.generateSampleTable_(o), l = V.mdat(this.concatenateNalData_(o)), t.baseMediaDecodeTime = ne(t, e.keepOriginalTimestamps), this.trigger("processedGopsInfo", o.map(function (t) { return { pts: t.pts, dts: t.dts, byteLength: t.byteLength } })), this.gopCache_.unshift({ gop: o.pop(), pps: t.pps, sps: t.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.trigger("baseMediaDecodeTime", t.baseMediaDecodeTime), this.trigger("timelineStartInfo", t.timelineStartInfo), u = V.moof(n, [t]), c = new Uint8Array(u.byteLength + l.byteLength), n++ , c.set(u), c.set(l, u.byteLength), this.trigger("data", { track: t, boxes: c }), this.resetStream_(), this.trigger("done", "VideoSegmentStream") }, this.resetStream_ = function () { re(t), i = void 0, r = void 0 }, this.getGopForFusion_ = function (e) { var i, r, n, a, s, o = 45e3, u = 1e4, l = 1 / 0; for (s = 0; s < this.gopCache_.length; s++)a = this.gopCache_[s], n = a.gop, t.pps && ae(t.pps[0], a.pps[0]) && t.sps && ae(t.sps[0], a.sps[0]) && (n.dts < t.timelineStartInfo.dts || (i = e.dts - n.dts - n.duration, i >= -u && o >= i && (!r || l > i) && (r = a, l = i))); return r ? r.gop : null }, this.extendFirstKeyFrame_ = function (t) { var e; return !t[0][0].keyFrame && t.length > 1 && (e = t.shift(), t.byteLength -= e.byteLength, t.nalCount -= e.nalCount, t[0][0].dts = e.dts, t[0][0].pts = e.pts, t[0][0].duration += e.duration), t }, this.groupNalsIntoFrames_ = function (t) { var e, i, r = [], n = []; for (r.byteLength = 0, e = 0; e < t.length; e++)i = t[e], "access_unit_delimiter_rbsp" === i.nalUnitType ? (r.length && (r.duration = i.dts - r.dts, n.push(r)), r = [i], r.byteLength = i.data.byteLength, r.pts = i.pts, r.dts = i.dts) : ("slice_layer_without_partitioning_rbsp_idr" === i.nalUnitType && (r.keyFrame = !0), r.duration = i.dts - r.dts, r.byteLength += i.data.byteLength, r.push(i)); return n.length && (!r.duration || r.duration <= 0) && (r.duration = n[n.length - 1].duration), n.push(r), n }, this.groupFramesIntoGops_ = function (t) { var e, i, r = [], n = []; for (r.byteLength = 0, r.nalCount = 0, r.duration = 0, r.pts = t[0].pts, r.dts = t[0].dts, n.byteLength = 0, n.nalCount = 0, n.duration = 0, n.pts = t[0].pts, n.dts = t[0].dts, e = 0; e < t.length; e++)i = t[e], i.keyFrame ? (r.length && (n.push(r), n.byteLength += r.byteLength, n.nalCount += r.nalCount, n.duration += r.duration), r = [i], r.nalCount = i.length, r.byteLength = i.byteLength, r.pts = i.pts, r.dts = i.dts, r.duration = i.duration) : (r.duration += i.duration, r.nalCount += i.length, r.byteLength += i.byteLength, r.push(i)); return n.length && r.duration <= 0 && (r.duration = n[n.length - 1].duration), n.byteLength += r.byteLength, n.nalCount += r.nalCount, n.duration += r.duration, n.push(r), n }, this.generateSampleTable_ = function (t, e) { var i, r, n, a, s, o = e || 0, u = []; for (i = 0; i < t.length; i++)for (a = t[i], r = 0; r < a.length; r++)s = a[r], n = te(), n.dataOffset = o, n.compositionTimeOffset = s.pts - s.dts, n.duration = s.duration, n.size = 4 * s.length, n.size += s.byteLength, s.keyFrame && (n.flags.dependsOn = 2), o += n.size, u.push(n); return u }, this.concatenateNalData_ = function (t) { var e, i, r, n, a, s, o = 0, u = t.byteLength, l = t.nalCount, c = u + 4 * l, h = new Uint8Array(c), d = new DataView(h.buffer); for (e = 0; e < t.length; e++)for (n = t[e], i = 0; i < n.length; i++)for (a = n[i], r = 0; r < a.length; r++)s = a[r], d.setUint32(o, s.data.byteLength), o += 4, h.set(s.data, o), o += s.data.byteLength; return h }, this.alignGopsAtStart_ = function (t) { var e, i, r, n, a, o, u, l; for (a = t.byteLength, o = t.nalCount, u = t.duration, e = i = 0; e < s.length && i < t.length && (r = s[e], n = t[i], r.pts !== n.pts);)n.pts > r.pts ? e++ : (i++ , a -= n.byteLength, o -= n.nalCount, u -= n.duration); return 0 === i ? t : i === t.length ? null : (l = t.slice(i), l.byteLength = a, l.duration = u, l.nalCount = o, l.pts = l[0].pts, l.dts = l[0].dts, l) }, this.alignGopsAtEnd_ = function (t) { var e, i, r, n, a, o; for (e = s.length - 1, i = t.length - 1, a = null, o = !1; e >= 0 && i >= 0;) { if (r = s[e], n = t[i], r.pts === n.pts) { o = !0; break } r.pts > n.pts ? e-- : (e === s.length - 1 && (a = i), i--) } if (!o && null === a) return null; var u; if (u = o ? i : a, 0 === u) return t; var l = t.slice(u), c = l.reduce(function (t, e) { return t.byteLength += e.byteLength, t.duration += e.duration, t.nalCount += e.nalCount, t }, { byteLength: 0, duration: 0, nalCount: 0 }); return l.byteLength = c.byteLength, l.duration = c.duration, l.nalCount = c.nalCount, l.pts = l[0].pts, l.dts = l[0].dts, l }, this.alignGopsWith = function (t) { s = t } }, Kt.prototype = new W, ie = function (t, e) { "number" == typeof e.pts && (void 0 === t.timelineStartInfo.pts && (t.timelineStartInfo.pts = e.pts), void 0 === t.minSegmentPts ? t.minSegmentPts = e.pts : t.minSegmentPts = Math.min(t.minSegmentPts, e.pts), void 0 === t.maxSegmentPts ? t.maxSegmentPts = e.pts : t.maxSegmentPts = Math.max(t.maxSegmentPts, e.pts)), "number" == typeof e.dts && (void 0 === t.timelineStartInfo.dts && (t.timelineStartInfo.dts = e.dts), void 0 === t.minSegmentDts ? t.minSegmentDts = e.dts : t.minSegmentDts = Math.min(t.minSegmentDts, e.dts), void 0 === t.maxSegmentDts ? t.maxSegmentDts = e.dts : t.maxSegmentDts = Math.max(t.maxSegmentDts, e.dts)) }, re = function (t) { delete t.minSegmentDts, delete t.maxSegmentDts, delete t.minSegmentPts, delete t.maxSegmentPts }, ne = function (t, e) { var i, r, n = t.minSegmentDts; return e || (n -= t.timelineStartInfo.dts), i = t.timelineStartInfo.baseMediaDecodeTime, i += n, i = Math.max(0, i), "audio" === t.type && (r = t.samplerate / he, i *= r, i = Math.floor(i)), i }, Zt = function (t, e) { this.numberOfTracks = 0, this.metadataStream = e, "undefined" != typeof t.remux ? this.remuxTracks = !!t.remux : this.remuxTracks = !0, this.pendingTracks = [], this.videoTrack = null, this.pendingBoxes = [], this.pendingCaptions = [], this.pendingMetadata = [], this.pendingBytes = 0, this.emittedTracks = 0, Zt.prototype.init.call(this), this.push = function (t) { return t.text ? this.pendingCaptions.push(t) : t.frames ? this.pendingMetadata.push(t) : (this.pendingTracks.push(t.track), this.pendingBoxes.push(t.boxes), this.pendingBytes += t.boxes.byteLength, "video" === t.track.type && (this.videoTrack = t.track), void ("audio" === t.track.type && (this.audioTrack = t.track))) } }, Zt.prototype = new W, Zt.prototype.flush = function (t) { var e, i, r, n, a = 0, s = { captions: [], captionStreams: {}, metadata: [], info: {} }, o = 0; if (this.pendingTracks.length < this.numberOfTracks) { if ("VideoSegmentStream" !== t && "AudioSegmentStream" !== t) return; if (this.remuxTracks) return; if (0 === this.pendingTracks.length) return this.emittedTracks++ , void (this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0)) } for (this.videoTrack ? (o = this.videoTrack.timelineStartInfo.pts, ce.forEach(function (t) { s.info[t] = this.videoTrack[t] }, this)) : this.audioTrack && (o = this.audioTrack.timelineStartInfo.pts, le.forEach(function (t) { s.info[t] = this.audioTrack[t] }, this)), 1 === this.pendingTracks.length ? s.type = this.pendingTracks[0].type : s.type = "combined", this.emittedTracks += this.pendingTracks.length, r = V.initSegment(this.pendingTracks), s.initSegment = new Uint8Array(r.byteLength), s.initSegment.set(r), s.data = new Uint8Array(this.pendingBytes), n = 0; n < this.pendingBoxes.length; n++)s.data.set(this.pendingBoxes[n], a), a += this.pendingBoxes[n].byteLength; for (n = 0; n < this.pendingCaptions.length; n++)e = this.pendingCaptions[n], e.startTime = e.startPts - o, e.startTime /= 9e4, e.endTime = e.endPts - o, e.endTime /= 9e4, s.captionStreams[e.stream] = !0, s.captions.push(e); for (n = 0; n < this.pendingMetadata.length; n++)i = this.pendingMetadata[n], i.cueTime = i.pts - o, i.cueTime /= 9e4, s.metadata.push(i); s.metadata.dispatchType = this.metadataStream.dispatchType, this.pendingTracks.length = 0, this.videoTrack = null, this.pendingBoxes.length = 0, this.pendingCaptions.length = 0, this.pendingBytes = 0, this.pendingMetadata.length = 0, this.trigger("data", s), this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0) }, Qt = function (t) { var e, i, r = this, n = !0; Qt.prototype.init.call(this), t = t || {}, this.baseMediaDecodeTime = t.baseMediaDecodeTime || 0, this.transmuxPipeline_ = {}, this.setupAacPipeline = function () { var e = {}; this.transmuxPipeline_ = e, e.type = "aac", e.metadataStream = new wt.MetadataStream, e.aacStream = new Vt, e.audioTimestampRolloverStream = new wt.TimestampRolloverStream("audio"), e.timedMetadataTimestampRolloverStream = new wt.TimestampRolloverStream("timed-metadata"), e.adtsStream = new Pt, e.coalesceStream = new Zt(t, e.metadataStream), e.headOfPipeline = e.aacStream, e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream), e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream), e.metadataStream.on("timestamp", function (t) { e.aacStream.setTimestamp(t.timeStamp) }), e.aacStream.on("data", function (n) { "timed-metadata" !== n.type || e.audioSegmentStream || (i = i || { timelineStartInfo: { baseMediaDecodeTime: r.baseMediaDecodeTime }, codec: "adts", type: "audio" }, e.coalesceStream.numberOfTracks++ , e.audioSegmentStream = new Jt(i, t), e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)) }), e.coalesceStream.on("data", this.trigger.bind(this, "data")), e.coalesceStream.on("done", this.trigger.bind(this, "done")) }, this.setupTsPipeline = function () { var n = {}; this.transmuxPipeline_ = n, n.type = "ts", n.metadataStream = new wt.MetadataStream, n.packetStream = new wt.TransportPacketStream, n.parseStream = new wt.TransportParseStream, n.elementaryStream = new wt.ElementaryStream, n.videoTimestampRolloverStream = new wt.TimestampRolloverStream("video"), n.audioTimestampRolloverStream = new wt.TimestampRolloverStream("audio"), n.timedMetadataTimestampRolloverStream = new wt.TimestampRolloverStream("timed-metadata"), n.adtsStream = new Pt, n.h264Stream = new ue, n.captionStream = new wt.CaptionStream, n.coalesceStream = new Zt(t, n.metadataStream), n.headOfPipeline = n.packetStream, n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream), n.elementaryStream.pipe(n.videoTimestampRolloverStream).pipe(n.h264Stream), n.elementaryStream.pipe(n.audioTimestampRolloverStream).pipe(n.adtsStream), n.elementaryStream.pipe(n.timedMetadataTimestampRolloverStream).pipe(n.metadataStream).pipe(n.coalesceStream), n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream), n.elementaryStream.on("data", function (a) { var s; if ("metadata" === a.type) { for (s = a.tracks.length; s--;)e || "video" !== a.tracks[s].type ? i || "audio" !== a.tracks[s].type || (i = a.tracks[s], i.timelineStartInfo.baseMediaDecodeTime = r.baseMediaDecodeTime) : (e = a.tracks[s], e.timelineStartInfo.baseMediaDecodeTime = r.baseMediaDecodeTime); e && !n.videoSegmentStream && (n.coalesceStream.numberOfTracks++ , n.videoSegmentStream = new Kt(e, t), n.videoSegmentStream.on("timelineStartInfo", function (t) { i && (i.timelineStartInfo = t, n.audioSegmentStream.setEarliestDts(t.dts)) }), n.videoSegmentStream.on("processedGopsInfo", r.trigger.bind(r, "gopInfo")), n.videoSegmentStream.on("baseMediaDecodeTime", function (t) { i && n.audioSegmentStream.setVideoBaseMediaDecodeTime(t) }), n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)), i && !n.audioSegmentStream && (n.coalesceStream.numberOfTracks++ , n.audioSegmentStream = new Jt(i, t), n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream)) } }), n.coalesceStream.on("data", this.trigger.bind(this, "data")), n.coalesceStream.on("done", this.trigger.bind(this, "done")) }, this.setBaseMediaDecodeTime = function (t) { var r = this.transmuxPipeline_; this.baseMediaDecodeTime = t, i && (i.timelineStartInfo.dts = void 0, i.timelineStartInfo.pts = void 0, re(i), i.timelineStartInfo.baseMediaDecodeTime = t, r.audioTimestampRolloverStream && r.audioTimestampRolloverStream.discontinuity()), e && (r.videoSegmentStream && (r.videoSegmentStream.gopCache_ = [], r.videoTimestampRolloverStream.discontinuity()), e.timelineStartInfo.dts = void 0, e.timelineStartInfo.pts = void 0, re(e), r.captionStream.reset(), e.timelineStartInfo.baseMediaDecodeTime = t), r.timedMetadataTimestampRolloverStream && r.timedMetadataTimestampRolloverStream.discontinuity() }, this.setAudioAppendStart = function (t) { i && this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(t) }, this.alignGopsWith = function (t) { e && this.transmuxPipeline_.videoSegmentStream && this.transmuxPipeline_.videoSegmentStream.alignGopsWith(t) }, this.push = function (t) { if (n) { var e = ee(t); e && "aac" !== this.transmuxPipeline_.type ? this.setupAacPipeline() : e || "ts" === this.transmuxPipeline_.type || this.setupTsPipeline(), n = !1 } this.transmuxPipeline_.headOfPipeline.push(t) }, this.flush = function () { n = !0, this.transmuxPipeline_.headOfPipeline.flush() }, this.resetCaptions = function () { this.transmuxPipeline_.captionStream && this.transmuxPipeline_.captionStream.reset() } }, Qt.prototype = new W; var de = { Transmuxer: Qt, VideoSegmentStream: Kt, AudioSegmentStream: Jt, AUDIO_PROPERTIES: le, VIDEO_PROPERTIES: ce }, pe = { generator: V, Transmuxer: de.Transmuxer, AudioSegmentStream: de.AudioSegmentStream, VideoSegmentStream: de.VideoSegmentStream }, fe = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, me = function () { function t(t, e) { for (var i = 0; i < e.length; i++) { var r = e[i]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } return function (e, i, r) { return i && t(e.prototype, i), r && t(e, r), e } }(), ge = function (t) { t.on("data", function (t) { var e = t.initSegment; t.initSegment = { data: e.buffer, byteOffset: e.byteOffset, byteLength: e.byteLength }; var i = t.data; t.data = i.buffer, F.postMessage({ action: "data", segment: t, byteOffset: i.byteOffset, byteLength: i.byteLength }, [t.data]) }), t.captionStream && t.captionStream.on("data", function (t) { F.postMessage({ action: "caption", data: t }) }), t.on("done", function (t) { F.postMessage({ action: "done" }) }), t.on("gopInfo", function (t) { F.postMessage({ action: "gopInfo", gopInfo: t }) }) }, ye = function () { function t(e) { fe(this, t), this.options = e || {}, this.init() } return me(t, [{ key: "init", value: function () { this.transmuxer && this.transmuxer.dispose(), this.transmuxer = new pe.Transmuxer(this.options), ge(this.transmuxer) } }, { key: "push", value: function (t) { var e = new Uint8Array(t.data, t.byteOffset, t.byteLength); this.transmuxer.push(e) } }, { key: "reset", value: function () { this.init() } }, { key: "setTimestampOffset", value: function (t) { var e = t.timestampOffset || 0; this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4 * e)) } }, { key: "setAudioAppendStart", value: function (t) { this.transmuxer.setAudioAppendStart(Math.ceil(9e4 * t.appendStart)) } }, { key: "flush", value: function (t) { this.transmuxer.flush() } }, { key: "resetCaptions", value: function () { this.transmuxer.resetCaptions() } }, { key: "alignGopsWith", value: function (t) { this.transmuxer.alignGopsWith(t.gopsToAlignWith.slice()) } }]), t }(), ve = function (t) { t.onmessage = function (t) { return "init" === t.data.action && t.data.options ? void (this.messageHandlers = new ye(t.data.options)) : (this.messageHandlers || (this.messageHandlers = new ye), void (t.data && t.data.action && "init" !== t.data.action && this.messageHandlers[t.data.action] && this.messageHandlers[t.data.action](t.data))) } }, _e = new ve(i); return _e
    })()
  }), Yc = function (t) { return /mp4a\.\d+.\d+/i.test(t) }, $c = function (t) { return /avc1\.[\da-f]+/i.test(t) }, Kc = function (t) { var e = { type: "", parameters: {} }, i = t.trim().split(";"); return e.type = i.shift().trim(), i.forEach(function (t) { var i = t.trim().split("="); if (i.length > 1) { var r = i[0].replace(/"/g, "").trim(), n = i[1].replace(/"/g, "").trim(); e.parameters[r] = n } }), e }, Jc = function (t) { return t.map(function (t) { return t.replace(/avc1\.(\d+)\.(\d+)/i, function (t, e, i) { var r = ("00" + Number(e).toString(16)).slice(-2), n = ("00" + Number(i).toString(16)).slice(-2); return "avc1." + r + "00" + n }) }) }, Qc = function (t, e) { var i = t.addSourceBuffer(e), r = Object.create(null); r.updating = !1, r.realBuffer_ = i; var n = function (t) { "function" == typeof i[t] ? r[t] = function () { return i[t].apply(i, arguments) } : "undefined" == typeof r[t] && Object.defineProperty(r, t, { get: function () { return i[t] }, set: function (e) { return i[t] = e } }) }; for (var a in i) n(a); return r }, Zc = function (t, e, i) { if (!e || !t.length) return []; var r = Math.ceil(9e4 * (e.currentTime() - i + 3)), n = void 0; for (n = 0; n < t.length && !(t[n].pts > r); n++); return t.slice(n) }, th = function (t, e, i) { if (!e.length) return t; if (i) return e.slice(); var r = e[0].pts, n = 0; for (n; n < t.length && !(t[n].pts >= r); n++); return t.slice(0, n).concat(e) }, eh = function (t, e, i, r) { for (var n = Math.ceil(9e4 * (e - r)), a = Math.ceil(9e4 * (i - r)), s = t.slice(), o = t.length; o-- && !(t[o].pts <= a);); if (-1 === o) return s; for (var u = o + 1; u-- && !(t[u].pts <= n);); return u = Math.max(u, 0), s.splice(u, o - u + 1), s }, ih = function (t) { function e(t, i) { El(this, e); var r = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, ce.EventTarget)); r.timestampOffset_ = 0, r.pendingBuffers_ = [], r.bufferUpdating_ = !1, r.mediaSource_ = t, r.codecs_ = i, r.audioCodec_ = null, r.videoCodec_ = null, r.audioDisabled_ = !1, r.appendAudioInitSegment_ = !0, r.gopBuffer_ = [], r.timeMapping_ = 0, r.safeAppend_ = ce.browser.IE_VERSION >= 11; var n = { remux: !1, alignGopsAtEnd: r.safeAppend_ }; return r.codecs_.forEach(function (t) { Yc(t) ? r.audioCodec_ = t : $c(t) && (r.videoCodec_ = t) }), r.transmuxer_ = new Xc, r.transmuxer_.postMessage({ action: "init", options: n }), r.transmuxer_.onmessage = function (t) { return "data" === t.data.action ? r.data_(t) : "done" === t.data.action ? r.done_(t) : "gopInfo" === t.data.action ? r.appendGopInfo_(t) : void 0 }, Object.defineProperty(r, "timestampOffset", { get: function () { return this.timestampOffset_ }, set: function (t) { "number" == typeof t && t >= 0 && (this.timestampOffset_ = t, this.appendAudioInitSegment_ = !0, this.gopBuffer_.length = 0, this.timeMapping_ = 0, this.transmuxer_.postMessage({ action: "setTimestampOffset", timestampOffset: t })) } }), Object.defineProperty(r, "appendWindowStart", { get: function () { return (this.videoBuffer_ || this.audioBuffer_).appendWindowStart }, set: function (t) { this.videoBuffer_ && (this.videoBuffer_.appendWindowStart = t), this.audioBuffer_ && (this.audioBuffer_.appendWindowStart = t) } }), Object.defineProperty(r, "updating", { get: function () { return !!(this.bufferUpdating_ || !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.updating || this.videoBuffer_ && this.videoBuffer_.updating) } }), Object.defineProperty(r, "buffered", { get: function () { var t = null, e = null, i = 0, r = [], n = []; if (!this.videoBuffer_ && !this.audioBuffer_) return ce.createTimeRange(); if (!this.videoBuffer_) return this.audioBuffer_.buffered; if (!this.audioBuffer_) return this.videoBuffer_.buffered; if (this.audioDisabled_) return this.videoBuffer_.buffered; if (0 === this.videoBuffer_.buffered.length && 0 === this.audioBuffer_.buffered.length) return ce.createTimeRange(); for (var a = this.videoBuffer_.buffered, s = this.audioBuffer_.buffered, o = a.length; o--;)r.push({ time: a.start(o), type: "start" }), r.push({ time: a.end(o), type: "end" }); for (o = s.length; o--;)r.push({ time: s.start(o), type: "start" }), r.push({ time: s.end(o), type: "end" }); for (r.sort(function (t, e) { return t.time - e.time }), o = 0; o < r.length; o++)"start" === r[o].type ? (i++ , 2 === i && (t = r[o].time)) : "end" === r[o].type && (i-- , 1 === i && (e = r[o].time)), null !== t && null !== e && (n.push([t, e]), t = null, e = null); return ce.createTimeRanges(n) } }), r } return Al(e, t), Cl(e, [{ key: "data_", value: function (t) { var e = t.data.segment; e.data = new Uint8Array(e.data, t.data.byteOffset, t.data.byteLength), e.initSegment = new Uint8Array(e.initSegment.data, e.initSegment.byteOffset, e.initSegment.byteLength), xc(this, this.mediaSource_, e), this.pendingBuffers_.push(e) } }, { key: "done_", value: function (t) { return "closed" === this.mediaSource_.readyState ? void (this.pendingBuffers_.length = 0) : void this.processPendingSegments_() } }, { key: "createRealSourceBuffers_", value: function () { var t = this, e = ["audio", "video"]; e.forEach(function (i) { if (t[i + "Codec_"] && !t[i + "Buffer_"]) { var r = null; if (t.mediaSource_[i + "Buffer_"]) r = t.mediaSource_[i + "Buffer_"], r.updating = !1; else { var n = i + "Codec_", a = i + '/mp4;codecs="' + t[n] + '"'; r = Qc(t.mediaSource_.nativeMediaSource_, a), t.mediaSource_[i + "Buffer_"] = r } t[i + "Buffer_"] = r, ["update", "updatestart", "updateend"].forEach(function (n) { r.addEventListener(n, function () { if ("audio" !== i || !t.audioDisabled_) { "updateend" === n && (t[i + "Buffer_"].updating = !1); var r = e.every(function (e) { return "audio" === e && t.audioDisabled_ ? !0 : i !== e && t[e + "Buffer_"] && t[e + "Buffer_"].updating ? !1 : !0 }); return r ? t.trigger(n) : void 0 } }) }) } }) } }, { key: "appendBuffer", value: function (t) { if (this.bufferUpdating_ = !0, this.audioBuffer_ && this.audioBuffer_.buffered.length) { var e = this.audioBuffer_.buffered; this.transmuxer_.postMessage({ action: "setAudioAppendStart", appendStart: e.end(e.length - 1) }) } this.videoBuffer_ && this.transmuxer_.postMessage({ action: "alignGopsWith", gopsToAlignWith: Zc(this.gopBuffer_, this.mediaSource_.player_, this.timeMapping_) }), this.transmuxer_.postMessage({ action: "push", data: t.buffer, byteOffset: t.byteOffset, byteLength: t.byteLength }, [t.buffer]), this.transmuxer_.postMessage({ action: "flush" }) } }, { key: "appendGopInfo_", value: function (t) { this.gopBuffer_ = th(this.gopBuffer_, t.data.gopInfo, this.safeAppend_) } }, { key: "remove", value: function (t, e) { if (this.videoBuffer_ && (this.videoBuffer_.updating = !0, this.videoBuffer_.remove(t, e), this.gopBuffer_ = eh(this.gopBuffer_, t, e, this.timeMapping_)), !this.audioDisabled_ && this.audioBuffer_ && (this.audioBuffer_.updating = !0, this.audioBuffer_.remove(t, e)), Dc(t, e, this.metadataTrack_), this.inbandTextTracks_) for (var i in this.inbandTextTracks_) Dc(t, e, this.inbandTextTracks_[i]) } }, { key: "processPendingSegments_", value: function () { var t = { video: { segments: [], bytes: 0 }, audio: { segments: [], bytes: 0 }, captions: [], metadata: [] }; t = this.pendingBuffers_.reduce(function (t, e) { var i = e.type, r = e.data, n = e.initSegment; return t[i].segments.push(r), t[i].bytes += r.byteLength, t[i].initSegment = n, e.captions && (t.captions = t.captions.concat(e.captions)), e.info && (t[i].info = e.info), e.metadata && (t.metadata = t.metadata.concat(e.metadata)), t }, t), this.videoBuffer_ || this.audioBuffer_ || (0 === t.video.bytes && (this.videoCodec_ = null), 0 === t.audio.bytes && (this.audioCodec_ = null), this.createRealSourceBuffers_()), t.audio.info && this.mediaSource_.trigger({ type: "audioinfo", info: t.audio.info }), t.video.info && this.mediaSource_.trigger({ type: "videoinfo", info: t.video.info }), this.appendAudioInitSegment_ && (!this.audioDisabled_ && this.audioBuffer_ && (t.audio.segments.unshift(t.audio.initSegment), t.audio.bytes += t.audio.initSegment.byteLength), this.appendAudioInitSegment_ = !1); var e = !1; this.videoBuffer_ && t.video.bytes ? (t.video.segments.unshift(t.video.initSegment), t.video.bytes += t.video.initSegment.byteLength, this.concatAndAppendSegments_(t.video, this.videoBuffer_), Uc(this, t.captions, t.metadata)) : !this.videoBuffer_ || !this.audioDisabled_ && this.audioBuffer_ || (e = !0), !this.audioDisabled_ && this.audioBuffer_ && this.concatAndAppendSegments_(t.audio, this.audioBuffer_), this.pendingBuffers_.length = 0, e && this.trigger("updateend"), this.bufferUpdating_ = !1 } }, { key: "concatAndAppendSegments_", value: function (t, e) { var i = 0, r = void 0; if (t.bytes) { r = new Uint8Array(t.bytes), t.segments.forEach(function (t) { r.set(t, i), i += t.byteLength }); try { e.updating = !0, e.appendBuffer(r) } catch (n) { this.mediaSource_.player_ && this.mediaSource_.player_.error({ code: -3, type: "APPEND_BUFFER_ERR", message: n.message, originalError: n }) } } } }, { key: "abort", value: function () { this.videoBuffer_ && this.videoBuffer_.abort(), !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.abort(), this.transmuxer_ && this.transmuxer_.postMessage({ action: "reset" }), this.pendingBuffers_.length = 0, this.bufferUpdating_ = !1 } }]), e }(ce.EventTarget), rh = function (t) {
    function e() {
      El(this, e); var t = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)), i = void 0; t.nativeMediaSource_ = new Te.MediaSource; for (i in t.nativeMediaSource_) i in e.prototype || "function" != typeof t.nativeMediaSource_[i] || (t[i] = t.nativeMediaSource_[i].bind(t.nativeMediaSource_)); return t.duration_ = NaN, Object.defineProperty(t, "duration", { get: function () { return this.duration_ === 1 / 0 ? this.duration_ : this.nativeMediaSource_.duration }, set: function (t) { return this.duration_ = t, t !== 1 / 0 ? void (this.nativeMediaSource_.duration = t) : void 0 } }), Object.defineProperty(t, "seekable", { get: function () { return this.duration_ === 1 / 0 ? ce.createTimeRanges([[0, this.nativeMediaSource_.duration]]) : this.nativeMediaSource_.seekable } }), Object.defineProperty(t, "readyState", { get: function () { return this.nativeMediaSource_.readyState } }), Object.defineProperty(t, "activeSourceBuffers", { get: function () { return this.activeSourceBuffers_ } }), t.sourceBuffers = [], t.activeSourceBuffers_ = [], t.updateActiveSourceBuffers_ = function () { if (t.activeSourceBuffers_.length = 0, 1 === t.sourceBuffers.length) { var e = t.sourceBuffers[0]; return e.appendAudioInitSegment_ = !0, e.audioDisabled_ = !e.audioCodec_, void t.activeSourceBuffers_.push(e) } for (var i = !1, r = !0, n = 0; n < t.player_.audioTracks().length; n++) { var a = t.player_.audioTracks()[n]; if (a.enabled && "main" !== a.kind) { i = !0, r = !1; break } } t.sourceBuffers.forEach(function (e, n) { if (e.appendAudioInitSegment_ = !0, e.videoCodec_ && e.audioCodec_) e.audioDisabled_ = i; else if (e.videoCodec_ && !e.audioCodec_) e.audioDisabled_ = !0, r = !1; else if (!e.videoCodec_ && e.audioCodec_ && (e.audioDisabled_ = n ? r : !r, e.audioDisabled_)) return; t.activeSourceBuffers_.push(e) }) }, t.onPlayerMediachange_ = function () { t.sourceBuffers.forEach(function (t) { t.appendAudioInitSegment_ = !0 }) }, t.onHlsReset_ = function () { t.sourceBuffers.forEach(function (t) { t.transmuxer_ && t.transmuxer_.postMessage({ action: "resetCaptions" }) }) }, t.onHlsSegmentTimeMapping_ = function (e) { t.sourceBuffers.forEach(function (t) { return t.timeMapping_ = e.mapping }) }, ["sourceopen", "sourceclose", "sourceended"].forEach(function (t) { this.nativeMediaSource_.addEventListener(t, this.trigger.bind(this)) }, t), t.on("sourceopen", function (e) {
        var i = we.querySelector('[src="' + t.url_ + '"]'); i && (t.player_ = ce(i.parentNode), t.player_.tech_.on("hls-reset", t.onHlsReset_), t.player_.tech_.on("hls-segment-time-mapping", t.onHlsSegmentTimeMapping_),
          t.player_.audioTracks && t.player_.audioTracks() && (t.player_.audioTracks().on("change", t.updateActiveSourceBuffers_), t.player_.audioTracks().on("addtrack", t.updateActiveSourceBuffers_), t.player_.audioTracks().on("removetrack", t.updateActiveSourceBuffers_)), t.player_.on("mediachange", t.onPlayerMediachange_))
      }), t.on("sourceended", function (e) { for (var i = Mc(t.duration), r = 0; r < t.sourceBuffers.length; r++) { var n = t.sourceBuffers[r], a = n.metadataTrack_ && n.metadataTrack_.cues; a && a.length && (a[a.length - 1].endTime = i) } }), t.on("sourceclose", function (t) { this.sourceBuffers.forEach(function (t) { t.transmuxer_ && t.transmuxer_.terminate() }), this.sourceBuffers.length = 0, this.player_ && (this.player_.audioTracks && this.player_.audioTracks() && (this.player_.audioTracks().off("change", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("addtrack", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("removetrack", this.updateActiveSourceBuffers_)), this.player_.el_ && (this.player_.off("mediachange", this.onPlayerMediachange_), this.player_.tech_.off("hls-reset", this.onHlsReset_), this.player_.tech_.off("hls-segment-time-mapping", this.onHlsSegmentTimeMapping_))) }), t
    } return Al(e, t), Cl(e, [{ key: "addSeekableRange_", value: function (t, e) { var i = void 0; if (this.duration !== 1 / 0) throw i = new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"), i.name = "InvalidStateError", i.code = 11, i; (e > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) && (this.nativeMediaSource_.duration = e) } }, { key: "addSourceBuffer", value: function (t) { var e = void 0, i = Kc(t); if (/^(video|audio)\/mp2t$/i.test(i.type)) { var r = []; i.parameters && i.parameters.codecs && (r = i.parameters.codecs.split(","), r = Jc(r), r = r.filter(function (t) { return Yc(t) || $c(t) })), 0 === r.length && (r = ["avc1.4d400d", "mp4a.40.2"]), e = new ih(this, r), 0 !== this.sourceBuffers.length && (this.sourceBuffers[0].createRealSourceBuffers_(), e.createRealSourceBuffers_(), this.sourceBuffers[0].audioDisabled_ = !0) } else e = this.nativeMediaSource_.addSourceBuffer(t); return this.sourceBuffers.push(e), e } }]), e
  }(ce.EventTarget), nh = 0; ce.mediaSources = {}; var ah = function (t, e) { var i = ce.mediaSources[t]; if (!i) throw new Error("Media Source not found (Video.js)"); i.trigger({ type: "sourceopen", swfId: e }) }, sh = function () { return !!Te.MediaSource && !!Te.MediaSource.isTypeSupported && Te.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"') }, oh = function () { if (this.MediaSource = { open: ah, supportsNativeMediaSources: sh }, sh()) return new rh; throw new Error("Cannot use create a virtual MediaSource for this video") }; oh.open = ah, oh.supportsNativeMediaSources = sh; var uh = { createObjectURL: function (t) { var e = "blob:vjs-media-source/", i = void 0; return t instanceof rh ? (i = Te.URL.createObjectURL(t.nativeMediaSource_), t.url_ = i, i) : t instanceof rh ? (i = e + nh, nh++ , ce.mediaSources[i] = t, i) : (i = Te.URL.createObjectURL(t), t.url_ = i, i) } }; ce.MediaSource = oh, ce.URL = uh; var lh = ce.EventTarget, ch = ce.mergeOptions, hh = function (t, e) { for (var i = ch(t, { duration: e.duration, minimumUpdatePeriod: e.minimumUpdatePeriod }), r = 0; r < e.playlists.length; r++) { var n = Ul(i, e.playlists[r]); n && (i = n) } return Dl(e, function (t, e, r, n) { if (t.playlists && t.playlists.length) { var a = t.playlists[0].uri, s = Ul(i, t.playlists[0]); s && (i = s, i.mediaGroups[e][r][n].playlists[0] = i.playlists[a]) } }), i }, dh = function (t) { function e(t, i, r, n) { El(this, e); var a = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)); if (a.hls_ = i, a.withCredentials = r, !t) throw new Error("A non-empty playlist URL or playlist is required"); return a.on("minimumUpdatePeriod", function () { a.refreshXml_() }), a.on("mediaupdatetimeout", function () { a.refreshMedia_() }), "string" == typeof t ? (a.srcUrl = t, a.state = "HAVE_NOTHING", Ll(a)) : (a.masterPlaylistLoader_ = n, a.state = "HAVE_METADATA", a.started = !0, a.media(t), Te.setTimeout(function () { a.trigger("loadedmetadata") }, 0), a) } return Al(e, t), Cl(e, [{ key: "dispose", value: function () { this.stopRequest(), Te.clearTimeout(this.mediaUpdateTimeout) } }, { key: "stopRequest", value: function () { if (this.request) { var t = this.request; this.request = null, t.onreadystatechange = null, t.abort() } } }, { key: "media", value: function (t) { if (!t) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); var e = this.state; if ("string" == typeof t) { if (!this.master.playlists[t]) throw new Error("Unknown playlist URI: " + t); t = this.master.playlists[t] } var i = !this.media_ || t.uri !== this.media_.uri; this.state = "HAVE_METADATA", i && (this.media_ && this.trigger("mediachanging"), this.media_ = t, this.refreshMedia_(), "HAVE_MASTER" !== e && this.trigger("mediachange")) } }, { key: "pause", value: function () { this.stopRequest(), "HAVE_NOTHING" === this.state && (this.started = !1) } }, { key: "load", value: function () { return this.started ? void this.trigger("loadedplaylist") : void this.start() } }, { key: "parseMasterXml", value: function () { var t = Fo(this.masterXml_, { manifestUri: this.srcUrl, clientOffset: this.clientOffset_ }); t.uri = this.srcUrl; for (var e = 0; e < t.playlists.length; e++) { var i = "placeholder-uri-" + e; t.playlists[e].uri = i, t.playlists[i] = t.playlists[e] } return Dl(t, function (e, i, r, n) { if (e.playlists && e.playlists.length) { var a = "placeholder-uri-" + i + "-" + r + "-" + n; e.playlists[0].uri = a, t.playlists[a] = e.playlists[0] } }), Nl(t), Bl(t), t } }, { key: "start", value: function () { var t = this; this.started = !0, this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (e, i) { if (t.request) { if (t.request = null, e) return t.error = { status: i.status, message: "DASH playlist request error at URL: " + t.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); t.masterXml_ = i.responseText, i.responseHeaders && i.responseHeaders.date ? t.masterLoaded_ = Date.parse(i.responseHeaders.date) : t.masterLoaded_ = Date.now(), t.syncClientServerClock_(t.onClientServerClockSync_.bind(t)) } }) } }, { key: "syncClientServerClock_", value: function (t) { var e = this, i = Ho(this.masterXml_); return null === i ? (this.clientOffset_ = this.masterLoaded_ - Date.now(), t()) : "DIRECT" === i.method ? (this.clientOffset_ = i.value - Date.now(), t()) : void (this.request = this.hls_.xhr({ uri: kl(this.srcUrl, i.value), method: i.method, withCredentials: this.withCredentials }, function (r, n) { if (e.request) { if (r) return e.clientOffset_ = e.masterLoaded_ - Date.now(), t(); var a = void 0; a = "HEAD" === i.method ? n.responseHeaders && n.responseHeaders.date ? Date.parse(n.responseHeaders.date) : e.masterLoaded_ : Date.parse(n.responseText), e.clientOffset_ = a - Date.now(), t() } })) } }, { key: "onClientServerClockSync_", value: function () { var t = this; this.master = this.parseMasterXml(), this.state = "HAVE_MASTER", this.trigger("loadedplaylist"), this.media_ || this.media(this.master.playlists[0]), Te.setTimeout(function () { t.trigger("loadedmetadata") }, 0), this.master.minimumUpdatePeriod && Te.setTimeout(function () { t.trigger("minimumUpdatePeriod") }, this.master.minimumUpdatePeriod) } }, { key: "refreshXml_", value: function () { var t = this; this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (e, i) { if (t.request) { if (t.request = null, e) return t.error = { status: i.status, message: "DASH playlist request error at URL: " + t.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); t.masterXml_ = i.responseText; var r = t.parseMasterXml(); t.master = hh(t.master, r), Te.setTimeout(function () { t.trigger("minimumUpdatePeriod") }, t.master.minimumUpdatePeriod) } }) } }, { key: "refreshMedia_", value: function () { var t = this, e = void 0, i = void 0; this.masterPlaylistLoader_ ? (e = this.masterPlaylistLoader_.master, i = this.masterPlaylistLoader_.parseMasterXml()) : (e = this.master, i = this.parseMasterXml()); var r = hh(e, i); r ? (this.masterPlaylistLoader_ ? this.masterPlaylistLoader_.master = r : this.master = r, this.media_ = r.playlists[this.media_.uri]) : this.trigger("playlistunchanged"), this.media().endList || (this.mediaUpdateTimeout = Te.setTimeout(function () { t.trigger("mediaupdatetimeout") }, jl(this.media(), !!r))), this.trigger("loadedplaylist") } }]), e }(lh), ph = function (t) { return ce.log.debug ? ce.log.debug.bind(ce, "VHS:", t + " >") : function () { } }, fh = function () { function t(e, i, r, n) { El(this, t), this.callbacks_ = [], this.pendingCallback_ = null, this.timestampOffset_ = 0, this.mediaSource = e, this.processedAppend_ = !1, this.type_ = r, this.mimeType_ = i, this.logger_ = ph("SourceUpdater[" + r + "][" + i + "]"), "closed" === e.readyState ? e.addEventListener("sourceopen", this.createSourceBuffer_.bind(this, i, n)) : this.createSourceBuffer_(i, n) } return Cl(t, [{ key: "createSourceBuffer_", value: function (t, e) { var i = this; return this.sourceBuffer_ = this.mediaSource.addSourceBuffer(t), this.logger_("created SourceBuffer"), e && (e.trigger("sourcebufferadded"), this.mediaSource.sourceBuffers.length < 2) ? void e.on("sourcebufferadded", function () { i.start_() }) : void this.start_() } }, { key: "start_", value: function () { var t = this; this.started_ = !0, this.onUpdateendCallback_ = function () { var e = t.pendingCallback_; t.pendingCallback_ = null, t.logger_("buffered [" + Pc(t.buffered()) + "]"), e && e(), t.runCallback_() }, this.sourceBuffer_.addEventListener("updateend", this.onUpdateendCallback_), this.runCallback_() } }, { key: "abort", value: function (t) { var e = this; this.processedAppend_ && this.queueCallback_(function () { e.sourceBuffer_.abort() }, t) } }, { key: "appendBuffer", value: function (t, e) { var i = this; this.processedAppend_ = !0, this.queueCallback_(function () { i.sourceBuffer_.appendBuffer(t) }, e) } }, { key: "buffered", value: function () { return this.sourceBuffer_ ? this.sourceBuffer_.buffered : ce.createTimeRanges() } }, { key: "remove", value: function (t, e) { var i = this; this.processedAppend_ && this.queueCallback_(function () { i.logger_("remove [" + t + " => " + e + "]"), i.sourceBuffer_.remove(t, e) }, ge) } }, { key: "updating", value: function () { return !this.sourceBuffer_ || this.sourceBuffer_.updating || this.pendingCallback_ } }, { key: "timestampOffset", value: function (t) { var e = this; return "undefined" != typeof t && (this.queueCallback_(function () { e.sourceBuffer_.timestampOffset = t }), this.timestampOffset_ = t), this.timestampOffset_ } }, { key: "queueCallback_", value: function (t, e) { this.callbacks_.push([t.bind(this), e]), this.runCallback_() } }, { key: "runCallback_", value: function () { var t = void 0; !this.updating() && this.callbacks_.length && this.started_ && (t = this.callbacks_.shift(), this.pendingCallback_ = t[1], t[0]()) } }, { key: "dispose", value: function () { this.sourceBuffer_.removeEventListener("updateend", this.onUpdateendCallback_), this.sourceBuffer_ && "open" === this.mediaSource.readyState && this.sourceBuffer_.abort() } }]), t }(), mh = { GOAL_BUFFER_LENGTH: 30, MAX_GOAL_BUFFER_LENGTH: 60, GOAL_BUFFER_LENGTH_RATE: 1, BANDWIDTH_VARIANCE: 1.2, BUFFER_LOW_WATER_LINE: 0, MAX_BUFFER_LOW_WATER_LINE: 30, BUFFER_LOW_WATER_LINE_RATE: 1 }, gh = { FAILURE: 2, TIMEOUT: -101, ABORTED: -102 }, yh = function (t) { var e = void 0, i = void 0; return i = t.offset + t.length - 1, e = t.offset, "bytes=" + e + "-" + i }, vh = function (t) { var e = {}; return t.byterange && (e.Range = yh(t.byterange)), e }, _h = function (t) { t.forEach(function (t) { t.abort() }) }, bh = function (t) { return { bandwidth: t.bandwidth, bytesReceived: t.bytesReceived || 0, roundTripTime: t.roundTripTime || 0 } }, Th = function (t) { var e = t.target, i = Date.now() - e.requestTime, r = { bandwidth: 1 / 0, bytesReceived: 0, roundTripTime: i || 0 }; return r.bytesReceived = t.loaded, r.bandwidth = Math.floor(r.bytesReceived / r.roundTripTime * 8 * 1e3), r }, Sh = function (t, e) { return e.timedout ? { status: e.status, message: "HLS request timed-out at URL: " + e.uri, code: gh.TIMEOUT, xhr: e } : e.aborted ? { status: e.status, message: "HLS request aborted at URL: " + e.uri, code: gh.ABORTED, xhr: e } : t ? { status: e.status, message: "HLS request errored at URL: " + e.uri, code: gh.FAILURE, xhr: e } : null }, kh = function (t, e) { return function (i, r) { var n = r.response, a = Sh(i, r); if (a) return e(a, t); if (16 !== n.byteLength) return e({ status: r.status, message: "Invalid HLS key at URL: " + r.uri, code: gh.FAILURE, xhr: r }, t); var s = new DataView(n); return t.key.bytes = new Uint32Array([s.getUint32(0), s.getUint32(4), s.getUint32(8), s.getUint32(12)]), e(null, t) } }, Eh = function (t, e) { return function (i, r) { var n = r.response, a = Sh(i, r); return a ? e(a, t) : 0 === n.byteLength ? e({ status: r.status, message: "Empty HLS segment content at URL: " + r.uri, code: gh.FAILURE, xhr: r }, t) : (t.map.bytes = new Uint8Array(r.response), e(null, t)) } }, Ch = function (t, e) { return function (i, r) { var n = r.response, a = Sh(i, r); return a ? e(a, t) : 0 === n.byteLength ? e({ status: r.status, message: "Empty HLS segment content at URL: " + r.uri, code: gh.FAILURE, xhr: r }, t) : (t.stats = bh(r), t.key ? t.encryptedBytes = new Uint8Array(r.response) : t.bytes = new Uint8Array(r.response), e(null, t)) } }, wh = function (t, e, i) { var r = function n(r) { if (r.data.source === e.requestId) { t.removeEventListener("message", n); var a = r.data.decrypted; return e.bytes = new Uint8Array(a.bytes, a.byteOffset, a.byteLength), i(null, e) } }; t.addEventListener("message", r), t.postMessage(yc({ source: e.requestId, encrypted: e.encryptedBytes, key: e.key.bytes, iv: e.key.iv }), [e.encryptedBytes.buffer, e.key.bytes.buffer]) }, Ah = function (t) { return t.reduce(function (t, e) { return e.code > t.code ? e : t }) }, Lh = function (t, e, i) { var r = [], n = 0; return function (a, s) { if (a && (_h(t), r.push(a)), n += 1, n === t.length) { if (s.endOfAllRequests = Date.now(), r.length > 0) { var o = Ah(r); return i(o, s) } return s.encryptedBytes ? wh(e, s, i) : i(null, s) } } }, Ph = function (t, e) { return function (i) { return t.stats = ce.mergeOptions(t.stats, Th(i)), !t.stats.firstBytesReceivedAt && t.stats.bytesReceived && (t.stats.firstBytesReceivedAt = Date.now()), e(i, t) } }, Oh = function (t, e, i, r, n, a) { var s = [], o = Lh(s, i, a); if (r.key) { var u = ce.mergeOptions(e, { uri: r.key.resolvedUri, responseType: "arraybuffer" }), l = kh(r, o), c = t(u, l); s.push(c) } if (r.map && !r.map.bytes) { var h = ce.mergeOptions(e, { uri: r.map.resolvedUri, responseType: "arraybuffer", headers: vh(r.map) }), d = Eh(r, o), p = t(h, d); s.push(p) } var f = ce.mergeOptions(e, { uri: r.resolvedUri, responseType: "arraybuffer", headers: vh(r) }), m = Ch(r, o), g = t(f, m); return g.addEventListener("progress", Ph(r, n)), s.push(g), function () { return _h(s) } }, Ih = { videoCodec: "avc1", videoObjectTypeIndicator: ".4d400d", audioProfile: "2" }, xh = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "", e = { codecCount: 0 }, i = void 0; return e.codecCount = t.split(",").length, e.codecCount = e.codecCount || 2, i = /(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t), i && (e.videoCodec = i[2], e.videoObjectTypeIndicator = i[3]), e.audioProfile = /(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t), e.audioProfile = e.audioProfile && e.audioProfile[2], e }, Dh = function (t) { return t.replace(/avc1\.(\d+)\.(\d+)/i, function (t) { return Jc([t])[0] }) }, Rh = function (t, e, i) { return t + "/" + e + '; codecs="' + i.filter(function (t) { return !!t }).join(", ") + '"' }, Mh = function (t) { return t.segments && t.segments.length && t.segments[0].map ? "mp4" : "mp2t" }, Uh = function (t) { var e = t.attributes || {}; return e.CODECS ? xh(e.CODECS) : Ih }, Nh = function (t, e) { if (!t.mediaGroups.AUDIO || !e) return null; var i = t.mediaGroups.AUDIO[e]; if (!i) return null; for (var r in i) { var n = i[r]; if (n["default"] && n.playlists) return xh(n.playlists[0].attributes.CODECS).audioProfile } return null }, Bh = function (t, e) { var i = Mh(e), r = Uh(e), n = e.attributes || {}, a = !0, s = !1; if (!e) return []; if (t.mediaGroups.AUDIO && n.AUDIO) { var o = t.mediaGroups.AUDIO[n.AUDIO]; if (o) { s = !0, a = !1; for (var u in o) if (!o[u].uri && !o[u].playlists) { a = !0; break } } } s && !r.audioProfile && (a || (r.audioProfile = Nh(t, n.AUDIO)), r.audioProfile || (ce.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"), r.audioProfile = Ih.audioProfile)); var l = {}; r.videoCodec && (l.video = "" + r.videoCodec + r.videoObjectTypeIndicator), r.audioProfile && (l.audio = "mp4a.40." + r.audioProfile); var c = Rh("audio", i, [l.audio]), h = Rh("video", i, [l.video]), d = Rh("video", i, [l.video, l.audio]); return s ? !a && l.video ? [h, c] : a || l.video ? [d, c] : [c, c] : l.video ? [d] : [c] }, jh = function (t, e) { var i = void 0; return t ? (i = Te.getComputedStyle(t), i ? i[e] : "") : "" }, Fh = function (t, e) { var i = t.slice(); t.sort(function (t, r) { var n = e(t, r); return 0 === n ? i.indexOf(t) - i.indexOf(r) : n }) }, Hh = function (t, e) { var i = void 0, r = void 0; return t.attributes.BANDWIDTH && (i = t.attributes.BANDWIDTH), i = i || Te.Number.MAX_VALUE, e.attributes.BANDWIDTH && (r = e.attributes.BANDWIDTH), r = r || Te.Number.MAX_VALUE, i - r }, Vh = function (t, e) { var i = void 0, r = void 0; return t.attributes.RESOLUTION && t.attributes.RESOLUTION.width && (i = t.attributes.RESOLUTION.width), i = i || Te.Number.MAX_VALUE, e.attributes.RESOLUTION && e.attributes.RESOLUTION.width && (r = e.attributes.RESOLUTION.width), r = r || Te.Number.MAX_VALUE, i === r && t.attributes.BANDWIDTH && e.attributes.BANDWIDTH ? t.attributes.BANDWIDTH - e.attributes.BANDWIDTH : i - r }, qh = function (t, e, i, r) { var n = t.playlists.map(function (t) { var e = void 0, i = void 0, r = void 0; return e = t.attributes.RESOLUTION && t.attributes.RESOLUTION.width, i = t.attributes.RESOLUTION && t.attributes.RESOLUTION.height, r = t.attributes.BANDWIDTH, r = r || Te.Number.MAX_VALUE, { bandwidth: r, width: e, height: i, playlist: t } }); Fh(n, function (t, e) { return t.bandwidth - e.bandwidth }), n = n.filter(function (t) { return !cc.isIncompatible(t.playlist) }); var a = n.filter(function (t) { return cc.isEnabled(t.playlist) }); a.length || (a = n.filter(function (t) { return !cc.isDisabled(t.playlist) })); var s = a.filter(function (t) { return t.bandwidth * mh.BANDWIDTH_VARIANCE < e }), o = s[s.length - 1], u = s.filter(function (t) { return t.bandwidth === o.bandwidth })[0], l = s.filter(function (t) { return t.width && t.height }); Fh(l, function (t, e) { return t.width - e.width }); var c = l.filter(function (t) { return t.width === i && t.height === r }); o = c[c.length - 1]; var h = c.filter(function (t) { return t.bandwidth === o.bandwidth })[0], d = void 0, p = void 0, f = void 0; h || (d = l.filter(function (t) { return t.width > i || t.height > r }), p = d.filter(function (t) { return t.width === d[0].width && t.height === d[0].height }), o = p[p.length - 1], f = p.filter(function (t) { return t.bandwidth === o.bandwidth })[0]); var m = f || h || u || a[0] || n[0]; return m ? m.playlist : null }, Wh = function () { return qh(this.playlists.master, this.systemBandwidth, parseInt(jh(this.tech_.el(), "width"), 10), parseInt(jh(this.tech_.el(), "height"), 10)) }, zh = function (t) { var e = t.master, i = t.currentTime, r = t.bandwidth, n = t.duration, a = t.segmentDuration, s = t.timeUntilRebuffer, o = t.currentTimeline, u = t.syncController, l = e.playlists.filter(function (t) { return !cc.isIncompatible(t) }), c = l.filter(cc.isEnabled); c.length || (c = l.filter(function (t) { return !cc.isDisabled(t) })); var h = c.filter(cc.hasAttribute.bind(null, "BANDWIDTH")), d = h.map(function (t) { var e = u.getSyncPoint(t, n, o, i), l = e ? 1 : 2, c = cc.estimateSegmentRequestTime(a, r, t), h = c * l - s; return { playlist: t, rebufferingImpact: h } }), p = d.filter(function (t) { return t.rebufferingImpact <= 0 }); return Fh(p, function (t, e) { return Hh(e.playlist, t.playlist) }), p.length ? p[0] : (Fh(d, function (t, e) { return t.rebufferingImpact - e.rebufferingImpact }), d[0] || null) }, Gh = function () { var t = this.playlists.master.playlists.filter(cc.isEnabled); Fh(t, function (t, e) { return Hh(t, e) }); var e = t.filter(function (t) { return xh(t.attributes.CODECS).videoCodec }); return e[0] || null }, Xh = 500, Yh = function (t, e, i) { if (!t || !e) return !1; var r = t.segments, n = i === r.length; return t.endList && "open" === e.readyState && n }, $h = function (t) { return "number" == typeof t && isFinite(t) }, Kh = function (t, e, i) { return "main" === t && e && i ? i.containsAudio || i.containsVideo ? e.containsVideo && !i.containsVideo ? "Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest." : !e.containsVideo && i.containsVideo ? "Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest." : null : "Neither audio nor video found in segment." : null }, Jh = function (t, e, i) { var r = void 0; return r = t.length && t.start(0) > 0 && t.start(0) < e ? t.start(0) : e - 30, Math.min(r, e - i) }, Qh = function (t) { var e = t.segment, i = e.start, r = e.end, n = t.playlist, a = n.mediaSequence, s = n.id, o = n.segments, u = void 0 === o ? [] : o, l = t.mediaIndex, c = t.timeline; return ["appending [" + l + "] of [" + a + ", " + (a + u.length) + "] from playlist [" + s + "]", "[" + i + " => " + r + "] in timeline [" + c + "]"].join(" ") }, Zh = function (t) {
    function e(t) { El(this, e); var i = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)); if (!t) throw new TypeError("Initialization settings are required"); if ("function" != typeof t.currentTime) throw new TypeError("No currentTime getter specified"); if (!t.mediaSource) throw new TypeError("No MediaSource specified"); return i.bandwidth = t.bandwidth, i.throughput = { rate: 0, count: 0 }, i.roundTrip = NaN, i.resetStats_(), i.mediaIndex = null, i.hasPlayed_ = t.hasPlayed, i.currentTime_ = t.currentTime, i.seekable_ = t.seekable, i.seeking_ = t.seeking, i.duration_ = t.duration, i.mediaSource_ = t.mediaSource, i.hls_ = t.hls, i.loaderType_ = t.loaderType, i.startingMedia_ = void 0, i.segmentMetadataTrack_ = t.segmentMetadataTrack, i.goalBufferLength_ = t.goalBufferLength, i.sourceType_ = t.sourceType, i.state_ = "INIT", i.checkBufferTimeout_ = null, i.error_ = void 0, i.currentTimeline_ = -1, i.pendingSegment_ = null, i.mimeType_ = null, i.sourceUpdater_ = null, i.xhrOptions_ = null, i.activeInitSegmentId_ = null, i.initSegments_ = {}, i.decrypter_ = t.decrypter, i.syncController_ = t.syncController, i.syncPoint_ = { segmentIndex: 0, time: 0 }, i.syncController_.on("syncinfoupdate", function () { return i.trigger("syncinfoupdate") }), i.mediaSource_.addEventListener("sourceopen", function () { return i.ended_ = !1 }), i.fetchAtBuffer_ = !1, i.logger_ = ph("SegmentLoader[" + i.loaderType_ + "]"), Object.defineProperty(i, "state", { get: function () { return this.state_ }, set: function (t) { t !== this.state_ && (this.logger_(this.state_ + " -> " + t), this.state_ = t) } }), i } return Al(e, t), Cl(e, [{ key: "resetStats_", value: function () { this.mediaBytesTransferred = 0, this.mediaRequests = 0, this.mediaRequestsAborted = 0, this.mediaRequestsTimedout = 0, this.mediaRequestsErrored = 0, this.mediaTransferDuration = 0, this.mediaSecondsLoaded = 0 } }, { key: "dispose", value: function () { this.state = "DISPOSED", this.pause(), this.abort_(), this.sourceUpdater_ && this.sourceUpdater_.dispose(), this.resetStats_() } }, { key: "abort", value: function () { return "WAITING" !== this.state ? void (this.pendingSegment_ && (this.pendingSegment_ = null)) : (this.abort_(), this.state = "READY", void (this.paused() || this.monitorBuffer_())) } }, { key: "abort_", value: function () { this.pendingSegment_ && this.pendingSegment_.abortRequests(), this.pendingSegment_ = null } }, { key: "error", value: function (t) { return "undefined" != typeof t && (this.error_ = t), this.pendingSegment_ = null, this.error_ } }, { key: "endOfStream", value: function () { this.ended_ = !0, this.pause(), this.trigger("ended") } }, { key: "buffered_", value: function () { return this.sourceUpdater_ ? this.sourceUpdater_.buffered() : ce.createTimeRanges() } }, { key: "initSegment", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : !1; if (!t) return null; var i = vc(t), r = this.initSegments_[i]; return e && !r && t.bytes && (this.initSegments_[i] = r = { resolvedUri: t.resolvedUri, byterange: t.byterange, bytes: t.bytes }), r || t } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && (this.sourceUpdater_ || this.mimeType_ && "INIT" === this.state) && !this.paused() } }, { key: "load", value: function () { return this.monitorBuffer_(), this.playlist_ ? (this.syncController_.setDateTimeMapping(this.playlist_), "INIT" === this.state && this.couldBeginLoading_() ? this.init_() : void (!this.couldBeginLoading_() || "READY" !== this.state && "INIT" !== this.state || (this.state = "READY"))) : void 0 } }, { key: "init_", value: function () { return this.state = "READY", this.sourceUpdater_ = new fh(this.mediaSource_, this.mimeType_, this.loaderType_, this.sourceBufferEmitter_), this.resetEverything(), this.monitorBuffer_() } }, { key: "playlist", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if (t) { var i = this.playlist_, r = this.pendingSegment_; this.playlist_ = t, this.xhrOptions_ = e, this.hasPlayed_() || (t.syncInfo = { mediaSequence: t.mediaSequence, time: 0 }); var n = i ? i.id : null; if (this.logger_("playlist update [" + n + " => " + t.id + "]"), this.trigger("syncinfoupdate"), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); if (!i || i.uri !== t.uri) return void (null !== this.mediaIndex && this.resyncLoader()); var a = t.mediaSequence - i.mediaSequence; this.logger_("live window shift [" + a + "]"), null !== this.mediaIndex && (this.mediaIndex -= a), r && (r.mediaIndex -= a, r.mediaIndex >= 0 && (r.segment = t.segments[r.mediaIndex])), this.syncController_.saveExpiredSegmentInfo(i, t) } } }, { key: "pause", value: function () { this.checkBufferTimeout_ && (Te.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = null) } }, { key: "paused", value: function () { return null === this.checkBufferTimeout_ } }, { key: "mimeType", value: function (t, e) { this.mimeType_ || (this.mimeType_ = t, this.sourceBufferEmitter_ = e, "INIT" === this.state && this.couldBeginLoading_() && this.init_()) } }, { key: "resetEverything", value: function () { this.ended_ = !1, this.resetLoader(), this.remove(0, this.duration_()), this.trigger("reseteverything") } }, { key: "resetLoader", value: function () { this.fetchAtBuffer_ = !1, this.resyncLoader() } }, { key: "resyncLoader", value: function () { this.mediaIndex = null, this.syncPoint_ = null, this.abort() } }, { key: "remove", value: function (t, e) { this.sourceUpdater_ && this.sourceUpdater_.remove(t, e), Dc(t, e, this.segmentMetadataTrack_) } }, { key: "monitorBuffer_", value: function () { this.checkBufferTimeout_ && Te.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = Te.setTimeout(this.monitorBufferTick_.bind(this), 1) } }, { key: "monitorBufferTick_", value: function () { "READY" === this.state && this.fillBuffer_(), this.checkBufferTimeout_ && Te.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = Te.setTimeout(this.monitorBufferTick_.bind(this), Xh) } }, { key: "fillBuffer_", value: function () { if (!this.sourceUpdater_.updating()) { this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())); var t = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_); if (t) { var e = Yh(this.playlist_, this.mediaSource_, t.mediaIndex); return e ? void this.endOfStream() : void ((t.mediaIndex !== this.playlist_.segments.length - 1 || "ended" !== this.mediaSource_.readyState || this.seeking_()) && ((t.timeline !== this.currentTimeline_ || null !== t.startOfSegment && t.startOfSegment < this.sourceUpdater_.timestampOffset()) && (this.syncController_.reset(), t.timestampOffset = t.startOfSegment), this.loadSegment_(t))) } } } }, { key: "checkBuffer_", value: function (t, e, i, r, n, a) { var s = 0, o = void 0; t.length && (s = t.end(t.length - 1)); var u = Math.max(0, s - n); if (!e.segments.length) return null; if (u >= this.goalBufferLength_()) return null; if (!r && u >= 1) return null; if (null === a) return i = this.getSyncSegmentCandidate_(e), this.generateSegmentInfo_(e, i, null, !0); if (null !== i) { var l = e.segments[i]; return o = l && l.end ? l.end : s, this.generateSegmentInfo_(e, i + 1, o, !1) } if (this.fetchAtBuffer_) { var c = cc.getMediaInfoForTime(e, s, a.segmentIndex, a.time); i = c.mediaIndex, o = c.startTime } else { var h = cc.getMediaInfoForTime(e, n, a.segmentIndex, a.time); i = h.mediaIndex, o = h.startTime } return this.generateSegmentInfo_(e, i, o, !1) } }, { key: "getSyncSegmentCandidate_", value: function (t) { var e = this; if (-1 === this.currentTimeline_) return 0; var i = t.segments.map(function (t, e) { return { timeline: t.timeline, segmentIndex: e } }).filter(function (t) { return t.timeline === e.currentTimeline_ }); return i.length ? i[Math.min(i.length - 1, 1)].segmentIndex : Math.max(t.segments.length - 1, 0) } }, { key: "generateSegmentInfo_", value: function (t, e, i, r) { if (0 > e || e >= t.segments.length) return null; var n = t.segments[e]; return { requestId: "segment-loader-" + Math.random(), uri: n.resolvedUri, mediaIndex: e, isSyncRequest: r, startOfSegment: i, playlist: t, bytes: null, encryptedBytes: null, timestampOffset: null, timeline: n.timeline, duration: n.duration, segment: n } } }, { key: "abortRequestEarly_", value: function (t) { if (this.hls_.tech_.paused() || !this.xhrOptions_.timeout || !this.playlist_.attributes.BANDWIDTH) return !1; if (Date.now() - (t.firstBytesReceivedAt || Date.now()) < 1e3) return !1; var e = this.currentTime_(), i = t.bandwidth, r = this.pendingSegment_.duration, n = cc.estimateSegmentRequestTime(r, i, this.playlist_, t.bytesReceived), a = Oc(this.buffered_(), e, this.hls_.tech_.playbackRate()) - 1; if (a >= n) return !1; var s = zh({ master: this.hls_.playlists.master, currentTime: e, bandwidth: i, duration: this.duration_(), segmentDuration: r, timeUntilRebuffer: a, currentTimeline: this.currentTimeline_, syncController: this.syncController_ }); if (s) { var o = n - a, u = o - s.rebufferingImpact, l = .5; return kc >= a && (l = 1), !s.playlist || s.playlist.uri === this.playlist_.uri || l > u ? !1 : (this.bandwidth = s.playlist.attributes.BANDWIDTH * mh.BANDWIDTH_VARIANCE + 1, this.abort(), this.trigger("earlyabort"), !0) } } }, { key: "handleProgress_", value: function (t, e) { this.pendingSegment_ && e.requestId === this.pendingSegment_.requestId && !this.abortRequestEarly_(e.stats) && this.trigger("progress") } }, { key: "loadSegment_", value: function (t) { this.state = "WAITING", this.pendingSegment_ = t, this.trimBackBuffer_(t), t.abortRequests = Oh(this.hls_.xhr, this.xhrOptions_, this.decrypter_, this.createSimplifiedSegmentObj_(t), this.handleProgress_.bind(this), this.segmentRequestFinished_.bind(this)) } }, { key: "trimBackBuffer_", value: function (t) { var e = Jh(this.seekable_(), this.currentTime_(), this.playlist_.targetDuration || 10); e > 0 && this.remove(0, e) } }, { key: "createSimplifiedSegmentObj_", value: function (t) { var e = t.segment, i = { resolvedUri: e.resolvedUri, byterange: e.byterange, requestId: t.requestId }; if (e.key) { var r = e.key.iv || new Uint32Array([0, 0, 0, t.mediaIndex + t.playlist.mediaSequence]); i.key = { resolvedUri: e.key.resolvedUri, iv: r } } return e.map && (i.map = this.initSegment(e.map)), i } }, { key: "segmentRequestFinished_", value: function (t, e) { if (this.mediaRequests += 1, e.stats && (this.mediaBytesTransferred += e.stats.bytesReceived, this.mediaTransferDuration += e.stats.roundTripTime), !this.pendingSegment_) return void (this.mediaRequestsAborted += 1); if (e.requestId === this.pendingSegment_.requestId) { if (t) return this.pendingSegment_ = null, this.state = "READY", t.code === gh.ABORTED ? void (this.mediaRequestsAborted += 1) : (this.pause(), t.code === gh.TIMEOUT ? (this.mediaRequestsTimedout += 1, this.bandwidth = 1, this.roundTrip = NaN, void this.trigger("bandwidthupdate")) : (this.mediaRequestsErrored += 1, this.error(t), void this.trigger("error"))); this.bandwidth = e.stats.bandwidth, this.roundTrip = e.stats.roundTripTime, e.map && (e.map = this.initSegment(e.map, !0)), this.processSegmentResponse_(e) } } }, { key: "processSegmentResponse_", value: function (t) { var e = this.pendingSegment_; e.bytes = t.bytes, t.map && (e.segment.map.bytes = t.map.bytes), e.endOfAllRequests = t.endOfAllRequests, this.handleSegment_() } }, { key: "handleSegment_", value: function () { var t = this; if (!this.pendingSegment_) return void (this.state = "READY"); var e = this.pendingSegment_, i = e.segment, r = this.syncController_.probeSegmentInfo(e); "undefined" == typeof this.startingMedia_ && r && (r.containsAudio || r.containsVideo) && (this.startingMedia_ = { containsAudio: r.containsAudio, containsVideo: r.containsVideo }); var n = Kh(this.loaderType_, this.startingMedia_, r); if (n) return this.error({ message: n, blacklistDuration: 1 / 0 }), void this.trigger("error"); if (e.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); null !== e.timestampOffset && e.timestampOffset !== this.sourceUpdater_.timestampOffset() && (this.sourceUpdater_.timestampOffset(e.timestampOffset), this.trigger("timestampoffset")); var a = this.syncController_.mappingForTimeline(e.timeline); if (null !== a && this.trigger({ type: "segmenttimemapping", mapping: a }), this.state = "APPENDING", i.map) { var s = vc(i.map); if (!this.activeInitSegmentId_ || this.activeInitSegmentId_ !== s) { var o = this.initSegment(i.map); this.sourceUpdater_.appendBuffer(o.bytes, function () { t.activeInitSegmentId_ = s }) } } e.byteLength = e.bytes.byteLength, "number" == typeof i.start && "number" == typeof i.end ? this.mediaSecondsLoaded += i.end - i.start : this.mediaSecondsLoaded += i.duration, this.logger_(Qh(e)), this.sourceUpdater_.appendBuffer(e.bytes, this.handleUpdateEnd_.bind(this)) } }, { key: "handleUpdateEnd_", value: function () { if (!this.pendingSegment_) return this.state = "READY", void (this.paused() || this.monitorBuffer_()); var t = this.pendingSegment_, e = t.segment, i = null !== this.mediaIndex; if (this.pendingSegment_ = null, this.recordThroughput_(t), this.addSegmentMetadataCue_(t), this.state = "READY", this.mediaIndex = t.mediaIndex, this.fetchAtBuffer_ = !0, this.currentTimeline_ = t.timeline, this.trigger("syncinfoupdate"), e.end && this.currentTime_() - e.end > 3 * t.playlist.targetDuration) return void this.resetEverything(); i && this.trigger("bandwidthupdate"), this.trigger("progress"); var r = Yh(t.playlist, this.mediaSource_, t.mediaIndex + 1); r && this.endOfStream(), this.paused() || this.monitorBuffer_() } }, {
      key: "recordThroughput_", value: function (t) {
        var e = this.throughput.rate, i = Date.now() - t.endOfAllRequests + 1, r = Math.floor(t.byteLength / i * 8 * 1e3);
        this.throughput.rate += (r - e) / ++this.throughput.count
      }
    }, { key: "addSegmentMetadataCue_", value: function (t) { if (this.segmentMetadataTrack_) { var e = t.segment, i = e.start, r = e.end; if ($h(i) && $h(r)) { Dc(i, r, this.segmentMetadataTrack_); var n = Te.WebKitDataCue || Te.VTTCue, a = { bandwidth: t.playlist.attributes.BANDWIDTH, resolution: t.playlist.attributes.RESOLUTION, codecs: t.playlist.attributes.CODECS, byteLength: t.byteLength, uri: t.uri, timeline: t.timeline, playlist: t.playlist.uri, start: i, end: r }, s = JSON.stringify(a), o = new n(i, r, s); o.value = a, this.segmentMetadataTrack_.addCue(o) } } } }]), e
  }(ce.EventTarget), td = new Uint8Array("\n\n".split("").map(function (t) { return t.charCodeAt(0) })), ed = function (t) { return String.fromCharCode.apply(null, t) }, id = function (t) { function e(t) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; El(this, e); var r = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, t, i)); return r.mediaSource_ = null, r.subtitlesTrack_ = null, r } return Al(e, t), Cl(e, [{ key: "buffered_", value: function () { if (!this.subtitlesTrack_ || !this.subtitlesTrack_.cues.length) return ce.createTimeRanges(); var t = this.subtitlesTrack_.cues, e = t[0].startTime, i = t[t.length - 1].startTime; return ce.createTimeRanges([[e, i]]) } }, { key: "initSegment", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : !1; if (!t) return null; var i = vc(t), r = this.initSegments_[i]; if (e && !r && t.bytes) { var n = td.byteLength + t.bytes.byteLength, a = new Uint8Array(n); a.set(t.bytes), a.set(td, t.bytes.byteLength), this.initSegments_[i] = r = { resolvedUri: t.resolvedUri, byterange: t.byterange, bytes: a } } return r || t } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && this.subtitlesTrack_ && !this.paused() } }, { key: "init_", value: function () { return this.state = "READY", this.resetEverything(), this.monitorBuffer_() } }, { key: "track", value: function (t) { return "undefined" == typeof t ? this.subtitlesTrack_ : (this.subtitlesTrack_ = t, "INIT" === this.state && this.couldBeginLoading_() && this.init_(), this.subtitlesTrack_) } }, { key: "remove", value: function (t, e) { Dc(t, e, this.subtitlesTrack_) } }, { key: "fillBuffer_", value: function () { var t = this; this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())); var e = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_); if (e = this.skipEmptySegments_(e)) { if (null === this.syncController_.timestampOffsetForTimeline(e.timeline)) { var i = function () { t.state = "READY", t.paused() || t.monitorBuffer_() }; return this.syncController_.one("timestampoffset", i), void (this.state = "WAITING_ON_TIMELINE") } this.loadSegment_(e) } } }, { key: "skipEmptySegments_", value: function (t) { for (; t && t.segment.empty;)t = this.generateSegmentInfo_(t.playlist, t.mediaIndex + 1, t.startOfSegment + t.duration, t.isSyncRequest); return t } }, { key: "handleSegment_", value: function () { var t = this; if (!this.pendingSegment_ || !this.subtitlesTrack_) return void (this.state = "READY"); this.state = "APPENDING"; var e = this.pendingSegment_, i = e.segment; if ("function" != typeof Te.WebVTT && this.subtitlesTrack_ && this.subtitlesTrack_.tech_) { var r = function () { t.handleSegment_() }; return this.state = "WAITING_ON_VTTJS", this.subtitlesTrack_.tech_.one("vttjsloaded", r), void this.subtitlesTrack_.tech_.one("vttjserror", function () { t.subtitlesTrack_.tech_.off("vttjsloaded", r), t.error({ message: "Error loading vtt.js" }), t.state = "READY", t.pause(), t.trigger("error") }) } i.requested = !0; try { this.parseVTTCues_(e) } catch (n) { return this.error({ message: n.message }), this.state = "READY", this.pause(), this.trigger("error") } return this.updateTimeMapping_(e, this.syncController_.timelines[e.timeline], this.playlist_), e.isSyncRequest ? (this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY")) : (e.byteLength = e.bytes.byteLength, this.mediaSecondsLoaded += i.duration, e.cues.length && this.remove(e.cues[0].endTime, e.cues[e.cues.length - 1].endTime), e.cues.forEach(function (e) { t.subtitlesTrack_.addCue(e) }), void this.handleUpdateEnd_()) } }, { key: "parseVTTCues_", value: function (t) { var e = void 0, i = !1; "function" == typeof Te.TextDecoder ? e = new Te.TextDecoder("utf8") : (e = Te.WebVTT.StringDecoder(), i = !0); var r = new Te.WebVTT.Parser(Te, Te.vttjs, e); if (t.cues = [], t.timestampmap = { MPEGTS: 0, LOCAL: 0 }, r.oncue = t.cues.push.bind(t.cues), r.ontimestampmap = function (e) { return t.timestampmap = e }, r.onparsingerror = function (t) { ce.log.warn("Error encountered when parsing cues: " + t.message) }, t.segment.map) { var n = t.segment.map.bytes; i && (n = ed(n)), r.parse(n) } var a = t.bytes; i && (a = ed(a)), r.parse(a), r.flush() } }, { key: "updateTimeMapping_", value: function (t, e, i) { var r = t.segment; if (e) { if (!t.cues.length) return void (r.empty = !0); var n = t.timestampmap, a = n.MPEGTS / 9e4 - n.LOCAL + e.mapping; if (t.cues.forEach(function (t) { t.startTime += a, t.endTime += a }), !i.syncInfo) { var s = t.cues[0].startTime, o = t.cues[t.cues.length - 1].startTime; i.syncInfo = { mediaSequence: i.mediaSequence + t.mediaIndex, time: Math.min(s, o - r.duration) } } } } }]), e }(Zh), rd = function (t, e) { for (var i = t.cues, r = 0; r < i.length; r++) { var n = i[r]; if (e >= n.adStartTime && e <= n.adEndTime) return n } return null }, nd = function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0; if (t.segments) for (var r = i, n = void 0, a = 0; a < t.segments.length; a++) { var s = t.segments[a]; if (n || (n = rd(e, r + s.duration / 2)), n) { if ("cueIn" in s) { n.endTime = r, n.adEndTime = r, r += s.duration, n = null; continue } if (r < n.endTime) { r += s.duration; continue } n.endTime += s.duration } else if ("cueOut" in s && (n = new Te.VTTCue(r, r + s.duration, s.cueOut), n.adStartTime = r, n.adEndTime = r + parseFloat(s.cueOut), e.addCue(n)), "cueOutCont" in s) { var o = void 0, u = void 0, l = s.cueOutCont.split("/").map(parseFloat), c = Pl(l, 2); o = c[0], u = c[1], n = new Te.VTTCue(r, r + s.duration, ""), n.adStartTime = r - o, n.adEndTime = n.adStartTime + u, e.addCue(n) } r += s.duration } }, ad = cl.inspect, sd = [{ name: "VOD", run: function (t, e, i, r, n) { if (i !== 1 / 0) { var a = { time: 0, segmentIndex: 0 }; return a } return null } }, { name: "ProgramDateTime", run: function (t, e, i, r, n) { if (!t.datetimeToDisplayTime) return null; var a = e.segments || [], s = null, o = null; n = n || 0; for (var u = 0; u < a.length; u++) { var l = a[u]; if (l.dateTimeObject) { var c = l.dateTimeObject.getTime() / 1e3, h = c + t.datetimeToDisplayTime, d = Math.abs(n - h); if (null !== o && d > o) break; o = d, s = { time: h, segmentIndex: u } } } return s } }, { name: "Segment", run: function (t, e, i, r, n) { var a = e.segments || [], s = null, o = null; n = n || 0; for (var u = 0; u < a.length; u++) { var l = a[u]; if (l.timeline === r && "undefined" != typeof l.start) { var c = Math.abs(n - l.start); if (null !== o && c > o) break; (!s || null === o || o >= c) && (o = c, s = { time: l.start, segmentIndex: u }) } } return s } }, { name: "Discontinuity", run: function (t, e, i, r, n) { var a = null; if (n = n || 0, e.discontinuityStarts && e.discontinuityStarts.length) for (var s = null, o = 0; o < e.discontinuityStarts.length; o++) { var u = e.discontinuityStarts[o], l = e.discontinuitySequence + o + 1, c = t.discontinuities[l]; if (c) { var h = Math.abs(n - c.time); if (null !== s && h > s) break; (!a || null === s || s >= h) && (s = h, a = { time: c.time, segmentIndex: u }) } } return a } }, { name: "Playlist", run: function (t, e, i, r, n) { if (e.syncInfo) { var a = { time: e.syncInfo.time, segmentIndex: e.syncInfo.mediaSequence - e.mediaSequence }; return a } return null } }], od = function (t) { function e() { El(this, e); var t = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)); return t.inspectCache_ = void 0, t.timelines = [], t.discontinuities = [], t.datetimeToDisplayTime = null, t.logger_ = ph("SyncController"), t } return Al(e, t), Cl(e, [{ key: "getSyncPoint", value: function (t, e, i, r) { var n = this.runStrategies_(t, e, i, r); return n.length ? this.selectSyncPoint_(n, { key: "time", value: r }) : null } }, { key: "getExpiredTime", value: function (t, e) { if (!t || !t.segments) return null; var i = this.runStrategies_(t, e, t.discontinuitySequence, 0); if (!i.length) return null; var r = this.selectSyncPoint_(i, { key: "segmentIndex", value: 0 }); return r.segmentIndex > 0 && (r.time *= -1), Math.abs(r.time + Gl(t, r.segmentIndex, 0)) } }, { key: "runStrategies_", value: function (t, e, i, r) { for (var n = [], a = 0; a < sd.length; a++) { var s = sd[a], o = s.run(this, t, e, i, r); o && (o.strategy = s.name, n.push({ strategy: s.name, syncPoint: o })) } return n } }, { key: "selectSyncPoint_", value: function (t, e) { for (var i = t[0].syncPoint, r = Math.abs(t[0].syncPoint[e.key] - e.value), n = t[0].strategy, a = 1; a < t.length; a++) { var s = Math.abs(t[a].syncPoint[e.key] - e.value); r > s && (r = s, i = t[a].syncPoint, n = t[a].strategy) } return this.logger_("syncPoint for [" + e.key + ": " + e.value + "] chosen with strategy" + (" [" + n + "]: [time:" + i.time + ",") + (" segmentIndex:" + i.segmentIndex + "]")), i } }, { key: "saveExpiredSegmentInfo", value: function (t, e) { for (var i = e.mediaSequence - t.mediaSequence, r = i - 1; r >= 0; r--) { var n = t.segments[r]; if (n && "undefined" != typeof n.start) { e.syncInfo = { mediaSequence: t.mediaSequence + r, time: n.start }, this.logger_("playlist refresh sync: [time:" + e.syncInfo.time + "," + (" mediaSequence: " + e.syncInfo.mediaSequence + "]")), this.trigger("syncinfoupdate"); break } } } }, { key: "setDateTimeMapping", value: function (t) { if (!this.datetimeToDisplayTime && t.segments && t.segments.length && t.segments[0].dateTimeObject) { var e = t.segments[0].dateTimeObject.getTime() / 1e3; this.datetimeToDisplayTime = -e } } }, { key: "reset", value: function () { this.inspectCache_ = void 0 } }, { key: "probeSegmentInfo", value: function (t) { var e = t.segment, i = t.playlist, r = void 0; return r = e.map ? this.probeMp4Segment_(t) : this.probeTsSegment_(t), r && this.calculateSegmentTimeMapping_(t, r) && (this.saveDiscontinuitySyncInfo_(t), i.syncInfo || (i.syncInfo = { mediaSequence: i.mediaSequence + t.mediaIndex, time: e.start })), r } }, { key: "probeMp4Segment_", value: function (t) { var e = t.segment, i = Yo.timescale(e.map.bytes), r = Yo.startTime(i, t.bytes); return null !== t.timestampOffset && (t.timestampOffset -= r), { start: r, end: r + e.duration } } }, { key: "probeTsSegment_", value: function (t) { var e = ad(t.bytes, this.inspectCache_), i = void 0, r = void 0; return e ? (e.video && 2 === e.video.length ? (this.inspectCache_ = e.video[1].dts, i = e.video[0].dtsTime, r = e.video[1].dtsTime) : e.audio && 2 === e.audio.length && (this.inspectCache_ = e.audio[1].dts, i = e.audio[0].dtsTime, r = e.audio[1].dtsTime), { start: i, end: r, containsVideo: e.video && 2 === e.video.length, containsAudio: e.audio && 2 === e.audio.length }) : null } }, { key: "timestampOffsetForTimeline", value: function (t) { return "undefined" == typeof this.timelines[t] ? null : this.timelines[t].time } }, { key: "mappingForTimeline", value: function (t) { return "undefined" == typeof this.timelines[t] ? null : this.timelines[t].mapping } }, { key: "calculateSegmentTimeMapping_", value: function (t, e) { var i = t.segment, r = this.timelines[t.timeline]; if (null !== t.timestampOffset) r = { time: t.startOfSegment, mapping: t.startOfSegment - e.start }, this.timelines[t.timeline] = r, this.trigger("timestampoffset"), this.logger_("time mapping for timeline " + t.timeline + ": " + ("[time: " + r.time + "] [mapping: " + r.mapping + "]")), i.start = t.startOfSegment, i.end = e.end + r.mapping; else { if (!r) return !1; i.start = e.start + r.mapping, i.end = e.end + r.mapping } return !0 } }, { key: "saveDiscontinuitySyncInfo_", value: function (t) { var e = t.playlist, i = t.segment; if (i.discontinuity) this.discontinuities[i.timeline] = { time: i.start, accuracy: 0 }; else if (e.discontinuityStarts && e.discontinuityStarts.length) for (var r = 0; r < e.discontinuityStarts.length; r++) { var n = e.discontinuityStarts[r], a = e.discontinuitySequence + r + 1, s = n - t.mediaIndex, o = Math.abs(s); if (!this.discontinuities[a] || this.discontinuities[a].accuracy > o) { var u = void 0; u = 0 > s ? i.start - Gl(e, t.mediaIndex, n) : i.end + Gl(e, t.mediaIndex + 1, n), this.discontinuities[a] = { time: u, accuracy: o } } } } }]), e }(ce.EventTarget), ud = new pe("./decrypter-worker.worker.js", function (t, e) { var i = this; (function () { function e(t) { return t.subarray(0, t.byteLength - t[t.byteLength - 1]) } var r, n = "undefined" != typeof t ? t : "undefined" != typeof global ? global : "undefined" != typeof i ? i : {}; r = "undefined" != typeof t ? t : "undefined" != typeof n ? n : "undefined" != typeof i ? i : {}; var a = r, s = function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }, o = function () { function t(t, e) { for (var i = 0; i < e.length; i++) { var r = e[i]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } return function (e, i, r) { return i && t(e.prototype, i), r && t(e, r), e } }(), u = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + ("undefined" == typeof e ? "undefined" : De(e))); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 } }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e) }, l = function (t, e) { if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !e || "object" !== ("undefined" == typeof e ? "undefined" : De(e)) && "function" != typeof e ? t : e }, c = function () { var t = [[[], [], [], [], []], [[], [], [], [], []]], e = t[0], i = t[1], r = e[4], n = i[4], a = void 0, s = void 0, o = void 0, u = [], l = [], c = void 0, h = void 0, d = void 0, p = void 0, f = void 0, m = void 0; for (a = 0; 256 > a; a++)l[(u[a] = a << 1 ^ 283 * (a >> 7)) ^ a] = a; for (s = o = 0; !r[s]; s ^= c || 1, o = l[o] || 1)for (p = o ^ o << 1 ^ o << 2 ^ o << 3 ^ o << 4, p = p >> 8 ^ 255 & p ^ 99, r[s] = p, n[p] = s, d = u[h = u[c = u[s]]], m = 16843009 * d ^ 65537 * h ^ 257 * c ^ 16843008 * s, f = 257 * u[p] ^ 16843008 * p, a = 0; 4 > a; a++)e[a][s] = f = f << 24 ^ f >>> 8, i[a][p] = m = m << 24 ^ m >>> 8; for (a = 0; 5 > a; a++)e[a] = e[a].slice(0), i[a] = i[a].slice(0); return t }, h = null, d = function () { function t(e) { s(this, t), h || (h = c()), this._tables = [[h[0][0].slice(), h[0][1].slice(), h[0][2].slice(), h[0][3].slice(), h[0][4].slice()], [h[1][0].slice(), h[1][1].slice(), h[1][2].slice(), h[1][3].slice(), h[1][4].slice()]]; var i = void 0, r = void 0, n = void 0, a = void 0, o = void 0, u = this._tables[0][4], l = this._tables[1], d = e.length, p = 1; if (4 !== d && 6 !== d && 8 !== d) throw new Error("Invalid aes key size"); for (a = e.slice(0), o = [], this._key = [a, o], i = d; 4 * d + 28 > i; i++)n = a[i - 1], (i % d === 0 || 8 === d && i % d === 4) && (n = u[n >>> 24] << 24 ^ u[n >> 16 & 255] << 16 ^ u[n >> 8 & 255] << 8 ^ u[255 & n], i % d === 0 && (n = n << 8 ^ n >>> 24 ^ p << 24, p = p << 1 ^ 283 * (p >> 7))), a[i] = a[i - d] ^ n; for (r = 0; i; r++ , i--)n = a[3 & r ? i : i - 4], 4 >= i || 4 > r ? o[r] = n : o[r] = l[0][u[n >>> 24]] ^ l[1][u[n >> 16 & 255]] ^ l[2][u[n >> 8 & 255]] ^ l[3][u[255 & n]] } return t.prototype.decrypt = function (t, e, i, r, n, a) { var s = this._key[1], o = t ^ s[0], u = r ^ s[1], l = i ^ s[2], c = e ^ s[3], h = void 0, d = void 0, p = void 0, f = s.length / 4 - 2, m = void 0, g = 4, y = this._tables[1], v = y[0], _ = y[1], b = y[2], T = y[3], S = y[4]; for (m = 0; f > m; m++)h = v[o >>> 24] ^ _[u >> 16 & 255] ^ b[l >> 8 & 255] ^ T[255 & c] ^ s[g], d = v[u >>> 24] ^ _[l >> 16 & 255] ^ b[c >> 8 & 255] ^ T[255 & o] ^ s[g + 1], p = v[l >>> 24] ^ _[c >> 16 & 255] ^ b[o >> 8 & 255] ^ T[255 & u] ^ s[g + 2], c = v[c >>> 24] ^ _[o >> 16 & 255] ^ b[u >> 8 & 255] ^ T[255 & l] ^ s[g + 3], g += 4, o = h, u = d, l = p; for (m = 0; 4 > m; m++)n[(3 & -m) + a] = S[o >>> 24] << 24 ^ S[u >> 16 & 255] << 16 ^ S[l >> 8 & 255] << 8 ^ S[255 & c] ^ s[g++], h = o, o = u, u = l, l = c, c = h }, t }(), p = function () { function t() { s(this, t), this.listeners = {} } return t.prototype.on = function (t, e) { this.listeners[t] || (this.listeners[t] = []), this.listeners[t].push(e) }, t.prototype.off = function (t, e) { if (!this.listeners[t]) return !1; var i = this.listeners[t].indexOf(e); return this.listeners[t].splice(i, 1), i > -1 }, t.prototype.trigger = function (t) { var e = this.listeners[t]; if (e) if (2 === arguments.length) for (var i = e.length, r = 0; i > r; ++r)e[r].call(this, arguments[1]); else for (var n = Array.prototype.slice.call(arguments, 1), a = e.length, s = 0; a > s; ++s)e[s].apply(this, n) }, t.prototype.dispose = function () { this.listeners = {} }, t.prototype.pipe = function (t) { this.on("data", function (e) { t.push(e) }) }, t }(), f = function (t) { function e() { s(this, e); var i = l(this, t.call(this, p)); return i.jobs = [], i.delay = 1, i.timeout_ = null, i } return u(e, t), e.prototype.processJob_ = function () { this.jobs.shift()(), this.jobs.length ? this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay) : this.timeout_ = null }, e.prototype.push = function (t) { this.jobs.push(t), this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }, e }(p), m = function (t) { return t << 24 | (65280 & t) << 8 | (16711680 & t) >> 8 | t >>> 24 }, g = function (t, e, i) { var r = new Int32Array(t.buffer, t.byteOffset, t.byteLength >> 2), n = new d(Array.prototype.slice.call(e)), a = new Uint8Array(t.byteLength), s = new Int32Array(a.buffer), o = void 0, u = void 0, l = void 0, c = void 0, h = void 0, p = void 0, f = void 0, g = void 0, y = void 0; for (o = i[0], u = i[1], l = i[2], c = i[3], y = 0; y < r.length; y += 4)h = m(r[y]), p = m(r[y + 1]), f = m(r[y + 2]), g = m(r[y + 3]), n.decrypt(h, p, f, g, s, y), s[y] = m(s[y] ^ o), s[y + 1] = m(s[y + 1] ^ u), s[y + 2] = m(s[y + 2] ^ l), s[y + 3] = m(s[y + 3] ^ c), o = h, u = p, l = f, c = g; return a }, y = function () { function t(i, r, n, a) { s(this, t); var o = t.STEP, u = new Int32Array(i.buffer), l = new Uint8Array(i.byteLength), c = 0; for (this.asyncStream_ = new f, this.asyncStream_.push(this.decryptChunk_(u.subarray(c, c + o), r, n, l)), c = o; c < u.length; c += o)n = new Uint32Array([m(u[c - 4]), m(u[c - 3]), m(u[c - 2]), m(u[c - 1])]), this.asyncStream_.push(this.decryptChunk_(u.subarray(c, c + o), r, n, l)); this.asyncStream_.push(function () { a(null, e(l)) }) } return t.prototype.decryptChunk_ = function (t, e, i, r) { return function () { var n = g(t, e, i); r.set(n, t.byteOffset) } }, o(t, null, [{ key: "STEP", get: function () { return 32e3 } }]), t }(), v = function (t) { var e = {}; return Object.keys(t).forEach(function (i) { var r = t[i]; ArrayBuffer.isView(r) ? e[i] = { bytes: r.buffer, byteOffset: r.byteOffset, byteLength: r.byteLength } : e[i] = r }), e }, _ = function (t) { t.onmessage = function (t) { var e = t.data, i = new Uint8Array(e.encrypted.bytes, e.encrypted.byteOffset, e.encrypted.byteLength), r = new Uint32Array(e.key.bytes, e.key.byteOffset, e.key.byteLength / 4), n = new Uint32Array(e.iv.bytes, e.iv.byteOffset, e.iv.byteLength / 4); new y(i, r, n, function (t, i) { a.postMessage(v({ source: e.source, decrypted: i }), [i.buffer]) }) } }, b = new _(i); return b })() }), ld = function (t) { var e = t["default"] ? "main" : "alternative"; return t.characteristics && t.characteristics.indexOf("public.accessibility.describes-video") >= 0 && (e = "main-desc"), e }, cd = function (t, e) { t.abort(), t.pause(), e && e.activePlaylistLoader && (e.activePlaylistLoader.pause(), e.activePlaylistLoader = null) }, hd = function (t, e) { e.activePlaylistLoader = t, t.load() }, dd = function (t, e) { return function () { var i = e.segmentLoaders, r = i[t], n = i.main, a = e.mediaTypes[t], s = a.activeTrack(), o = a.activeGroup(s), u = a.activePlaylistLoader; if (cd(r, a), o) { if (!o.playlistLoader) return void (u && n.resetEverything()); r.resyncLoader(), hd(o.playlistLoader, a) } } }, pd = function (t, e) { return function () { var i = e.segmentLoaders, r = i[t], n = i.main, a = e.mediaTypes[t], s = a.activeTrack(), o = a.activeGroup(s), u = a.activePlaylistLoader; if (cd(r, a), o) { if (!o.playlistLoader) return void n.resetEverything(); if (u === o.playlistLoader) return void hd(o.playlistLoader, a); r.track && r.track(s), r.resetEverything(), hd(o.playlistLoader, a) } } }, fd = { AUDIO: function (t, e) { return function () { var i = e.segmentLoaders[t], r = e.mediaTypes[t], n = e.blacklistCurrentPlaylist; cd(i, r); var a = r.activeTrack(), s = r.activeGroup(), o = (s.filter(function (t) { return t["default"] })[0] || s[0]).id, u = r.tracks[o]; if (a === u) return void n({ message: "Problem encountered loading the default audio track." }); ce.log.warn("Problem encountered loading the alternate audio track.Switching back to default."); for (var l in r.tracks) r.tracks[l].enabled = r.tracks[l] === u; r.onTrackChanged() } }, SUBTITLES: function (t, e) { return function () { var i = e.segmentLoaders[t], r = e.mediaTypes[t]; ce.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."), cd(i, r); var n = r.activeTrack(); n && (n.mode = "disabled"), r.onTrackChanged() } } }, md = { AUDIO: function (t, e, i) { if (e) { var r = i.tech, n = i.requestOptions, a = i.segmentLoaders[t]; e.on("loadedmetadata", function () { var t = e.media(); a.playlist(t, n), (!r.paused() || t.endList && "none" !== r.preload()) && a.load() }), e.on("loadedplaylist", function () { a.playlist(e.media(), n), r.paused() || a.load() }), e.on("error", fd[t](t, i)) } }, SUBTITLES: function (t, e, i) { var r = i.tech, n = i.requestOptions, a = i.segmentLoaders[t], s = i.mediaTypes[t]; e.on("loadedmetadata", function () { var t = e.media(); a.playlist(t, n), a.track(s.activeTrack()), (!r.paused() || t.endList && "none" !== r.preload()) && a.load() }), e.on("loadedplaylist", function () { a.playlist(e.media(), n), r.paused() || a.load() }), e.on("error", fd[t](t, i)) } }, gd = function (t, e) { return function (i) { return i.attributes[t] === e } }, yd = function (t) { return function (e) { return e.resolvedUri === t } }, vd = { AUDIO: function (t, e) { var i = e.hls, r = e.sourceType, n = e.segmentLoaders[t], a = e.requestOptions.withCredentials, s = e.master, o = s.mediaGroups, u = s.playlists, l = e.mediaTypes[t], c = l.groups, h = l.tracks, d = e.masterPlaylistLoader; o[t] && 0 !== Object.keys(o[t]).length || (o[t] = { main: { "default": { "default": !0 } } }); for (var p in o[t]) { c[p] || (c[p] = []); var f = u.filter(gd(t, p)); for (var m in o[t][p]) { var g = o[t][p][m], y = f.filter(yd(g.resolvedUri)); y.length && delete g.resolvedUri; var v = void 0; if (v = g.resolvedUri ? new Fl(g.resolvedUri, i, a) : g.playlists && "dash" === r ? new dh(g.playlists[0], i, a, d) : null, g = ce.mergeOptions({ id: m, playlistLoader: v }, g), md[t](t, g.playlistLoader, e), c[p].push(g), "undefined" == typeof h[m]) { var _ = new ce.AudioTrack({ id: m, kind: ld(g), enabled: !1, language: g.language, "default": g["default"], label: m }); h[m] = _ } } } n.on("error", fd[t](t, e)) }, SUBTITLES: function (t, e) { var i = e.tech, r = e.hls, n = e.sourceType, a = e.segmentLoaders[t], s = e.requestOptions.withCredentials, o = e.master.mediaGroups, u = e.mediaTypes[t], l = u.groups, c = u.tracks, h = e.masterPlaylistLoader; for (var d in o[t]) { l[d] || (l[d] = []); for (var p in o[t][d]) if (!o[t][d][p].forced) { var f = o[t][d][p], m = void 0; if ("hls" === n ? m = new Fl(f.resolvedUri, r, s) : "dash" === n && (m = new dh(f.playlists[0], r, s, h)), f = ce.mergeOptions({ id: p, playlistLoader: m }, f), md[t](t, f.playlistLoader, e), l[d].push(f), "undefined" == typeof c[p]) { var g = i.addRemoteTextTrack({ id: p, kind: "subtitles", enabled: !1, language: f.language, label: p }, !1).track; c[p] = g } } } a.on("error", fd[t](t, e)) }, "CLOSED-CAPTIONS": function (t, e) { var i = e.tech, r = e.master.mediaGroups, n = e.mediaTypes[t], a = n.groups, s = n.tracks; for (var o in r[t]) { a[o] || (a[o] = []); for (var u in r[t][o]) { var l = r[t][o][u]; if (l.instreamId.match(/CC\d/) && (a[o].push(ce.mergeOptions({ id: u }, l)), "undefined" == typeof s[u])) { var c = i.addRemoteTextTrack({ id: l.instreamId, kind: "captions", enabled: !1, language: l.language, label: u }, !1).track; s[u] = c } } } } }, _d = function (t, e) { return function (i) { var r = e.masterPlaylistLoader, n = e.mediaTypes[t].groups, a = r.media(); if (!a) return null; var s = null; return a.attributes[t] && (s = n[a.attributes[t]]), s = s || n.main, "undefined" == typeof i ? s : null === i ? null : s.filter(function (t) { return t.id === i.id })[0] || null } }, bd = { AUDIO: function (t, e) { return function () { var i = e.mediaTypes[t].tracks; for (var r in i) if (i[r].enabled) return i[r]; return null } }, SUBTITLES: function (t, e) { return function () { var i = e.mediaTypes[t].tracks; for (var r in i) if ("showing" === i[r].mode) return i[r]; return null } } }, Td = function (t) { ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach(function (e) { vd[e](e, t) }); var e = t.mediaTypes, i = t.masterPlaylistLoader, r = t.tech, n = t.hls;["AUDIO", "SUBTITLES"].forEach(function (i) { e[i].activeGroup = _d(i, t), e[i].activeTrack = bd[i](i, t), e[i].onGroupChanged = dd(i, t), e[i].onTrackChanged = pd(i, t) }); var a = e.AUDIO.activeGroup(), s = (a.filter(function (t) { return t["default"] })[0] || a[0]).id; e.AUDIO.tracks[s].enabled = !0, e.AUDIO.onTrackChanged(), i.on("mediachange", function () { ["AUDIO", "SUBTITLES"].forEach(function (t) { return e[t].onGroupChanged() }) }); var o = function () { e.AUDIO.onTrackChanged(), r.trigger({ type: "usage", name: "hls-audio-change" }) }; r.audioTracks().addEventListener("change", o), r.remoteTextTracks().addEventListener("change", e.SUBTITLES.onTrackChanged), n.on("dispose", function () { r.audioTracks().removeEventListener("change", o), r.remoteTextTracks().removeEventListener("change", e.SUBTITLES.onTrackChanged) }), r.clearTracks("audio"); for (var u in e.AUDIO.tracks) r.audioTracks().addTrack(e.AUDIO.tracks[u]) }, Sd = function () { var t = {}; return ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach(function (e) { t[e] = { groups: {}, tracks: {}, activePlaylistLoader: null, activeGroup: ge, activeTrack: ge, onGroupChanged: ge, onTrackChanged: ge } }), t }, kd = 120, Ed = void 0, Cd = ["mediaRequests", "mediaRequestsAborted", "mediaRequestsTimedout", "mediaRequestsErrored", "mediaTransferDuration", "mediaBytesTransferred"], wd = function (t) { return this.audioSegmentLoader_[t] + this.mainSegmentLoader_[t] }, Ad = function (t) {
    function e(t) { El(this, e); var i = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this)), r = t.url, n = t.withCredentials, a = t.tech, s = t.bandwidth, o = t.externHls, u = t.useCueTags, l = t.blacklistDuration, c = t.enableLowInitialPlaylist, h = t.sourceType; if (!r) throw new Error("A non-empty playlist URL is required"); Ed = o, i.withCredentials = n, i.tech_ = a, i.hls_ = a.hls, i.sourceType_ = h, i.useCueTags_ = u, i.blacklistDuration = l, i.enableLowInitialPlaylist = c, i.useCueTags_ && (i.cueTagsTrack_ = i.tech_.addTextTrack("metadata", "ad-cues"), i.cueTagsTrack_.inBandMetadataTrackDispatchType = ""), i.requestOptions_ = { withCredentials: i.withCredentials, timeout: null }, i.mediaTypes_ = Sd(), i.mediaSource = new ce.MediaSource, i.mediaSource.addEventListener("sourceopen", i.handleSourceOpen_.bind(i)), i.seekable_ = ce.createTimeRanges(), i.hasPlayed_ = function () { return !1 }, i.syncController_ = new od(t), i.segmentMetadataTrack_ = a.addRemoteTextTrack({ kind: "metadata", label: "segment-metadata" }, !1).track, i.decrypter_ = new ud; var d = { hls: i.hls_, mediaSource: i.mediaSource, currentTime: i.tech_.currentTime.bind(i.tech_), seekable: function () { return i.seekable() }, seeking: function () { return i.tech_.seeking() }, duration: function () { return i.mediaSource.duration }, hasPlayed: function () { return i.hasPlayed_() }, goalBufferLength: function () { return i.goalBufferLength() }, bandwidth: s, syncController: i.syncController_, decrypter: i.decrypter_, sourceType: i.sourceType_ }; return i.masterPlaylistLoader_ = "dash" === i.sourceType_ ? new dh(r, i.hls_, i.withCredentials) : new Fl(r, i.hls_, i.withCredentials), i.setupMasterPlaylistLoaderListeners_(), i.mainSegmentLoader_ = new Zh(ce.mergeOptions(d, { segmentMetadataTrack: i.segmentMetadataTrack_, loaderType: "main" }), t), i.audioSegmentLoader_ = new Zh(ce.mergeOptions(d, { loaderType: "audio" }), t), i.subtitleSegmentLoader_ = new id(ce.mergeOptions(d, { loaderType: "vtt" }), t), i.setupSegmentLoaderListeners_(), Cd.forEach(function (t) { i[t + "_"] = wd.bind(i, t) }), i.logger_ = ph("MPC"), i.masterPlaylistLoader_.load(), i } return Al(e, t), Cl(e, [{ key: "setupMasterPlaylistLoaderListeners_", value: function () { var t = this; this.masterPlaylistLoader_.on("loadedmetadata", function () { var e = t.masterPlaylistLoader_.media(), i = 1.5 * t.masterPlaylistLoader_.targetDuration * 1e3; lc(t.masterPlaylistLoader_.master, t.masterPlaylistLoader_.media()) ? t.requestOptions_.timeout = 0 : t.requestOptions_.timeout = i, e.endList && "none" !== t.tech_.preload() && (t.mainSegmentLoader_.playlist(e, t.requestOptions_), t.mainSegmentLoader_.load()), Td({ sourceType: t.sourceType_, segmentLoaders: { AUDIO: t.audioSegmentLoader_, SUBTITLES: t.subtitleSegmentLoader_, main: t.mainSegmentLoader_ }, tech: t.tech_, requestOptions: t.requestOptions_, masterPlaylistLoader: t.masterPlaylistLoader_, hls: t.hls_, master: t.master(), mediaTypes: t.mediaTypes_, blacklistCurrentPlaylist: t.blacklistCurrentPlaylist.bind(t) }), t.triggerPresenceUsage_(t.master(), e); try { t.setupSourceBuffers_() } catch (r) { return ce.log.warn("Failed to create SourceBuffers", r), t.mediaSource.endOfStream("decode") } t.setupFirstPlay(), t.trigger("selectedinitialmedia") }), this.masterPlaylistLoader_.on("loadedplaylist", function () { var e = t.masterPlaylistLoader_.media(); if (!e) { t.excludeUnsupportedVariants_(); var i = void 0; return t.enableLowInitialPlaylist && (i = t.selectInitialPlaylist()), i || (i = t.selectPlaylist()), t.initialMedia_ = i, void t.masterPlaylistLoader_.media(t.initialMedia_) } if (t.useCueTags_ && t.updateAdCues_(e), t.mainSegmentLoader_.playlist(e, t.requestOptions_), t.updateDuration(), t.tech_.paused() || t.mainSegmentLoader_.load(), !e.endList) { var r = function () { var e = t.seekable(); 0 !== e.length && t.mediaSource.addSeekableRange_(e.start(0), e.end(0)) }; if (t.duration() !== 1 / 0) { var n = function a() { t.duration() === 1 / 0 ? r() : t.tech_.one("durationchange", a) }; t.tech_.one("durationchange", n) } else r() } }), this.masterPlaylistLoader_.on("error", function () { t.blacklistCurrentPlaylist(t.masterPlaylistLoader_.error) }), this.masterPlaylistLoader_.on("mediachanging", function () { t.mainSegmentLoader_.abort(), t.mainSegmentLoader_.pause() }), this.masterPlaylistLoader_.on("mediachange", function () { var e = t.masterPlaylistLoader_.media(), i = 1.5 * t.masterPlaylistLoader_.targetDuration * 1e3; lc(t.masterPlaylistLoader_.master, t.masterPlaylistLoader_.media()) ? t.requestOptions_.timeout = 0 : t.requestOptions_.timeout = i, t.mainSegmentLoader_.playlist(e, t.requestOptions_), t.mainSegmentLoader_.load(), t.tech_.trigger({ type: "mediachange", bubbles: !0 }) }), this.masterPlaylistLoader_.on("playlistunchanged", function () { var e = t.masterPlaylistLoader_.media(), i = t.stuckAtPlaylistEnd_(e); i && (t.blacklistCurrentPlaylist({ message: "Playlist no longer updating." }), t.tech_.trigger("playliststuck")) }), this.masterPlaylistLoader_.on("renditiondisabled", function () { t.tech_.trigger({ type: "usage", name: "hls-rendition-disabled" }) }), this.masterPlaylistLoader_.on("renditionenabled", function () { t.tech_.trigger({ type: "usage", name: "hls-rendition-enabled" }) }) } }, { key: "triggerPresenceUsage_", value: function (t, e) { var i = t.mediaGroups || {}, r = !0, n = Object.keys(i.AUDIO); for (var a in i.AUDIO) for (var s in i.AUDIO[a]) { var o = i.AUDIO[a][s]; o.uri || (r = !1) } r && this.tech_.trigger({ type: "usage", name: "hls-demuxed" }), Object.keys(i.SUBTITLES).length && this.tech_.trigger({ type: "usage", name: "hls-webvtt" }), Ed.Playlist.isAes(e) && this.tech_.trigger({ type: "usage", name: "hls-aes" }), Ed.Playlist.isFmp4(e) && this.tech_.trigger({ type: "usage", name: "hls-fmp4" }), n.length && Object.keys(i.AUDIO[n[0]]).length > 1 && this.tech_.trigger({ type: "usage", name: "hls-alternate-audio" }), this.useCueTags_ && this.tech_.trigger({ type: "usage", name: "hls-playlist-cue-tags" }) } }, { key: "setupSegmentLoaderListeners_", value: function () { var t = this; this.mainSegmentLoader_.on("bandwidthupdate", function () { var e = t.selectPlaylist(), i = t.masterPlaylistLoader_.media(), r = t.tech_.buffered(), n = r.length ? r.end(r.length - 1) - t.tech_.currentTime() : 0, a = t.bufferLowWaterLine(); (!i.endList || t.duration() < mh.MAX_BUFFER_LOW_WATER_LINE || e.attributes.BANDWIDTH < i.attributes.BANDWIDTH || n >= a) && t.masterPlaylistLoader_.media(e), t.tech_.trigger("bandwidthupdate") }), this.mainSegmentLoader_.on("progress", function () { t.trigger("progress") }), this.mainSegmentLoader_.on("error", function () { t.blacklistCurrentPlaylist(t.mainSegmentLoader_.error()) }), this.mainSegmentLoader_.on("syncinfoupdate", function () { t.onSyncInfoUpdate_() }), this.mainSegmentLoader_.on("timestampoffset", function () { t.tech_.trigger({ type: "usage", name: "hls-timestamp-offset" }) }), this.audioSegmentLoader_.on("syncinfoupdate", function () { t.onSyncInfoUpdate_() }), this.mainSegmentLoader_.on("ended", function () { t.onEndOfStream() }), this.mainSegmentLoader_.on("earlyabort", function () { t.blacklistCurrentPlaylist({ message: "Aborted early because there isn't enough bandwidth to complete the request without rebuffering." }, kd) }), this.mainSegmentLoader_.on("reseteverything", function () { t.tech_.trigger("hls-reset") }), this.mainSegmentLoader_.on("segmenttimemapping", function (e) { t.tech_.trigger({ type: "hls-segment-time-mapping", mapping: e.mapping }) }), this.audioSegmentLoader_.on("ended", function () { t.onEndOfStream() }) } }, { key: "mediaSecondsLoaded_", value: function () { return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded + this.mainSegmentLoader_.mediaSecondsLoaded) } }, { key: "load", value: function () { this.mainSegmentLoader_.load(), this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.load(), this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.load() } }, { key: "fastQualityChange_", value: function () { var t = this.selectPlaylist(); t !== this.masterPlaylistLoader_.media() && (this.masterPlaylistLoader_.media(t), this.mainSegmentLoader_.resetLoader()) } }, { key: "play", value: function () { if (!this.setupFirstPlay()) { this.tech_.ended() && this.tech_.setCurrentTime(0), this.hasPlayed_() && this.load(); var t = this.tech_.seekable(); return this.tech_.duration() === 1 / 0 && this.tech_.currentTime() < t.start(0) ? this.tech_.setCurrentTime(t.end(t.length - 1)) : void 0 } } }, { key: "setupFirstPlay", value: function () { var t = this, e = this.masterPlaylistLoader_.media(); if (!e || this.tech_.paused() || this.hasPlayed_()) return !1; if (!e.endList) { var i = this.seekable(); if (!i.length) return !1; if (ce.browser.IE_VERSION && 0 === this.tech_.readyState()) return this.tech_.one("loadedmetadata", function () { t.trigger("firstplay"), t.tech_.setCurrentTime(i.end(0)), t.hasPlayed_ = function () { return !0 } }), !1; this.trigger("firstplay"), this.tech_.setCurrentTime(i.end(0)) } return this.hasPlayed_ = function () { return !0 }, this.load(), !0 } }, { key: "handleSourceOpen_", value: function () { try { this.setupSourceBuffers_() } catch (t) { return ce.log.warn("Failed to create Source Buffers", t), this.mediaSource.endOfStream("decode") } if (this.tech_.autoplay()) { var e = this.tech_.play(); "undefined" != typeof e && "function" == typeof e.then && e.then(null, function (t) { }) } this.trigger("sourceopen") } }, {
      key: "onEndOfStream",
      value: function () { var t = this.mainSegmentLoader_.ended_; this.mediaTypes_.AUDIO.activePlaylistLoader && (t = !this.mainSegmentLoader_.startingMedia_ || this.mainSegmentLoader_.startingMedia_.containsVideo ? t && this.audioSegmentLoader_.ended_ : this.audioSegmentLoader_.ended_), t && this.mediaSource.endOfStream() }
    }, { key: "stuckAtPlaylistEnd_", value: function (t) { var e = this.seekable(); if (!e.length) return !1; var i = this.syncController_.getExpiredTime(t, this.mediaSource.duration); if (null === i) return !1; var r = Ed.Playlist.playlistEnd(t, i), n = this.tech_.currentTime(), a = this.tech_.buffered(); if (!a.length) return Ec >= r - n; var s = a.end(a.length - 1); return Ec >= s - n && Ec >= r - s } }, { key: "blacklistCurrentPlaylist", value: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, e = arguments[1], i = void 0, r = void 0; if (i = t.playlist || this.masterPlaylistLoader_.media(), e = e || t.blacklistDuration || this.blacklistDuration, !i) { this.error = t; try { return this.mediaSource.endOfStream("network") } catch (n) { return this.trigger("error") } } var a = 1 === this.masterPlaylistLoader_.master.playlists.filter(rc).length; return a ? (ce.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the final playlist."), this.tech_.trigger("retryplaylist"), this.masterPlaylistLoader_.load(a)) : (i.excludeUntil = Date.now() + 1e3 * e, this.tech_.trigger("blacklistplaylist"), this.tech_.trigger({ type: "usage", name: "hls-rendition-blacklisted" }), r = this.selectPlaylist(), ce.log.warn("Problem encountered with the current HLS playlist." + (t.message ? " " + t.message : "") + " Switching to another playlist."), this.masterPlaylistLoader_.media(r)) } }, { key: "pauseLoading", value: function () { this.mainSegmentLoader_.pause(), this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.pause(), this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.pause() } }, { key: "setCurrentTime", value: function (t) { var e = wc(this.tech_.buffered(), t); return this.masterPlaylistLoader_ && this.masterPlaylistLoader_.media() && this.masterPlaylistLoader_.media().segments ? e && e.length ? t : (this.mainSegmentLoader_.resetEverything(), this.mainSegmentLoader_.abort(), this.mediaTypes_.AUDIO.activePlaylistLoader && (this.audioSegmentLoader_.resetEverything(), this.audioSegmentLoader_.abort()), this.mediaTypes_.SUBTITLES.activePlaylistLoader && (this.subtitleSegmentLoader_.resetEverything(), this.subtitleSegmentLoader_.abort()), void this.load()) : 0 } }, { key: "duration", value: function () { return this.masterPlaylistLoader_ ? this.mediaSource ? this.mediaSource.duration : Ed.Playlist.duration(this.masterPlaylistLoader_.media()) : 0 } }, { key: "seekable", value: function () { return this.seekable_ } }, { key: "onSyncInfoUpdate_", value: function () { var t = void 0, e = void 0; if (this.masterPlaylistLoader_) { var i = this.masterPlaylistLoader_.media(); if (i) { var r = this.syncController_.getExpiredTime(i, this.mediaSource.duration); if (null !== r && (t = Ed.Playlist.seekable(i, r), 0 !== t.length)) { if (this.mediaTypes_.AUDIO.activePlaylistLoader) { if (i = this.mediaTypes_.AUDIO.activePlaylistLoader.media(), r = this.syncController_.getExpiredTime(i, this.mediaSource.duration), null === r) return; if (e = Ed.Playlist.seekable(i, r), 0 === e.length) return } e ? e.start(0) > t.end(0) || t.start(0) > e.end(0) ? this.seekable_ = t : this.seekable_ = ce.createTimeRanges([[e.start(0) > t.start(0) ? e.start(0) : t.start(0), e.end(0) < t.end(0) ? e.end(0) : t.end(0)]]) : this.seekable_ = t, this.logger_("seekable updated [" + Pc(this.seekable_) + "]"), this.tech_.trigger("seekablechanged") } } } } }, { key: "updateDuration", value: function () { var t = this, e = this.mediaSource.duration, i = Ed.Playlist.duration(this.masterPlaylistLoader_.media()), r = this.tech_.buffered(), n = function a() { t.mediaSource.duration = i, t.tech_.trigger("durationchange"), t.mediaSource.removeEventListener("sourceopen", a) }; r.length > 0 && (i = Math.max(i, r.end(r.length - 1))), e !== i && ("open" !== this.mediaSource.readyState ? this.mediaSource.addEventListener("sourceopen", n) : n()) } }, { key: "dispose", value: function () { var t = this; this.decrypter_.terminate(), this.masterPlaylistLoader_.dispose(), this.mainSegmentLoader_.dispose(), ["AUDIO", "SUBTITLES"].forEach(function (e) { var i = t.mediaTypes_[e].groups; for (var r in i) i[r].forEach(function (t) { t.playlistLoader && t.playlistLoader.dispose() }) }), this.audioSegmentLoader_.dispose(), this.subtitleSegmentLoader_.dispose() } }, { key: "master", value: function () { return this.masterPlaylistLoader_.master } }, { key: "media", value: function () { return this.masterPlaylistLoader_.media() || this.initialMedia_ } }, { key: "setupSourceBuffers_", value: function () { var t = this.masterPlaylistLoader_.media(), e = void 0; if (t && "open" === this.mediaSource.readyState) { if (e = Bh(this.masterPlaylistLoader_.master, t), e.length < 1) return this.error = "No compatible SourceBuffer configuration for the variant stream:" + t.resolvedUri, this.mediaSource.endOfStream("decode"); this.configureLoaderMimeTypes_(e), this.excludeIncompatibleVariants_(t) } } }, { key: "configureLoaderMimeTypes_", value: function (t) { var e = t.length > 1 && -1 === t[0].indexOf(",") && t[0] !== t[1] ? new ce.EventTarget : null; this.mainSegmentLoader_.mimeType(t[0], e), t[1] && this.audioSegmentLoader_.mimeType(t[1], e) } }, { key: "excludeUnsupportedVariants_", value: function () { this.master().playlists.forEach(function (t) { t.attributes.CODECS && Te.MediaSource && Te.MediaSource.isTypeSupported && !Te.MediaSource.isTypeSupported('video/mp4; codecs="' + Dh(t.attributes.CODECS) + '"') && (t.excludeUntil = 1 / 0) }) } }, { key: "excludeIncompatibleVariants_", value: function (t) { var e = 2, i = null, r = void 0; t.attributes.CODECS && (r = xh(t.attributes.CODECS), i = r.videoCodec, e = r.codecCount), this.master().playlists.forEach(function (t) { var r = { codecCount: 2, videoCodec: null }; t.attributes.CODECS && (r = xh(t.attributes.CODECS)), r.codecCount !== e && (t.excludeUntil = 1 / 0), r.videoCodec !== i && (t.excludeUntil = 1 / 0) }) } }, { key: "updateAdCues_", value: function (t) { var e = 0, i = this.seekable(); i.length && (e = i.start(0)), nd(t, this.cueTagsTrack_, e) } }, { key: "goalBufferLength", value: function () { var t = this.tech_.currentTime(), e = mh.GOAL_BUFFER_LENGTH, i = mh.GOAL_BUFFER_LENGTH_RATE, r = Math.max(e, mh.MAX_GOAL_BUFFER_LENGTH); return Math.min(e + t * i, r) } }, { key: "bufferLowWaterLine", value: function () { var t = this.tech_.currentTime(), e = mh.BUFFER_LOW_WATER_LINE, i = mh.BUFFER_LOW_WATER_LINE_RATE, r = Math.max(e, mh.MAX_BUFFER_LOW_WATER_LINE); return Math.min(e + t * i, r) } }]), e
  }(ce.EventTarget), Ld = function (t, e, i) { return function (r) { var n = t.master.playlists[e], a = ic(n), s = rc(n); return "undefined" == typeof r ? s : (r ? delete n.disabled : n.disabled = !0, r === s || a || (i(), r ? t.trigger("renditionenabled") : t.trigger("renditiondisabled")), r) } }, Pd = function Jd(t, e, i) { El(this, Jd); var r = t.masterPlaylistController_.fastQualityChange_.bind(t.masterPlaylistController_); if (e.attributes.RESOLUTION) { var n = e.attributes.RESOLUTION; this.width = n.width, this.height = n.height } this.bandwidth = e.attributes.BANDWIDTH, this.id = i, this.enabled = Ld(t.playlists, e.uri, r) }, Od = function (t) { var e = t.playlists; t.representations = function () { return e.master.playlists.filter(function (t) { return !ic(t) }).map(function (e, i) { return new Pd(t, e, e.uri) }) } }, Id = ["seeking", "seeked", "pause", "playing", "error"], xd = function () { function t(e) { var i = this; El(this, t), this.tech_ = e.tech, this.seekable = e.seekable, this.consecutiveUpdates = 0, this.lastRecordedTime = null, this.timer_ = null, this.checkCurrentTimeTimeout_ = null, this.logger_ = ph("PlaybackWatcher"), this.logger_("initialize"); var r = function () { return i.monitorCurrentTime_() }, n = function () { return i.techWaiting_() }, a = function () { return i.cancelTimer_() }, s = function () { return i.fixesBadSeeks_() }; this.tech_.on("seekablechanged", s), this.tech_.on("waiting", n), this.tech_.on(Id, a), this.tech_.on("canplay", r), this.dispose = function () { i.logger_("dispose"), i.tech_.off("seekablechanged", s), i.tech_.off("waiting", n), i.tech_.off(Id, a), i.tech_.off("canplay", r), i.checkCurrentTimeTimeout_ && Te.clearTimeout(i.checkCurrentTimeTimeout_), i.cancelTimer_() } } return Cl(t, [{ key: "monitorCurrentTime_", value: function () { this.checkCurrentTime_(), this.checkCurrentTimeTimeout_ && Te.clearTimeout(this.checkCurrentTimeTimeout_), this.checkCurrentTimeTimeout_ = Te.setTimeout(this.monitorCurrentTime_.bind(this), 250) } }, { key: "checkCurrentTime_", value: function () { if (this.tech_.seeking() && this.fixesBadSeeks_()) return this.consecutiveUpdates = 0, void (this.lastRecordedTime = this.tech_.currentTime()); if (!this.tech_.paused() && !this.tech_.seeking()) { var t = this.tech_.currentTime(), e = this.tech_.buffered(); return this.lastRecordedTime === t && (!e.length || t + Ec >= e.end(e.length - 1)) ? this.techWaiting_() : void (this.consecutiveUpdates >= 5 && t === this.lastRecordedTime ? (this.consecutiveUpdates++ , this.waiting_()) : t === this.lastRecordedTime ? this.consecutiveUpdates++ : (this.consecutiveUpdates = 0, this.lastRecordedTime = t)) } } }, { key: "cancelTimer_", value: function () { this.consecutiveUpdates = 0, this.timer_ && (this.logger_("cancelTimer_"), clearTimeout(this.timer_)), this.timer_ = null } }, { key: "fixesBadSeeks_", value: function () { var t = this.tech_.seeking(), e = this.seekable(), i = this.tech_.currentTime(), r = void 0; if (t && this.afterSeekableWindow_(e, i)) { var n = e.end(e.length - 1); r = n } if (t && this.beforeSeekableWindow_(e, i)) { var a = e.start(0); r = a + Ec } return "undefined" != typeof r ? (this.logger_("Trying to seek outside of seekable at time " + i + " with " + ("seekable range " + Pc(e) + ". Seeking to ") + (r + ".")), this.tech_.setCurrentTime(r), !0) : !1 } }, { key: "waiting_", value: function () { if (!this.techWaiting_()) { var t = this.tech_.currentTime(), e = this.tech_.buffered(), i = wc(e, t); return i.length && t + 3 <= i.end(0) ? (this.cancelTimer_(), this.tech_.setCurrentTime(t), this.logger_("Stopped at " + t + " while inside a buffered region " + ("[" + i.start(0) + " -> " + i.end(0) + "]. Attempting to resume ") + "playback by seeking to the current time."), void this.tech_.trigger({ type: "usage", name: "hls-unknown-waiting" })) : void 0 } } }, { key: "techWaiting_", value: function () { var t = this.seekable(), e = this.tech_.currentTime(); if (this.tech_.seeking() && this.fixesBadSeeks_()) return !0; if (this.tech_.seeking() || null !== this.timer_) return !0; if (this.beforeSeekableWindow_(t, e)) { var i = t.end(t.length - 1); return this.logger_("Fell out of live window at time " + e + ". Seeking to live point (seekable end) " + i), this.cancelTimer_(), this.tech_.setCurrentTime(i), this.tech_.trigger({ type: "usage", name: "hls-live-resync" }), !0 } var r = this.tech_.buffered(), n = Ac(r, e); if (this.videoUnderflow_(n, r, e)) return this.cancelTimer_(), this.tech_.setCurrentTime(e), this.tech_.trigger({ type: "usage", name: "hls-video-underflow" }), !0; if (n.length > 0) { var a = n.start(0) - e; return this.logger_("Stopped at " + e + ", setting timer for " + a + ", seeking to " + n.start(0)), this.timer_ = setTimeout(this.skipTheGap_.bind(this), 1e3 * a, e), !0 } return !1 } }, { key: "afterSeekableWindow_", value: function (t, e) { return t.length && e > t.end(t.length - 1) + Ec ? !0 : !1 } }, { key: "beforeSeekableWindow_", value: function (t, e) { return t.length && t.start(0) > 0 && e < t.start(0) - Ec ? !0 : !1 } }, { key: "videoUnderflow_", value: function (t, e, i) { if (0 === t.length) { var r = this.gapFromVideoUnderflow_(e, i); if (r) return this.logger_("Encountered a gap in video from " + r.start + " to " + r.end + ". Seeking to current time " + i), !0 } return !1 } }, { key: "skipTheGap_", value: function (t) { var e = this.tech_.buffered(), i = this.tech_.currentTime(), r = Ac(e, i); this.cancelTimer_(), 0 !== r.length && i === t && (this.logger_("skipTheGap_:", "currentTime:", i, "scheduled currentTime:", t, "nextRange start:", r.start(0)), this.tech_.setCurrentTime(r.start(0) + kc), this.tech_.trigger({ type: "usage", name: "hls-gap-skip" })) } }, { key: "gapFromVideoUnderflow_", value: function (t, e) { for (var i = Lc(t), r = 0; r < i.length; r++) { var n = i.start(r), a = i.end(r); if (4 > e - n && e - n > 2) return { start: n, end: a } } return null } }]), t }(), Dd = { errorInterval: 30, getSource: function (t) { var e = this.tech({ IWillNotUseThisInPlugins: !0 }), i = e.currentSource_; return t(i) } }, Rd = function Qd(t, e) { var i = 0, r = 0, n = ce.mergeOptions(Dd, e); t.ready(function () { t.trigger({ type: "usage", name: "hls-error-reload-initialized" }) }); var a = function () { r && t.currentTime(r) }, s = function (e) { null !== e && void 0 !== e && (r = t.duration() !== 1 / 0 && t.currentTime() || 0, t.one("loadedmetadata", a), t.src(e), t.trigger({ type: "usage", name: "hls-error-reload" }), t.play()) }, o = function () { return Date.now() - i < 1e3 * n.errorInterval ? void t.trigger({ type: "usage", name: "hls-error-reload-canceled" }) : n.getSource && "function" == typeof n.getSource ? (i = Date.now(), n.getSource.call(t, s)) : void ce.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!") }, u = function c() { t.off("loadedmetadata", a), t.off("error", o), t.off("dispose", c) }, l = function (e) { u(), Qd(t, e) }; t.on("error", o), t.on("dispose", u), t.reloadSourceOnError = l }, Md = function (t) { Rd(this, t) }, Ud = "1.1.0", Nd = { PlaylistLoader: Fl, Playlist: cc, Decrypter: Sl, AsyncStream: _l, decrypt: Tl, utils: Sc, STANDARD_PLAYLIST_SELECTOR: Wh, INITIAL_PLAYLIST_SELECTOR: Gh, comparePlaylistBandwidth: Hh, comparePlaylistResolution: Vh, xhr: pc() }, Bd = 4194304;["GOAL_BUFFER_LENGTH", "MAX_GOAL_BUFFER_LENGTH", "GOAL_BUFFER_LENGTH_RATE", "BUFFER_LOW_WATER_LINE", "MAX_BUFFER_LOW_WATER_LINE", "BUFFER_LOW_WATER_LINE_RATE", "BANDWIDTH_VARIANCE"].forEach(function (t) { Object.defineProperty(Nd, t, { get: function () { return ce.log.warn("using Hls." + t + " is UNSAFE be sure you know what you are doing"), mh[t] }, set: function (e) { return ce.log.warn("using Hls." + t + " is UNSAFE be sure you know what you are doing"), "number" != typeof e || 0 > e ? void ce.log.warn("value of Hls." + t + " must be greater than or equal to 0") : void (mh[t] = e) } }) }); var jd = function (t) { var e = /^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i; if (e.test(t)) return "hls"; var i = /^application\/dash\+xml/i; return i.test(t) ? "dash" : null }, Fd = function (t, e) { for (var i = e.media(), r = -1, n = 0; n < t.length; n++)if (t[n].id === i.uri) { r = n; break } t.selectedIndex_ = r, t.trigger({ selectedIndex: r, type: "change" }) }, Hd = function (t, e) { e.representations().forEach(function (e) { t.addQualityLevel(e) }), Fd(t, e.playlists) }; Nd.canPlaySource = function () { return ce.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var Vd = function (t, e, i) { if (!t) return t; var r = {}; for (var n in t) r[n] = { audioContentType: 'audio/mp4; codecs="' + i.attributes.CODECS + '"', videoContentType: 'video/mp4; codecs="' + e.attributes.CODECS + '"' }, e.contentProtection && e.contentProtection[n] && e.contentProtection[n].pssh && (r[n].pssh = e.contentProtection[n].pssh), "string" == typeof t[n] && (r[n].url = t[n]); return ce.mergeOptions(t, r) }, qd = function (t) { if ("dash" === t.options_.sourceType) { var e = ce.players[t.tech_.options_.playerId]; if (e.eme) { var i = Vd(t.source_.keySystems, t.playlists.media(), t.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media()); i && (e.currentSource().keySystems = i) } } }; Nd.supportsNativeHls = function () { var t = we.createElement("video"); if (!ce.getTech("Html5").isSupported()) return !1; var e = ["application/vnd.apple.mpegurl", "audio/mpegurl", "audio/x-mpegurl", "application/x-mpegurl", "video/x-mpegurl", "video/mpegurl", "application/mpegurl"]; return e.some(function (e) { return /maybe|probably/i.test(t.canPlayType(e)) }) }(), Nd.supportsNativeDash = function () { return ce.getTech("Html5").isSupported() ? /maybe|probably/i.test(we.createElement("video").canPlayType("application/dash+xml")) : !1 }(), Nd.supportsTypeNatively = function (t) { return "hls" === t ? Nd.supportsNativeHls : "dash" === t ? Nd.supportsNativeDash : !1 }, Nd.isSupported = function () { return ce.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var Wd = ce.getComponent("Component"), zd = function (t) { function e(t, i, r) { El(this, e); var n = Ll(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, i, r.hls)); if (i.options_ && i.options_.playerId) { var a = ce(i.options_.playerId); a.hasOwnProperty("hls") || Object.defineProperty(a, "hls", { get: function () { return ce.log.warn("player.hls is deprecated. Use player.tech_.hls instead."), i.trigger({ type: "usage", name: "hls-player-access" }), n } }), a.vhs = n, a.dash = n } if (n.tech_ = i, n.source_ = t, n.stats = {}, n.ignoreNextSeekingEvent_ = !1, n.setOptions_(), n.options_.overrideNative && i.overrideNativeAudioTracks && i.overrideNativeVideoTracks) i.overrideNativeAudioTracks(!0), i.overrideNativeVideoTracks(!0); else if (n.options_.overrideNative && (i.featuresNativeVideoTracks || i.featuresNativeAudioTracks)) throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB"); return n.on(we, ["fullscreenchange", "webkitfullscreenchange", "mozfullscreenchange", "MSFullscreenChange"], function (t) { var e = we.fullscreenElement || we.webkitFullscreenElement || we.mozFullScreenElement || we.msFullscreenElement; e && e.contains(n.tech_.el()) && n.masterPlaylistController_.fastQualityChange_() }), n.on(n.tech_, "seeking", function () { return this.ignoreNextSeekingEvent_ ? void (this.ignoreNextSeekingEvent_ = !1) : void this.setCurrentTime(this.tech_.currentTime()) }), n.on(n.tech_, "error", function () { this.masterPlaylistController_ && this.masterPlaylistController_.pauseLoading() }), n.on(n.tech_, "play", n.play), n } return Al(e, t), Cl(e, [{ key: "setOptions_", value: function () { var t = this; this.options_.withCredentials = this.options_.withCredentials || !1, "number" != typeof this.options_.blacklistDuration && (this.options_.blacklistDuration = 300), "number" != typeof this.options_.bandwidth && (this.options_.bandwidth = Bd), this.options_.enableLowInitialPlaylist = this.options_.enableLowInitialPlaylist && this.options_.bandwidth === Bd, ["withCredentials", "bandwidth"].forEach(function (e) { "undefined" != typeof t.source_[e] && (t.options_[e] = t.source_[e]) }), this.bandwidth = this.options_.bandwidth } }, { key: "src", value: function (t, e) { var i = this; t && (this.setOptions_(), this.options_.url = this.source_.src, this.options_.tech = this.tech_, this.options_.externHls = Nd, this.options_.sourceType = jd(e), this.masterPlaylistController_ = new Ad(this.options_), this.playbackWatcher_ = new xd(ce.mergeOptions(this.options_, { seekable: function () { return i.seekable() } })), this.masterPlaylistController_.on("error", function () { var t = ce.players[i.tech_.options_.playerId]; t.error(i.masterPlaylistController_.error) }), this.masterPlaylistController_.selectPlaylist = this.selectPlaylist ? this.selectPlaylist.bind(this) : Nd.STANDARD_PLAYLIST_SELECTOR.bind(this), this.masterPlaylistController_.selectInitialPlaylist = Nd.INITIAL_PLAYLIST_SELECTOR.bind(this), this.playlists = this.masterPlaylistController_.masterPlaylistLoader_, this.mediaSource = this.masterPlaylistController_.mediaSource, Object.defineProperties(this, { selectPlaylist: { get: function () { return this.masterPlaylistController_.selectPlaylist }, set: function (t) { this.masterPlaylistController_.selectPlaylist = t.bind(this) } }, throughput: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate }, set: function (t) { this.masterPlaylistController_.mainSegmentLoader_.throughput.rate = t, this.masterPlaylistController_.mainSegmentLoader_.throughput.count = 1 } }, bandwidth: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.bandwidth }, set: function (t) { this.masterPlaylistController_.mainSegmentLoader_.bandwidth = t, this.masterPlaylistController_.mainSegmentLoader_.throughput = { rate: 0, count: 0 } } }, systemBandwidth: { get: function () { var t = 1 / (this.bandwidth || 1), e = void 0; e = this.throughput > 0 ? 1 / this.throughput : 0; var i = Math.floor(1 / (t + e)); return i }, set: function () { ce.log.error('The "systemBandwidth" property is read-only') } } }), Object.defineProperties(this.stats, { bandwidth: { get: function () { return i.bandwidth || 0 }, enumerable: !0 }, mediaRequests: { get: function () { return i.masterPlaylistController_.mediaRequests_() || 0 }, enumerable: !0 }, mediaRequestsAborted: { get: function () { return i.masterPlaylistController_.mediaRequestsAborted_() || 0 }, enumerable: !0 }, mediaRequestsTimedout: { get: function () { return i.masterPlaylistController_.mediaRequestsTimedout_() || 0 }, enumerable: !0 }, mediaRequestsErrored: { get: function () { return i.masterPlaylistController_.mediaRequestsErrored_() || 0 }, enumerable: !0 }, mediaTransferDuration: { get: function () { return i.masterPlaylistController_.mediaTransferDuration_() || 0 }, enumerable: !0 }, mediaBytesTransferred: { get: function () { return i.masterPlaylistController_.mediaBytesTransferred_() || 0 }, enumerable: !0 }, mediaSecondsLoaded: { get: function () { return i.masterPlaylistController_.mediaSecondsLoaded_() || 0 }, enumerable: !0 }, buffered: { get: function () { return Ic(i.tech_.buffered()) }, enumerable: !0 }, currentTime: { get: function () { return i.tech_.currentTime() }, enumerable: !0 }, currentSource: { get: function () { return i.tech_.currentSource_ }, enumerable: !0 }, currentTech: { get: function () { return i.tech_.name_ }, enumerable: !0 }, duration: { get: function () { return i.tech_.duration() }, enumerable: !0 }, master: { get: function () { return i.playlists.master }, enumerable: !0 }, playerDimensions: { get: function () { return i.tech_.currentDimensions() }, enumerable: !0 }, seekable: { get: function () { return Ic(i.tech_.seekable()) }, enumerable: !0 }, timestamp: { get: function () { return Date.now() }, enumerable: !0 }, videoPlaybackQuality: { get: function () { return i.tech_.getVideoPlaybackQuality() }, enumerable: !0 } }), this.tech_.one("canplay", this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)), this.masterPlaylistController_.on("selectedinitialmedia", function () { Od(i), qd(i) }), this.on(this.masterPlaylistController_, "progress", function () { this.tech_.trigger("progress") }), this.on(this.masterPlaylistController_, "firstplay", function () { this.ignoreNextSeekingEvent_ = !0 }), this.tech_.ready(function () { return i.setupQualityLevels_() }), this.tech_.el() && this.tech_.src(ce.URL.createObjectURL(this.masterPlaylistController_.mediaSource))) } }, { key: "setupQualityLevels_", value: function () { var t = this, e = ce.players[this.tech_.options_.playerId]; e && e.qualityLevels && (this.qualityLevels_ = e.qualityLevels(), this.masterPlaylistController_.on("selectedinitialmedia", function () { Hd(t.qualityLevels_, t) }), this.playlists.on("mediachange", function () { Fd(t.qualityLevels_, t.playlists) })) } }, { key: "play", value: function () { this.masterPlaylistController_.play() } }, { key: "setCurrentTime", value: function (t) { this.masterPlaylistController_.setCurrentTime(t) } }, { key: "duration", value: function () { return this.masterPlaylistController_.duration() } }, { key: "seekable", value: function () { return this.masterPlaylistController_.seekable() } }, { key: "dispose", value: function () { this.playbackWatcher_ && this.playbackWatcher_.dispose(), this.masterPlaylistController_ && this.masterPlaylistController_.dispose(), this.qualityLevels_ && this.qualityLevels_.dispose(), wl(e.prototype.__proto__ || Object.getPrototypeOf(e.prototype), "dispose", this).call(this) } }]), e }(Wd), Gd = { name: "videojs-http-streaming", VERSION: Ud, canHandleSource: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = ce.mergeOptions(ce.options, e); return Gd.canPlayType(t.type, i) }, handleSource: function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, r = ce.mergeOptions(ce.options, i); return e.hls = new zd(t, e, r), e.hls.xhr = pc(), e.hls.src(t.src, t.type), e.hls }, canPlayType: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = ce.mergeOptions(ce.options, e), r = i.hls.overrideNative, n = jd(t), a = n && (!Nd.supportsTypeNatively(n) || r); return a ? "maybe" : "" } }; return ("undefined" == typeof ce.MediaSource || "undefined" == typeof ce.URL) && (ce.MediaSource = oh, ce.URL = uh), oh.supportsNativeMediaSources() && ce.getTech("Html5").registerSourceHandler(Gd, 0), ce.HlsHandler = zd, ce.HlsSourceHandler = Gd, ce.Hls = Nd, ce.use || ce.registerComponent("Hls", Nd), ce.options.hls = ce.options.hls || {}, ce.registerPlugin ? ce.registerPlugin("reloadSourceOnError", Md) : ce.plugin("reloadSourceOnError", Md), ce
}), !function () { !function (t) { var e = t && t.videojs; e && (e.CDN_VERSION = "7.1.0") }(window) }();


//上面是video.js的代码
// 视频列表构造函数
function VideoInfo(title, videoUrl, posterUrl) {
  this.title = title;
  this.videoUrl = videoUrl;
  this.posterUrl = posterUrl;
  this.switch2X = function () {
    var videoT = document.getElementById('mainPlayer_html5_api');
    if (videoT.src != videoUrl) {
      player.pause();
      reShow();
      var posterTem = document.getElementsByClassName('mainCover');//显示封面
      posterTem[0].style.display = 'block';
      videoT.setAttribute('src', videoUrl);//切换视频源
      var prePoster = document.getElementsByClassName('prePoster');//切换封面
      prePoster[0].src = posterUrl;
      var titleT = document.getElementsByClassName('vjs-title-bar');//切换标题
      titleT[0].innerHTML = title;
      var preTitle = document.getElementsByClassName('preTitle');
      preTitle[0].innerHTML = title;
      player.load();//视频重载
    }
  }
}

//定义视频列表
var initialX = function (idX) {
  var tempId = 'video' + idX;
  var id = document.getElementById(tempId);
  var tempName = eval(tempId);// 将一个字符串转换为变量名
  var videolength;
  var requestURL = tempName.videoUrl + '?avinfo';
  var myRequest = new XMLHttpRequest();
  myRequest.open('GET', requestURL, true);
  myRequest.responseType = 'json';
  myRequest.send();
  myRequest.onload = function () {
    var myResponse = myRequest.response;
    videolength = myResponse.format.duration;
    videolength = timeCut(videolength);
    id.innerHTML = '<p class="videoTitles">' + tempName.title + '</p>' + '<div class="playing trans-fadeout"><p>now  playing</p></div>' + '<div class="covers trans-fadeout image-fadeout"><svg class="icon icons" aria-hidden="true" onclick="poster2Play()"><use xlink:href="#icon-player"></use></svg><p class="videolength">' + videolength + '</p></div>' + '<img src="' + tempName.posterUrl + '" class="videoPosters">';
  }
}

//视频列表内容
var video1 = new VideoInfo('旅行剪辑', 'https://qiniu.qiuqingyun.com/Thailand.mp4', 'https://qiniu.qiuqingyun.com/Thailand-poster.jpg');
var video2 = new VideoInfo('MV《干杯》', 'https://qiniu.qiuqingyun.com/mv.mp4', 'https://qiniu.qiuqingyun.com/mv-poster.jpg');
var video3 = new VideoInfo('团委宣传片', 'https://qiniu.qiuqingyun.com/propaganda.mp4', 'https://qiniu.qiuqingyun.com/propaganda-poster.jpg');
var video4 = new VideoInfo('MG动画', 'https://qiniu.qiuqingyun.com/Animation.mp4', 'https://qiniu.qiuqingyun.com/Animation-poster.jpg');
for (var videoNumber = 0; videoNumber < 4; videoNumber++) {
  initialX(videoNumber + 1);
}

//播放器信息
var options = {
  sources: [{//视频地址
    src: video1.videoUrl,
    type: 'video/mp4'
  }],
  width: "904",
  height: "508.5",
  controls: true,
  preload: 'auto',
};
var player = videojs('mainPlayer', options, function () {
  var prePoster = document.getElementsByClassName('prePoster');
  prePoster[0].src = video1.posterUrl;
  var preTitle = document.getElementsByClassName('preTitle');
  preTitle[0].innerHTML = video1.title;
});

function poster2Play() {
  var posterT = document.getElementsByClassName('mainCover');
  posterT[0].style.display = 'none';
  player.play();
  var playerSrc = document.getElementsByTagName('video')[0].src;
  function showPlaylistText(idX) {
    idX -= 1;
    var playing = document.getElementsByClassName('playing')[idX];
    var videoTitles = document.getElementsByClassName('videoTitles')[idX];
    var covers = document.getElementsByClassName('covers')[idX];
    reShow();
    playing.style.visibility = 'visible';
    playing.style.opacity = '1';
    videoTitles.style.visibility = 'hidden';
    videoTitles.style.opacity = '0';
    covers.style.visibility = 'hidden';
    covers.style.opacity = '0';
    // scroll(0, 0);
    backTop ();
  }
  switch (playerSrc) {
    case video1.videoUrl:
      showPlaylistText(1);
      break;
    case video2.videoUrl:
      showPlaylistText(2);
      break;
    case video3.videoUrl:
      showPlaylistText(3);
      break;
    case video4.videoUrl:
      showPlaylistText(4);
      break;
    default:
      console.log('error');
      break;
  }
}
function reShow() {
  for (var tempNum = 0; tempNum < 4; tempNum++) {
    var playing = document.getElementsByClassName('playing')[tempNum];
    var videoTitles = document.getElementsByClassName('videoTitles')[tempNum];
    var covers = document.getElementsByClassName('covers')[tempNum];
    if (playing.style.opacity == '1') {
      playing.style.visibility = 'hidden';
      playing.style.opacity = '0';
      videoTitles.style.visibility = 'visible';
      videoTitles.style.opacity = '1';
      covers.style.visibility = '';
      covers.style.opacity = '';
      break;
    }
  }
}
//实现视频标题
var Component = videojs.getComponent('Component');
var TitleBar = videojs.extend(Component, {
  constructor: function (player, options) {
    Component.apply(this, arguments);
    if (options.text) {
      this.updateTextContent(options.text);
    }
  },
  createEl: function () {
    return videojs.dom.createEl('div', {
      className: 'vjs-title-bar'
    });
  },
  updateTextContent: function (text) {
    if (typeof text !== 'string') {
      text = 'Text Unknown';
    }
    videojs.dom.emptyEl(this.el());
    videojs.dom.appendContent(this.el(), text);
  }
});
videojs.registerComponent('TitleBar', TitleBar);
player.addChild('TitleBar', { text: video1.title });//标题内容



//其他

// 移动端适配
(function (){
  var visualViewport=window. innerWidth;
  var mainPlayerT = document.getElementsByClassName('mainPlayer-dimensions')[0];
  var mainCover = document.getElementsByClassName('mainCover')[0];
  var videoList = document.getElementsByClassName('videoList');
  if(visualViewport<=1000){
    document.getElementsByTagName('html')[0].style.fontSize=20*visualViewport/320+'px';
    var mainContainer=document.getElementsByClassName('mainContainer')[0];
    mainContainer.style.width=px2rem(visualViewport);
  }
  mainPlayerT.style.width = px2rem(options.width);
  mainPlayerT.style.height = px2rem(options.height);
  if (visualViewport <= 1000) {
    mainPlayerT.style.width = px2rem(visualViewport);
    mainPlayerT.style.height = px2rem(visualViewport * 0.5625);
    mainCover.style.width = px2rem(visualViewport);
    mainCover.style.height = px2rem(visualViewport * 0.5625);
    var playButton = document.getElementsByClassName('playButton')[0];
    playButton.innerHTML = '<svg class="icon" aria-hidden="true"><use xlink:href="#icon-custom-play"></use></svg>'
    for(var i=0;i<4;i++){
      videoList[i].style.width = px2rem(visualViewport*0.9);
      videoList[i].style.height = px2rem(visualViewport * 0.5625*0.9);
    }
  }
}());

//px化为rem
function px2rem(pxs) {
  var rems = pxs / parseFloat(getComputedStyle(document.getElementsByTagName('html')[0],false)["fontSize"]) + 'rem';
  return rems;
}
//时间格式化
function timeCut(seconds) {
  seconds = parseInt(seconds);
  var minutes = parseInt(seconds / 60);
  if (minutes < 1) minutes = '00';
  seconds = seconds - 60 * minutes;
  if (seconds < 1) {
    seconds = '00';
  } else if (seconds < 10 && seconds >= 1) {
    seconds = '0' + seconds;
  }
  var times = minutes + ':' + seconds;
  return times;
}